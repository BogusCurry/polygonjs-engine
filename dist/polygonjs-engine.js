window.POLY=function(t){function e(e){for(var n,i,s=e[0],o=e[1],a=0,u=[];a<s.length;a++)i=s[a],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&u.push(r[i][0]),r[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n]);for(_&&_(e);u.length;)u.shift()()}var n={},r={"polygonjs-engine":0};function i(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(t){var e=[],n=r[t];if(0!==n)if(n)e.push(n[2]);else{var s=new Promise((function(e,i){n=r[t]=[e,i]}));e.push(n[2]=s);var o,a=document.createElement("script");a.charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.src=function(t){return i.p+""+({"Gl~Mat":"Gl~Mat",Gl:"Gl","vendors~Cop~Mat~Obj~Sop":"vendors~Cop~Mat~Obj~Sop",Mat:"Mat","vendors~Cop~Obj~Sop":"vendors~Cop~Obj~Sop","vendors~Cop~Obj":"vendors~Cop~Obj","vendors~Cop":"vendors~Cop",Cop:"Cop","vendors~Obj~Sop":"vendors~Obj~Sop",Obj:"Obj","vendors~Sop":"vendors~Sop",Sop:"Sop","vendors~Event":"vendors~Event",Event:"Event"}[t]||t)+".bundle.js"}(t);var _=new Error;o=function(e){a.onerror=a.onload=null,clearTimeout(u);var n=r[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),s=e&&e.target&&e.target.src;_.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",_.name="ChunkLoadError",_.type=i,_.request=s,n[1](_)}r[t]=void 0}};var u=setTimeout((function(){o({type:"timeout",target:a})}),12e4);a.onerror=a.onload=o,document.head.appendChild(a)}return Promise.all(e)},i.m=t,i.c=n,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i.oe=function(t){throw console.error(t),t};var s=window.webpackJsonpPOLY=window.webpackJsonpPOLY||[],o=s.push.bind(s);s.push=e,s=s.slice();for(var a=0;a<s.length;a++)e(s[a]);var _=o;return i(i.s=327)}([function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.BOOLEAN="boolean",t.BUTTON="button",t.COLOR="color",t.FLOAT="float",t.FOLDER="folder",t.INTEGER="integer",t.OPERATOR_PATH="operator_path",t.RAMP="ramp",t.SEPARATOR="separator",t.STRING="string",t.VECTOR2="vector2",t.VECTOR3="vector3",t.VECTOR4="vector4"}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));function r(t,e,n,r){return new(n||(n=Promise))((function(i,s){function o(t){try{_(r.next(t))}catch(t){s(t)}}function a(t){try{_(r.throw(t))}catch(t){s(t)}}function _(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}_((r=r.apply(t,e||[])).next())}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(10),i=n(21),s=new a,o=new i.a;function a(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}Object.assign(a.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(o.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(o.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,s=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*s,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*s,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*s,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,s=t.y,o=t.z,a=t.w,_=a*e+s*r-o*n,u=a*n+o*e-i*r,c=a*r+i*n-s*e,h=-i*e-s*n-o*r;return this.x=_*a+h*-i+u*-o-c*-s,this.y=u*a+h*-s+c*-i-_*-o,this.z=c*a+h*-o+_*-s-u*-i,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,s=e.x,o=e.y,a=e.z;return this.x=r*a-i*o,this.y=i*s-n*a,this.z=n*o-r*s,this},projectOnVector:function(t){var e=t.lengthSq();if(0===e)return this.set(0,0,0);var n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)},projectOnPlane:function(t){return s.copy(this).projectOnVector(t),this.sub(s)},reflect:function(t){return this.sub(s.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;var n=this.dot(t)/e;return Math.acos(r.a.clamp(n,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}})},function(t,e){var n=Array.isArray;t.exports=n},function(t,e,n){"use strict";n.d(e,"db",(function(){return r})),n.d(e,"Pc",(function(){return i})),n.d(e,"s",(function(){return s})),n.d(e,"q",(function(){return o})),n.d(e,"r",(function(){return a})),n.d(e,"Ab",(function(){return _})),n.d(e,"Bb",(function(){return u})),n.d(e,"dd",(function(){return c})),n.d(e,"E",(function(){return h})),n.d(e,"h",(function(){return l})),n.d(e,"w",(function(){return d})),n.d(e,"C",(function(){return p})),n.d(e,"qb",(function(){return f})),n.d(e,"sb",(function(){return m})),n.d(e,"d",(function(){return v})),n.d(e,"Oc",(function(){return g})),n.d(e,"ib",(function(){return y})),n.d(e,"t",(function(){return x})),n.d(e,"b",(function(){return b})),n.d(e,"Nc",(function(){return w})),n.d(e,"sc",(function(){return k})),n.d(e,"fb",(function(){return E})),n.d(e,"eb",(function(){return M})),n.d(e,"gd",(function(){return O})),n.d(e,"vb",(function(){return j})),n.d(e,"Lc",(function(){return A})),n.d(e,"zb",(function(){return z})),n.d(e,"Jc",(function(){return T})),n.d(e,"yb",(function(){return S})),n.d(e,"x",(function(){return P})),n.d(e,"wb",(function(){return R})),n.d(e,"y",(function(){return C})),n.d(e,"xb",(function(){return q})),n.d(e,"Kc",(function(){return D})),n.d(e,"pb",(function(){return L})),n.d(e,"f",(function(){return N})),n.d(e,"O",(function(){return U})),n.d(e,"P",(function(){return $})),n.d(e,"z",(function(){return I})),n.d(e,"H",(function(){return V})),n.d(e,"G",(function(){return F})),n.d(e,"tb",(function(){return B})),n.d(e,"jb",(function(){return H})),n.d(e,"hb",(function(){return G})),n.d(e,"c",(function(){return W})),n.d(e,"rb",(function(){return Y})),n.d(e,"W",(function(){return Z})),n.d(e,"qc",(function(){return X})),n.d(e,"Vc",(function(){return J})),n.d(e,"k",(function(){return Q})),n.d(e,"a",(function(){return K})),n.d(e,"Uc",(function(){return tt})),n.d(e,"m",(function(){return et})),n.d(e,"n",(function(){return nt})),n.d(e,"A",(function(){return rt})),n.d(e,"B",(function(){return it})),n.d(e,"Ic",(function(){return st})),n.d(e,"o",(function(){return ot})),n.d(e,"p",(function(){return at})),n.d(e,"rc",(function(){return _t})),n.d(e,"l",(function(){return ut})),n.d(e,"gb",(function(){return ct})),n.d(e,"kb",(function(){return ht})),n.d(e,"ob",(function(){return lt})),n.d(e,"mb",(function(){return dt})),n.d(e,"nb",(function(){return pt})),n.d(e,"lb",(function(){return ft})),n.d(e,"R",(function(){return mt})),n.d(e,"V",(function(){return vt})),n.d(e,"T",(function(){return gt})),n.d(e,"U",(function(){return yt})),n.d(e,"S",(function(){return xt})),n.d(e,"Wc",(function(){return bt})),n.d(e,"j",(function(){return wt})),n.d(e,"Hc",(function(){return kt})),n.d(e,"cd",(function(){return Et})),n.d(e,"J",(function(){return Mt})),n.d(e,"Yc",(function(){return Ot})),n.d(e,"D",(function(){return jt})),n.d(e,"I",(function(){return At})),n.d(e,"Zc",(function(){return zt})),n.d(e,"ad",(function(){return Tt})),n.d(e,"bd",(function(){return St})),n.d(e,"Xc",(function(){return Pt})),n.d(e,"e",(function(){return Rt})),n.d(e,"dc",(function(){return Ct})),n.d(e,"Db",(function(){return qt})),n.d(e,"cb",(function(){return Dt})),n.d(e,"bb",(function(){return Lt})),n.d(e,"cc",(function(){return Nt})),n.d(e,"u",(function(){return Ut})),n.d(e,"v",(function(){return $t})),n.d(e,"oc",(function(){return It})),n.d(e,"pc",(function(){return Vt})),n.d(e,"mc",(function(){return Ft})),n.d(e,"nc",(function(){return Bt})),n.d(e,"ec",(function(){return Ht})),n.d(e,"Eb",(function(){return Gt})),n.d(e,"lc",(function(){return Wt})),n.d(e,"Xb",(function(){return Yt})),n.d(e,"Yb",(function(){return Zt})),n.d(e,"Zb",(function(){return Xt})),n.d(e,"kc",(function(){return Jt})),n.d(e,"jc",(function(){return Qt})),n.d(e,"Wb",(function(){return Kt})),n.d(e,"Vb",(function(){return te})),n.d(e,"hc",(function(){return ee})),n.d(e,"ic",(function(){return ne})),n.d(e,"Ub",(function(){return re})),n.d(e,"Lb",(function(){return ie})),n.d(e,"Mb",(function(){return se})),n.d(e,"Nb",(function(){return oe})),n.d(e,"Ob",(function(){return ae})),n.d(e,"Pb",(function(){return _e})),n.d(e,"Qb",(function(){return ue})),n.d(e,"Rb",(function(){return ce})),n.d(e,"Sb",(function(){return he})),n.d(e,"Gb",(function(){return le})),n.d(e,"Hb",(function(){return de})),n.d(e,"Ib",(function(){return pe})),n.d(e,"Fb",(function(){return fe})),n.d(e,"Jb",(function(){return me})),n.d(e,"Kb",(function(){return ve})),n.d(e,"Tb",(function(){return ge})),n.d(e,"zc",(function(){return ye})),n.d(e,"Ac",(function(){return xe})),n.d(e,"Bc",(function(){return be})),n.d(e,"Cc",(function(){return we})),n.d(e,"Dc",(function(){return ke})),n.d(e,"Ec",(function(){return Ee})),n.d(e,"Fc",(function(){return Me})),n.d(e,"Gc",(function(){return Oe})),n.d(e,"uc",(function(){return je})),n.d(e,"vc",(function(){return Ae})),n.d(e,"wc",(function(){return ze})),n.d(e,"tc",(function(){return Te})),n.d(e,"xc",(function(){return Se})),n.d(e,"yc",(function(){return Pe})),n.d(e,"Y",(function(){return Re})),n.d(e,"ab",(function(){return Ce})),n.d(e,"Z",(function(){return qe})),n.d(e,"K",(function(){return De})),n.d(e,"L",(function(){return Le})),n.d(e,"M",(function(){return Ne})),n.d(e,"fd",(function(){return Ue})),n.d(e,"hd",(function(){return $e})),n.d(e,"ed",(function(){return Ie})),n.d(e,"Tc",(function(){return Ve})),n.d(e,"Sc",(function(){return Fe})),n.d(e,"Rc",(function(){return Be})),n.d(e,"Q",(function(){return He})),n.d(e,"id",(function(){return Ge})),n.d(e,"F",(function(){return We})),n.d(e,"bc",(function(){return Ye})),n.d(e,"X",(function(){return Ze})),n.d(e,"gc",(function(){return Xe})),n.d(e,"fc",(function(){return Je})),n.d(e,"ac",(function(){return Qe})),n.d(e,"i",(function(){return Ke})),n.d(e,"Cb",(function(){return tn})),n.d(e,"Qc",(function(){return en})),n.d(e,"ub",(function(){return nn})),n.d(e,"N",(function(){return rn})),n.d(e,"g",(function(){return sn})),n.d(e,"Mc",(function(){return on}));var r={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},i={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},s=0,o=1,a=2,_=1,u=2,c=3,h=0,l=1,d=2,p=1,f=0,m=1,v=2,g=3,y=4,x=5,b=100,w=101,k=102,E=103,M=104,O=200,j=201,A=202,z=203,T=204,S=205,P=206,R=207,C=208,q=209,D=210,L=0,N=1,U=2,$=3,I=4,V=5,F=6,B=7,H=0,G=1,W=2,Y=0,Z=1,X=2,J=3,Q=4,K=5,tt=300,et=301,nt=302,rt=303,it=304,st=305,ot=306,at=307,_t=1e3,ut=1001,ct=1002,ht=1003,lt=1004,dt=1004,pt=1005,ft=1005,mt=1006,vt=1007,gt=1007,yt=1008,xt=1008,bt=1009,wt=1010,kt=1011,Et=1012,Mt=1013,Ot=1014,jt=1015,At=1016,zt=1017,Tt=1018,St=1019,Pt=1020,Rt=1021,Ct=1022,qt=1023,Dt=1024,Lt=1025,Nt=qt,Ut=1026,$t=1027,It=1028,Vt=1029,Ft=1030,Bt=1031,Ht=1032,Gt=1033,Wt=33776,Yt=33777,Zt=33778,Xt=33779,Jt=35840,Qt=35841,Kt=35842,te=35843,ee=36196,ne=37492,re=37496,ie=37808,se=37809,oe=37810,ae=37811,_e=37812,ue=37813,ce=37814,he=37815,le=37816,de=37817,pe=37818,fe=37819,me=37820,ve=37821,ge=36492,ye=37840,xe=37841,be=37842,we=37843,ke=37844,Ee=37845,Me=37846,Oe=37847,je=37848,Ae=37849,ze=37850,Te=37851,Se=37852,Pe=37853,Re=2200,Ce=2201,qe=2202,De=2300,Le=2301,Ne=2302,Ue=2400,$e=2401,Ie=2402,Ve=0,Fe=1,Be=2,He=3e3,Ge=3001,We=3007,Ye=3002,Ze=3003,Xe=3004,Je=3005,Qe=3006,Ke=3200,tn=3201,en=0,nn=1,rn=7680,sn=519,on=35044},function(t,e,n){var r=n(26),i=n(3),s=n(18);t.exports=function(t){return"string"==typeof t||!i(t)&&s(t)&&"[object String]"==r(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));class r{static find_node(t,e,n){if(!t)return null;const i=e.split(r.SEPARATOR).filter(t=>t.length>0),s=i[0];let o=null;if(e[0]!==r.SEPARATOR){switch(s){case r.PARENT:null==n||n.add_path_element(s),o=t.parent;break;case r.CURRENT:null==n||n.add_path_element(s),o=t;break;default:o=t.node(s),o&&(null==n||n.add_node(s,o))}if(null!=o&&i.length>1){const t=i.slice(1).join(r.SEPARATOR);o=this.find_node(o,t,n)}return o}{const r=e.substr(1);o=this.find_node(t.root,r,n)}return o}static find_param(t,e,n){if(!t)return null;const i=e.split(r.SEPARATOR);if(1===i.length)return t.params.get(i[0]);{const e=i.slice(0,+(i.length-2)+1||void 0).join(r.SEPARATOR),s=this.find_node(t,e,n);if(null!=s){const t=i[i.length-1],e=s.params.get(t);return n&&e&&n.add_node(t,e),e}return null}}static relative_path(t,e){const n=this.closest_common_parent(t,e);if(n){const i=this.distance_to_parent(t,n);let s="";if(i-1>0){let t=0;const e=[];for(;t++<i-1;)e.push(r.PARENT);s=e.join(r.SEPARATOR)+r.SEPARATOR}const o=n.full_path().split(r.SEPARATOR).filter(t=>t.length>0),a=e.full_path().split(r.SEPARATOR).filter(t=>t.length>0),_=[];let u=0;for(let t of a)o[u]||_.push(t),u++;return`${s}${_.join(r.SEPARATOR)}`}return e.full_path()}static closest_common_parent(t,e){const n=this.parents(t).reverse(),r=this.parents(e).reverse(),i=Math.min(n.length,r.length);let s=null;for(let t=0;t<i;t++)n[t].graph_node_id==r[t].graph_node_id&&(s=n[t]);return s}static parents(t){const e=[];let n=t.parent;for(;n;)e.push(n),n=n.parent;return e}static distance_to_parent(t,e){let n=0,r=t;const i=e.graph_node_id;for(;r&&r.graph_node_id!=i;)n+=1,r=r.parent;return r&&r.graph_node_id==i?n:-1}static make_absolute_path(t,e){const n=e.split(r.SEPARATOR),i=n.shift();if(!i)return t.full_path();switch(i){case"..":return t.parent?this.make_absolute_path(t.parent,n.join(r.SEPARATOR)):null;case".":return this.make_absolute_path(t,n.join(r.SEPARATOR));default:return[t.full_path(),e].join(r.SEPARATOR)}}}r.SEPARATOR="/",r.DOT=".",r.CURRENT=r.DOT,r.PARENT="..",r.CURRENT_WITH_SLASH=`${r.CURRENT}/`,r.PARENT_WITH_SLASH=`${r.PARENT}/`,r.NON_LETTER_PREFIXES=[r.SEPARATOR,r.DOT]},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.CREATED="node_created",t.DELETED="node_deleted",t.NAME_UPDATED="node_name_update",t.OVERRIDE_CLONABLE_STATE_UPDATE="node_override_clonable_state_update",t.NAMED_OUTPUTS_UPDATED="node_named_outputs_updated",t.NAMED_INPUTS_UPDATED="node_named_inputs_updated",t.INPUTS_UPDATED="node_inputs_updated",t.PARAMS_UPDATED="node_params_updated",t.UI_DATA_POSITION_UPDATED="node_ui_data_position_updated",t.UI_DATA_COMMENT_UPDATED="node_ui_data_comment_updated",t.ERROR_UPDATED="node_error_updated",t.FLAG_BYPASS_UPDATED="bypass_flag_updated",t.FLAG_DISPLAY_UPDATED="display_flag_updated",t.SELECTION_UPDATED="selection_updated"}(r||(r={}))},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.VISIBLE_UPDATED="param_visible_updated",t.RAW_INPUT_UPDATED="raw_input_updated",t.VALUE_UPDATED="param_value_updated",t.EXPRESSION_UPDATED="param_expression_update",t.ERROR_UPDATED="param_error_updated",t.DELETED="param_deleted"}(r||(r={}))},function(t,e,n){var r=n(26),i=n(18);t.exports=function(t){return"number"==typeof t||i(t)&&"[object Number]"==r(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));for(var r=[],i=0;i<256;i++)r[i]=(i<16?"0":"")+i.toString(16);var s={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(r[255&t]+r[t>>8&255]+r[t>>16&255]+r[t>>24&255]+"-"+r[255&e]+r[e>>8&255]+"-"+r[e>>16&15|64]+r[e>>24&255]+"-"+r[63&n|128]+r[n>>8&255]+"-"+r[n>>16&255]+r[n>>24&255]+r[255&i]+r[i>>8&255]+r[i>>16&255]+r[i>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*s.DEG2RAD},radToDeg:function(t){return t*s.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){var s=Math.cos,o=Math.sin,a=s(n/2),_=o(n/2),u=s((e+r)/2),c=o((e+r)/2),h=s((e-r)/2),l=o((e-r)/2),d=s((r-e)/2),p=o((r-e)/2);"XYX"===i?t.set(a*c,_*h,_*l,a*u):"YZY"===i?t.set(_*l,a*c,_*h,a*u):"ZXZ"===i?t.set(_*h,_*l,a*c,a*u):"XZX"===i?t.set(a*c,_*p,_*d,a*u):"YXY"===i?t.set(_*d,a*c,_*p,a*u):"ZYZ"===i?t.set(_*p,_*d,a*c,a*u):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(1);const i={antialias:!0};class s{constructor(){this._next_renderer_id=0,this._next_env_map_id=0,this._renderers={},this._env_maps={},this._require_webgl2=!1,this._resolves=[]}set_require_webgl2(){this._require_webgl2||(this._require_webgl2=!0)}rendering_context(t){let e=null;return this._require_webgl2&&(e=this._rendering_context_webgl(t,!0)),e||(e=this._rendering_context_webgl(t,!1)),e}_rendering_context_webgl(t,e){let n=e?"webgl2":"webgl",r=t.getContext(n,i);return r||(n=e?"experimental-webgl2":"experimental-webgl",r=t.getContext(n,i)),r}register_renderer(t){if(t._polygon_id)throw new Error("render already registered");t._polygon_id=this._next_renderer_id+=1,this._renderers[t._polygon_id]=t,1==Object.keys(this._renderers).length&&this.flush_callbacks_with_renderer(t)}deregister_renderer(t){delete this._renderers[t._polygon_id],t.dispose()}first_renderer(){const t=Object.keys(this._renderers)[0];return t?this._renderers[t]:null}renderers(){return Object.values(this._renderers)}flush_callbacks_with_renderer(t){let e;for(;e=this._resolves.pop();)e(t)}wait_for_renderer(){return Object(r.a)(this,void 0,void 0,(function*(){const t=this.first_renderer();return t||new Promise((t,e)=>{this._resolves.push(t)})}))}}class o{constructor(){this._node_register={},this._node_register_categories={},this._node_register_options={}}register_node(t,e,n){const r=t.node_context(),i=t.type();if(this._node_register[r]=this._node_register[r]||{},this._node_register[r][i])throw new Error(`node ${r}/${i} already registered`);this._node_register[r][i]=t,e&&(this._node_register_categories[r]=this._node_register_categories[r]||{},this._node_register_categories[r][i]=e),this._node_register_options[r]=this._node_register_options[r]||{},n&&(this._node_register_options[r][i]=n)}deregister_node(t,e){delete this._node_register[t][e],delete this._node_register_categories[t][e],delete this._node_register_options[t][e]}registered_nodes_for_context_and_parent_type(t,e){if(this._node_register[t]){return Object.values(this._node_register[t]).filter(n=>{var r;const i=this._node_register_options[t][n.type()];if(!i)return!0;{const n=i.only,r=i.except,s=`${t}/${e}`;if(n)return n.includes(s);if(r)return!r.includes(s)}return!i||(null===(r=i.only)||void 0===r?void 0:r.includes(e))})}return[]}registered_nodes(t,e){const n={},r=this.registered_nodes_for_context_and_parent_type(t,e);for(let t of r){n[t.type()]=t}return n}registered_category(t,e){return this._node_register_categories[t][e]}}class a{constructor(){this.renderers_controller=new s,this.nodes_register=new o,this.scenes_by_uuid={}}static instance(){return this._instance=this._instance||new a}register_node(t,e,n){this.nodes_register.register_node(t,e,n)}registered_nodes(t,e){return this.nodes_register.registered_nodes(t,e)}in_worker_thread(){return!1}desktop_controller(){}player_mode(){return!1}log(...t){console.log(...t)}set_env(t){this._env=t}get env(){return this._env}}},function(t,e,n){"use strict";function r(t,e){this.x=t||0,this.y=e||0}n.d(e,"a",(function(){return r})),Object.defineProperties(r.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(r.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,s=this.y-t.y;return this.x=i*n-s*r+t.x,this.y=i*r+s*n+t.y,this}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class r{constructor(t){this.node=t,this._dirty_count=0,this._dirty=!0}get is_dirty(){return!0===this._dirty}get dirty_timestamp(){return this._dirty_timestamp}get dirty_count(){return this._dirty_count}add_post_dirty_hook(t,e){this._post_dirty_hook_names=this._post_dirty_hook_names||[],this._post_dirty_hooks=this._post_dirty_hooks||[],this._post_dirty_hook_names.includes(t)?console.warn(`hook with name ${t} already exists`,this.node):(this._post_dirty_hook_names.push(t),this._post_dirty_hooks.push(e))}remove_post_dirty_hook(t){if(this._post_dirty_hook_names&&this._post_dirty_hooks){const e=this._post_dirty_hook_names.indexOf(t);e>=0&&(this._post_dirty_hook_names.splice(e,1),this._post_dirty_hooks.splice(e,1))}}has_hook(t){return!!this._post_dirty_hook_names&&this._post_dirty_hook_names.includes(t)}remove_dirty_state(){this._dirty=!1}set_forbidden_trigger_nodes(t){this._forbidden_trigger_nodes=t.map(t=>t.graph_node_id)}set_dirty(t,e){null==e&&(e=!0),t&&this._forbidden_trigger_nodes&&this._forbidden_trigger_nodes.includes(t.graph_node_id)||(null==t&&(t=this.node),this._dirty=!0,this._dirty_timestamp=performance.now(),this._dirty_count+=1,this.run_post_dirty_hooks(t),!0===e&&this.set_successors_dirty(t))}run_post_dirty_hooks(t){if(this._post_dirty_hooks){const e=this.node.scene.cooker;if(e.blocked)e.enqueue(this.node,t);else for(let e of this._post_dirty_hooks)e(t)}}set_successors_dirty(t){this._cached_successors=this._cached_successors||this.node.graph_all_successors();for(let e of this._cached_successors)e.dirty_controller.set_dirty(t,!1)}clear_successors_cache(){this._cached_successors=void 0}clear_successors_cache_with_predecessors(){this.clear_successors_cache();for(let t of this.node.graph_all_predecessors())t.dirty_controller.clear_successors_cache()}}class i{constructor(t,e){this._scene=t,this._name=e,this._dirty_controller=new r(this),this._graph_node_id=t.graph.next_id(),t.graph.setNode(this),this._graph=t.graph}get name(){return this._name}set_name(t){this._name=t}get scene(){return this._scene}get graph(){return this._graph}get graph_node_id(){return this._graph_node_id}get dirty_controller(){return this._dirty_controller}set_dirty(t){t=t||this,this._dirty_controller.set_dirty(t)}set_successors_dirty(t){this._dirty_controller.set_successors_dirty(t)}remove_dirty_state(){this._dirty_controller.remove_dirty_state()}get is_dirty(){return this._dirty_controller.is_dirty}add_post_dirty_hook(t,e){this._dirty_controller.add_post_dirty_hook(t,e)}graph_remove(){this.graph.removeNode(this)}add_graph_input(t){return this.graph.connect(t,this)}remove_graph_input(t){this.graph.disconnect(t,this)}graph_disconnect_predecessors(){this.graph.disconnect_predecessors(this)}graph_disconnect_successors(){this.graph.disconnect_successors(this)}graph_predecessor_ids(){return this.graph.predecessor_ids(this._graph_node_id)||[]}graph_predecessors(){return this.graph.predecessors(this)}graph_successors(){return this.graph.successors(this)}graph_all_predecessors(){return this.graph.all_predecessors(this)}graph_all_successors(){return this.graph.all_successors(this)}}},function(t,e,n){"use strict";n.d(e,"b",(function(){return p})),n.d(e,"a",(function(){return f}));var r=n(1),i=n(6),s=n(13),o=n(110);class a{constructor(t){this.param=t,this._blocked_emit=!1,this._blocked_parent_emit=!1,this._count_by_event_name={}}get emit_allowed(){return!0!==this._blocked_emit&&(!this.param.scene.loading_controller.is_loading&&this.param.scene.dispatch_controller.emit_allowed)}block_emit(){return this._blocked_emit=!0,this.param.is_multiple&&this.param.components&&this.param.components.forEach(t=>t.emit_controller.block_emit()),!0}unblock_emit(){return this._blocked_emit=!1,this.param.is_multiple&&this.param.components&&this.param.components.forEach(t=>t.emit_controller.unblock_emit()),!0}block_parent_emit(){return this._blocked_parent_emit=!0,!0}unblock_parent_emit(){return this._blocked_parent_emit=!1,!0}increment_count(t){this._count_by_event_name[t]=this._count_by_event_name[t]||0,this._count_by_event_name[t]+=1}events_count(t){return this._count_by_event_name[t]||0}emit(t){this.emit_allowed&&(this.param.emit(t),null!=this.param.parent_param&&!0!==this._blocked_parent_emit&&this.param.parent_param.emit(t))}}class _{constructor(t){this.param=t}to_json(){const t={name:this.param.name,type:this.param.type,raw_input:this.raw_input(),value:this.value(),expression:this.expression(),graph_node_id:this.param.graph_node_id,error_message:this.error_message(),is_visible:this.is_visible(),components:void 0};return this.param.is_multiple&&this.param.components&&(t.components=this.param.components.map(t=>t.graph_node_id)),t}raw_input(){return this.param.raw_input_serialized}value(){return this.param.value_serialized}expression(){var t;return this.param.has_expression()?null===(t=this.param.expression_controller)||void 0===t?void 0:t.expression:void 0}error_message(){return this.param.states.error.message}is_visible(){return this.param.options.is_visible}}class u{constructor(t){this.param=t}get active(){const t=this.param.scene.time_controller.graph_node.graph_node_id;return this.param.graph_predecessor_ids().includes(t)}}var c=n(8);class h{constructor(t){this.param=t}set(t){this._message!=t&&(this._message=t,this._message&&console.log(this.param.full_path(),this._message),this.param.emit_controller.emit(c.a.ERROR_UPDATED))}get message(){return this._message}clear(){this.set(void 0)}get active(){return null!=this._message}}class l{constructor(t){this.param=t,this.time_dependent=new u(this.param),this.error=new h(this.param)}}var d=n(0);class p extends s.a{constructor(t){super(t,"BaseParam"),this._options=new o.a(this),this._emit_controller=new a(this),this._is_computing=!1,this.initialize_param()}get options(){return this._options=this._options||new o.a(this)}get emit_controller(){return this._emit_controller=this._emit_controller||new a(this)}get expression_controller(){return this._expression_controller}get serializer(){return this._serializer=this._serializer||new _(this)}get states(){return this._states=this._states||new l(this)}initialize_value(){}initialize_param(){}static type(){return d.a.FLOAT}get type(){return this.constructor.type()}get is_numeric(){return!1}set_name(t){super.set_name(t)}get value(){return this._value}convert(t){return null}static are_raw_input_equal(t,e){return!1}is_raw_input_equal(t){return this.constructor.are_raw_input_equal(this._raw_input,t)}static are_values_equal(t,e){return!1}is_value_equal(t){return this.constructor.are_values_equal(this.value,t)}_clone_raw_input(t){return t}set(t){this._raw_input=this._clone_raw_input(this._prefilter_invalid_raw_input(t)),this.emit_controller.emit(c.a.RAW_INPUT_UPDATED),this.process_raw_input()}_prefilter_invalid_raw_input(t){return t}get default_value(){return this._default_value}get is_default(){return!0}get raw_input(){return this._raw_input}process_raw_input(){}compute(){return Object(r.a)(this,void 0,void 0,(function*(){if(this.scene.loading_controller.is_loading&&console.warn(`param attempt to compute ${this.full_path()}`),this.is_dirty){if(this._is_computing)return new Promise((t,e)=>{this._compute_resolves=this._compute_resolves||[],this._compute_resolves.push(t)});if(this._is_computing=!0,yield this.process_computation(),this._is_computing=!1,this._compute_resolves){let t;for(;t=this._compute_resolves.pop();)t()}}}))}process_computation(){return Object(r.a)(this,void 0,void 0,(function*(){}))}set_init_value(t){this._default_value=t}set_node(t){var e,n;if(t?(this._node=t,this.options.makes_node_dirty_when_dirty()&&!this.parent_param&&(null===(n=t.params.params_node)||void 0===n||n.add_graph_input(this))):this._node&&(null===(e=this._node.params.params_node)||void 0===e||e.remove_graph_input(this)),this.components)for(let e of this.components)e.set_node(t)}get node(){return this._node}get parent(){return this.node}set_parent_param(t){t.add_graph_input(this),this._parent_param=t}get parent_param(){return this._parent_param}has_parent_param(){return null!=this._parent_param}full_path(){var t;return(null===(t=this.node)||void 0===t?void 0:t.full_path())+"/"+this.name}path_relative_to(t){return i.a.relative_path(t,this)}emit(t){this.emit_controller.emit_allowed&&(this.emit_controller.increment_count(t),this.scene.dispatch_controller.dispatch(this,t))}get components(){return this._components}static get component_names(){return[]}get component_names(){return this.constructor.component_names}get is_multiple(){return this.component_names.length>0}init_components(){}has_expression(){return null!=this.expression_controller&&this.expression_controller.active}to_json(){return this.serializer.to_json()}}class f extends p{get default_value_serialized(){return"BaseParamClass.default_value_serialized overriden"}get raw_input_serialized(){return"BaseParamClass.raw_input_serialized overriden"}get value_serialized(){return"BaseParamClass.value_serialized overriden"}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return T}));var r=n(121),i=n.n(r),s=n(30),o=n.n(s),a=n(129),_=n.n(a),u=n(27),c=n.n(u),h=n(47),l=n.n(h),d=n(116),p=n.n(d),f=n(112),m=n.n(f),v=n(182),g=n.n(v),y=n(113),x=n.n(y),b=n(117),w=n.n(b),k=n(9),E=n.n(k);const M=/[, ]/,O=/\d+$/,j=/,| /,A=/^-?\d+\.?\d*$/;var z;!function(t){t.TRUE="true",t.FALSE="false"}(z||(z={}));class T{static is_boolean(t){return t==z.TRUE||t==z.FALSE}static to_boolean(t){return t==z.TRUE}static is_number(t){return A.test(t)}static tail_digits(t){const e=t.match(O);return e?parseInt(e[0]):0}static increment(t){let e;if(e=t.match(O)){const n=parseInt(e[0]);return`${t.substring(0,t.length-e[0].length)}${n+1}`}return`${t}1`}static pluralize(t){return"s"!==t[t.length-1]?`${t}s`:t}static camel_case(t){return w()(t)}static upper_first(t){return x()(t)}static snake_case(t){return g()(t)}static titleize(t){return m()(t.replace(/_/g," "))}static type_to_class_name(t){return this.upper_first(w()(t))}static timestamp_to_seconds(t){return Date.parse(t)/1e3}static seconds_to_timestamp(t){const e=new Date;return e.setTime(1e3*t),e.toISOString().substr(11,8)}static precision(t,e=2){e=Math.max(e,0);const n=`${t}`.split(".");if(e<=0)return n[0];let r=n[1];if(void 0!==r)return r.length>e&&(r=r.substring(0,e)),r=p()(r,e,"0"),`${n[0]}.${r}`;{const n=`${t}.`,r=n.length+e;return p()(n,r,"0")}}static ensure_float(t){const e=`${t}`;return e.indexOf(".")>=0?e:`${e}.0`}static match_mask(t,e){if("*"===e)return!0;return e=`^${e=e.split("*").join(".*")}$`,new RegExp(e).test(t)}static matches_one_mask(t,e){let n=!1;for(let r of e)T.match_mask(t,r)&&(n=!0);return n}static attrib_names(t){const e=t.split(M),n=c()(e.map(t=>_()(t)));return o()(n)}static to_id(t){if(null==t)return 0;const e=t.split("").reverse();let n=0,r=0;return e.forEach((t,e)=>{let i=t.charCodeAt(0);i>=0&&(r=e%10,n+=i*Math.pow(10,r),n%=Number.MAX_SAFE_INTEGER)}),n}static indices(t){const e=t.split(j);if(e.length>1)return o()(l()(e.map(t=>this.indices(t)))).sort((t,e)=>t-e);{const t=e[0];if(t){const e="-";if(t.indexOf(e)>0){const n=t.split(e);return i()(parseInt(n[0]),parseInt(n[1])+1)}{const e=parseInt(t);return E()(e)?[e]:[]}}return[]}}static escape_line_breaks(t){return t.replace(/(\r\n|\n|\r)/gm,"\\n")}}},function(t,e,n){var r;try{r={clone:n(65),constant:n(160),each:n(91),filter:n(248),has:n(269),isArray:n(3),isEmpty:n(271),isFunction:n(61),isUndefined:n(272),keys:n(23),map:n(191),reduce:n(273),size:n(275),transform:n(278),union:n(111),values:n(77)}}catch(t){}r||(r=window._),t.exports=r},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,n){var r=n(146),i="object"==typeof self&&self&&self.Object===Object&&self,s=r||i||Function("return this")();t.exports=s},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1),i=n(3),s=n.n(i),o=n(14),a=n(80),_=n(8);class u extends o.b{constructor(){super(...arguments),this._components_contructor=a.a}get components(){return this._components}get is_numeric(){return!0}get is_default(){for(let t of this.components)if(!t.is_default)return!1;return!0}get raw_input(){return this._components.map(t=>t.raw_input)}get raw_input_serialized(){return this.raw_input}init_components(){if(null!=this._components)return;let t=0;this._components=new Array(this.component_names.length);for(let e of this.component_names){const n=new this._components_contructor(this.scene);let r;r=s()(this._default_value)?this._default_value[t]:this._default_value[e],n.options.copy(this.options),n.set_init_value(r),n.set_name(`${this.name}${e}`),n.set_parent_param(this),this.add_graph_input(n),this._components[t]=n,t++}}process_computation(){return Object(r.a)(this,void 0,void 0,(function*(){yield this.compute_components(),this.set_value_from_components()}))}set_value_from_components(){}has_expression(){var t;for(let e of this.components)if(null===(t=e.expression_controller)||void 0===t?void 0:t.active)return!0;return!1}compute_components(){return Object(r.a)(this,void 0,void 0,(function*(){const t=this.components,e=[];for(let n of t)n.is_dirty&&e.push(n.compute());yield Promise.all(e),this.remove_dirty_state()}))}_prefilter_invalid_raw_input(t){if(s()(t))return t;{const e=t;return this.components.map(()=>e)}}process_raw_input(){const t=this.scene.cooker;t.block();const e=this.components;for(let t of e)t.emit_controller.block_parent_emit();const n=this._raw_input;if(s()(n))for(let t=0;t<e.length;t++)e[t].set(n[t]);else for(let t=0;t<e.length;t++){const r=this.component_names[t];e[t].set(n[r])}t.unblock();for(let t=0;t<e.length;t++)e[t].emit_controller.unblock_parent_emit();this.emit_controller.emit(_.a.VALUE_UPDATED)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(10);function i(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}Object.assign(i,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,s,o){var a=n[r+0],_=n[r+1],u=n[r+2],c=n[r+3],h=i[s+0],l=i[s+1],d=i[s+2],p=i[s+3];if(c!==p||a!==h||_!==l||u!==d){var f=1-o,m=a*h+_*l+u*d+c*p,v=m>=0?1:-1,g=1-m*m;if(g>Number.EPSILON){var y=Math.sqrt(g),x=Math.atan2(y,m*v);f=Math.sin(f*x)/y,o=Math.sin(o*x)/y}var b=o*v;if(a=a*f+h*b,_=_*f+l*b,u=u*f+d*b,c=c*f+p*b,f===1-o){var w=1/Math.sqrt(a*a+_*_+u*u+c*c);a*=w,_*=w,u*=w,c*=w}}t[e]=a,t[e+1]=_,t[e+2]=u,t[e+3]=c}}),Object.defineProperties(i.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(i.prototype,{isQuaternion:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,s=t.order,o=Math.cos,a=Math.sin,_=o(n/2),u=o(r/2),c=o(i/2),h=a(n/2),l=a(r/2),d=a(i/2);return"XYZ"===s?(this._x=h*u*c+_*l*d,this._y=_*l*c-h*u*d,this._z=_*u*d+h*l*c,this._w=_*u*c-h*l*d):"YXZ"===s?(this._x=h*u*c+_*l*d,this._y=_*l*c-h*u*d,this._z=_*u*d-h*l*c,this._w=_*u*c+h*l*d):"ZXY"===s?(this._x=h*u*c-_*l*d,this._y=_*l*c+h*u*d,this._z=_*u*d+h*l*c,this._w=_*u*c-h*l*d):"ZYX"===s?(this._x=h*u*c-_*l*d,this._y=_*l*c+h*u*d,this._z=_*u*d-h*l*c,this._w=_*u*c+h*l*d):"YZX"===s?(this._x=h*u*c+_*l*d,this._y=_*l*c+h*u*d,this._z=_*u*d-h*l*c,this._w=_*u*c-h*l*d):"XZY"===s&&(this._x=h*u*c-_*l*d,this._y=_*l*c-h*u*d,this._z=_*u*d+h*l*c,this._w=_*u*c+h*l*d),!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],s=n[8],o=n[1],a=n[5],_=n[9],u=n[2],c=n[6],h=n[10],l=r+a+h;return l>0?(e=.5/Math.sqrt(l+1),this._w=.25/e,this._x=(c-_)*e,this._y=(s-u)*e,this._z=(o-i)*e):r>a&&r>h?(e=2*Math.sqrt(1+r-a-h),this._w=(c-_)/e,this._x=.25*e,this._y=(i+o)/e,this._z=(s+u)/e):a>h?(e=2*Math.sqrt(1+a-r-h),this._w=(s-u)/e,this._x=(i+o)/e,this._y=.25*e,this._z=(_+c)/e):(e=2*Math.sqrt(1+h-r-a),this._w=(o-i)/e,this._x=(s+u)/e,this._y=(_+c)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(r.a.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);if(0===n)return this;var r=Math.min(1,e/n);return this.slerp(t,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,s=t._w,o=e._x,a=e._y,_=e._z,u=e._w;return this._x=n*u+s*o+r*_-i*a,this._y=r*u+s*a+i*o-n*_,this._z=i*u+s*_+n*a-r*o,this._w=s*u-n*o-r*a-i*_,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,s=this._w,o=s*t._w+n*t._x+r*t._y+i*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=s,this._x=n,this._y=r,this._z=i,this;var a=1-o*o;if(a<=Number.EPSILON){var _=1-e;return this._w=_*s+e*this._w,this._x=_*n+e*this._x,this._y=_*r+e*this._y,this._z=_*i+e*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(a),c=Math.atan2(u,o),h=Math.sin((1-e)*c)/u,l=Math.sin(e*c)/u;return this._w=s*h+this._w*l,this._x=n*h+this._x*l,this._y=r*h+this._y*l,this._z=i*h+this._z*l,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},fromBufferAttribute:function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}})},function(t,e,n){var r=n(61),i=n(98);t.exports=function(t){return null!=t&&i(t.length)&&!r(t)}},function(t,e,n){var r=n(150),i=n(100),s=n(22);t.exports=function(t){return s(t)?r(t):i(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(10),i={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},s={h:0,s:0,l:0},o={h:0,s:0,l:0};function a(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function _(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function u(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function c(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}Object.assign(a.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(t,e,n){if(t=r.a.euclideanModulo(t,1),e=r.a.clamp(e,0,1),n=r.a.clamp(n,0,1),0===e)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+e):n+e-n*e,s=2*n-i;this.r=_(s,i,t+1/3),this.g=_(s,i,t),this.b=_(s,i,t-1/3)}return this},setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,i=n[1],s=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s)){var o=parseFloat(r[1])/360,a=parseInt(r[2],10)/100,_=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(o,a,_)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var u=n[1],c=u.length;if(3===c)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},setColorName:function(t){var e=i[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=u(t.r),this.g=u(t.g),this.b=u(t.b),this},copyLinearToSRGB:function(t){return this.r=c(t.r),this.g=c(t.g),this.b=c(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,n,r=this.r,i=this.g,s=this.b,o=Math.max(r,i,s),a=Math.min(r,i,s),_=(a+o)/2;if(a===o)e=0,n=0;else{var u=o-a;switch(n=_<=.5?u/(o+a):u/(2-o-a),o){case r:e=(i-s)/u+(i<s?6:0);break;case i:e=(s-r)/u+2;break;case s:e=(r-i)/u+4}e/=6}return t.h=e,t.s=n,t.l=_,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){return this.getHSL(s),s.h+=t,s.s+=e,s.l+=n,this.setHSL(s.h,s.s,s.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(s),t.getHSL(o);var n=r.a.lerp(s.h,o.h,e),i=r.a.lerp(s.s,o.s,e),a=r.a.lerp(s.l,o.l,e);return this.setHSL(n,i,a),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}}),a.NAMES=i},function(t,e,n){"use strict";n.d(e,"a",(function(){return E}));var r=n(21),i=n(2),s=n(29),o=n(59),a=n(140),_=n(144),u=n(38),c=n(10),h=0,l=new i.a,d=new r.a,p=new s.a,f=new i.a,m=new i.a,v=new i.a,g=new r.a,y=new i.a(1,0,0),x=new i.a(0,1,0),b=new i.a(0,0,1),w={type:"added"},k={type:"removed"};function E(){Object.defineProperty(this,"id",{value:h++}),this.uuid=c.a.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=E.DefaultUp.clone();var t=new i.a,e=new a.a,n=new r.a,o=new i.a(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new s.a},normalMatrix:{value:new u.a}}),this.matrix=new s.a,this.matrixWorld=new s.a,this.matrixAutoUpdate=E.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new _.a,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}E.DefaultUp=new i.a(0,1,0),E.DefaultMatrixAutoUpdate=!0,E.prototype=Object.assign(Object.create(o.a.prototype),{constructor:E,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return d.setFromAxisAngle(t,e),this.quaternion.multiply(d),this},rotateOnWorldAxis:function(t,e){return d.setFromAxisAngle(t,e),this.quaternion.premultiply(d),this},rotateX:function(t){return this.rotateOnAxis(y,t)},rotateY:function(t){return this.rotateOnAxis(x,t)},rotateZ:function(t){return this.rotateOnAxis(b,t)},translateOnAxis:function(t,e){return l.copy(t).applyQuaternion(this.quaternion),this.position.add(l.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(y,t)},translateY:function(t){return this.translateOnAxis(x,t)},translateZ:function(t){return this.translateOnAxis(b,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(p.getInverse(this.matrixWorld))},lookAt:function(t,e,n){t.isVector3?f.copy(t):f.set(t,e,n);var r=this.parent;this.updateWorldMatrix(!0,!1),m.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?p.lookAt(m,f,this.up):p.lookAt(f,m,this.up),this.quaternion.setFromRotationMatrix(p),r&&(p.extractRotation(r.matrixWorld),d.setFromRotationMatrix(p),this.quaternion.premultiply(d.inverse()))},add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(w)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(k)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),p.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),p.multiply(t.parent.matrixWorld)),t.applyMatrix4(p),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new i.a),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new r.a),this.updateMatrixWorld(!0),this.matrixWorld.decompose(m,t,v),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new i.a),this.updateMatrixWorld(!0),this.matrixWorld.decompose(m,g,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new i.a),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var r=this.children,i=0,s=r.length;i<s;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(t){var e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);var s=this.geometry.parameters;if(void 0!==s&&void 0!==s.shapes){var o=s.shapes;if(Array.isArray(o))for(var a=0,_=o.length;a<_;a++){var u=o[a];i(t.shapes,u)}else i(t.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(a=0,_=this.material.length;a<_;a++)c.push(i(t.materials,this.material[a]));r.material=c}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(t).object)}if(e){var h=f(t.geometries),l=f(t.materials),d=f(t.textures),p=f(t.images);o=f(t.shapes);h.length>0&&(n.geometries=h),l.length>0&&(n.materials=l),d.length>0&&(n.textures=d),p.length>0&&(n.images=p),o.length>0&&(n.shapes=o)}return n.object=r,n;function f(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var r=t.children[n];this.add(r.clone())}return this}})},function(t,e,n){var r=n(40),i=n(205),s=n(206),o=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":o&&o in Object(t)?i(t):s(t)}},function(t,e){t.exports=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var s=t[e];s&&(i[r++]=s)}return i}},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r,i=n(31),s=n.n(i),o=n(4),a=n(122),_=n(180),u=n(14),c=n(10);class h{constructor(t=0,e=0){this._position=t,this._value=e}to_json(){return{position:this._position,value:this._value}}get position(){return this._position}get value(){return this._value}copy(t){this._position=t.position,this._value=t.value}clone(){const t=new h;return t.copy(this),t}is_equal(t){return this._position==t.position&&this._value==t.value}is_equal_json(t){return this._position==t.position&&this._value==t.value}from_json(t){this._position=t.position,this._value=t.value}static are_equal_json(t,e){return t.position==e.position&&t.value==e.value}static from_json(t){return new h(t.position,t.value)}}!function(t){t.LINEAR="linear"}(r||(r={}));class l{constructor(t=r.LINEAR,e=[]){this._interpolation=t,this._points=e,this._uuid=c.a.generateUUID()}get uuid(){return this._uuid}get interpolation(){return this._interpolation}get points(){return this._points}static from_json(t){const e=[];for(let n of t.points)e.push(h.from_json(n));return new l(t.interpolation,e)}to_json(){return{interpolation:this._interpolation,points:this._points.map(t=>t.to_json())}}clone(){const t=new l;return t.copy(this),t}copy(t){this._interpolation=t.interpolation;let e=0;for(let n of t.points){const t=this._points[e];t?t.copy(n):this._points.push(n.clone()),e+=1}}is_equal(t){if(this._interpolation!=t.interpolation)return!1;const e=t.points;if(this._points.length!=e.length)return!1;let n=0;for(let t of this._points){const r=e[n];if(!t.is_equal(r))return!1;n+=1}return!0}is_equal_json(t){if(this._interpolation!=t.interpolation)return!1;if(this._points.length!=t.points.length)return!1;let e=0;for(let n of this._points){const r=t.points[e];if(!n.is_equal_json(r))return!1;e+=1}return!0}static are_json_equal(t,e){if(t.interpolation!=e.interpolation)return!1;if(t.points.length!=e.points.length)return!1;let n=0;for(let r of t.points){const t=e.points[n];if(!h.are_equal_json(r,t))return!1;n+=1}return!0}from_json(t){this._interpolation=t.interpolation;let e=0;for(let n of t.points){const t=this._points[e];t?t.from_json(n):this._points.push(h.from_json(n)),e+=1}}}var d=n(0),p=n(8);class f extends u.b{constructor(){super(...arguments),this._reset_ramp_interpolant_and_texture_bound=this._reset_ramp_interpolant_and_texture.bind(this)}static type(){return d.a.RAMP}get default_value_serialized(){return this.default_value instanceof l?this.default_value.to_json():this.default_value}_clone_raw_input(t){return t instanceof l?t.clone():l.from_json(t).to_json()}get raw_input_serialized(){return this._raw_input instanceof l?this._raw_input.to_json():l.from_json(this._raw_input).to_json()}get value_serialized(){return this.value.to_json()}static are_raw_input_equal(t,e){return t instanceof l?e instanceof l?t.is_equal(e):t.is_equal_json(e):e instanceof l?e.is_equal_json(t):l.are_json_equal(t,e)}static are_values_equal(t,e){return t.is_equal(e)}initialize_param(){this.add_post_dirty_hook("_reset_ramp_interpolant_and_texture",this._reset_ramp_interpolant_and_texture_bound)}get is_default(){return this.default_value instanceof l?this.value.is_equal(this.default_value):this.value.is_equal_json(this.default_value)}process_raw_input(){this._raw_input instanceof l?this._value?this._value.copy(this._raw_input):this._value=this._raw_input:this._value?this._value.from_json(this._raw_input):this._value=l.from_json(this._raw_input),this.emit_controller.emit(p.a.VALUE_UPDATED)}has_expression(){return!1}_reset_ramp_interpolant_and_texture(){this._ramp_interpolant=void 0,this._ramp_texture=void 0}ramp_texture(){return this._ramp_texture=this._ramp_texture||this._create_ramp_texture()}_create_ramp_texture(){const t=new Uint8Array(3072);let e=0,n=0,r=0;for(var i=0;i<1024;i++)e=3*i,n=i/1024,r=this.value_at_position(n),t[e]=255*r;const s=new a.a(t,1024,1,o.dc);return s.needsUpdate=!0,s}static create_interpolant(t,e){const n=new Float32Array(1);return new _.a(t,e,1,n)}interpolant(){return this._ramp_interpolant=this._ramp_interpolant||this._create_interpolant()}_create_interpolant(){const t=this.value.points,e=s()(t,t=>t.position),n=new Float32Array(e.length),r=new Float32Array(e.length);let i=0;for(let t of e)n[i]=t.position,r[i]=t.value,i++;return f.create_interpolant(n,r)}value_at_position(t){return this.interpolant().evaluate(t)[0]}}f.DEFAULT_VALUE=new l(r.LINEAR,[new h(0,0),new h(1,1)]),f.DEFAULT_VALUE_JSON=f.DEFAULT_VALUE.to_json()},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(2),i=new r.a,s=new h,o=new r.a(0,0,0),a=new r.a(1,1,1),_=new r.a,u=new r.a,c=new r.a;function h(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(h.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,s,o,a,_,u,c,h,l,d,p,f){var m=this.elements;return m[0]=t,m[4]=e,m[8]=n,m[12]=r,m[1]=i,m[5]=s,m[9]=o,m[13]=a,m[2]=_,m[6]=u,m[10]=c,m[14]=h,m[3]=l,m[7]=d,m[11]=p,m[15]=f,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new h).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,n=t.elements,r=1/i.setFromMatrixColumn(t,0).length(),s=1/i.setFromMatrixColumn(t,1).length(),o=1/i.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*s,e[5]=n[5]*s,e[6]=n[6]*s,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,s=Math.cos(n),o=Math.sin(n),a=Math.cos(r),_=Math.sin(r),u=Math.cos(i),c=Math.sin(i);if("XYZ"===t.order){var h=s*u,l=s*c,d=o*u,p=o*c;e[0]=a*u,e[4]=-a*c,e[8]=_,e[1]=l+d*_,e[5]=h-p*_,e[9]=-o*a,e[2]=p-h*_,e[6]=d+l*_,e[10]=s*a}else if("YXZ"===t.order){var f=a*u,m=a*c,v=_*u,g=_*c;e[0]=f+g*o,e[4]=v*o-m,e[8]=s*_,e[1]=s*c,e[5]=s*u,e[9]=-o,e[2]=m*o-v,e[6]=g+f*o,e[10]=s*a}else if("ZXY"===t.order){f=a*u,m=a*c,v=_*u,g=_*c;e[0]=f-g*o,e[4]=-s*c,e[8]=v+m*o,e[1]=m+v*o,e[5]=s*u,e[9]=g-f*o,e[2]=-s*_,e[6]=o,e[10]=s*a}else if("ZYX"===t.order){h=s*u,l=s*c,d=o*u,p=o*c;e[0]=a*u,e[4]=d*_-l,e[8]=h*_+p,e[1]=a*c,e[5]=p*_+h,e[9]=l*_-d,e[2]=-_,e[6]=o*a,e[10]=s*a}else if("YZX"===t.order){var y=s*a,x=s*_,b=o*a,w=o*_;e[0]=a*u,e[4]=w-y*c,e[8]=b*c+x,e[1]=c,e[5]=s*u,e[9]=-o*u,e[2]=-_*u,e[6]=x*c+b,e[10]=y-w*c}else if("XZY"===t.order){y=s*a,x=s*_,b=o*a,w=o*_;e[0]=a*u,e[4]=-c,e[8]=_*u,e[1]=y*c+w,e[5]=s*u,e[9]=x*c-b,e[2]=b*c-x,e[6]=o*u,e[10]=w*c+y}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(o,t,a)},lookAt:function(t,e,n){var r=this.elements;return c.subVectors(t,e),0===c.lengthSq()&&(c.z=1),c.normalize(),_.crossVectors(n,c),0===_.lengthSq()&&(1===Math.abs(n.z)?c.x+=1e-4:c.z+=1e-4,c.normalize(),_.crossVectors(n,c)),_.normalize(),u.crossVectors(c,_),r[0]=_.x,r[4]=u.x,r[8]=c.x,r[1]=_.y,r[5]=u.y,r[9]=c.y,r[2]=_.z,r[6]=u.z,r[10]=c.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,s=n[0],o=n[4],a=n[8],_=n[12],u=n[1],c=n[5],h=n[9],l=n[13],d=n[2],p=n[6],f=n[10],m=n[14],v=n[3],g=n[7],y=n[11],x=n[15],b=r[0],w=r[4],k=r[8],E=r[12],M=r[1],O=r[5],j=r[9],A=r[13],z=r[2],T=r[6],S=r[10],P=r[14],R=r[3],C=r[7],q=r[11],D=r[15];return i[0]=s*b+o*M+a*z+_*R,i[4]=s*w+o*O+a*T+_*C,i[8]=s*k+o*j+a*S+_*q,i[12]=s*E+o*A+a*P+_*D,i[1]=u*b+c*M+h*z+l*R,i[5]=u*w+c*O+h*T+l*C,i[9]=u*k+c*j+h*S+l*q,i[13]=u*E+c*A+h*P+l*D,i[2]=d*b+p*M+f*z+m*R,i[6]=d*w+p*O+f*T+m*C,i[10]=d*k+p*j+f*S+m*q,i[14]=d*E+p*A+f*P+m*D,i[3]=v*b+g*M+y*z+x*R,i[7]=v*w+g*O+y*T+x*C,i[11]=v*k+g*j+y*S+x*q,i[15]=v*E+g*A+y*P+x*D,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],s=t[1],o=t[5],a=t[9],_=t[13],u=t[2],c=t[6],h=t[10],l=t[14];return t[3]*(+i*a*c-r*_*c-i*o*h+n*_*h+r*o*l-n*a*l)+t[7]*(+e*a*l-e*_*h+i*s*h-r*s*l+r*_*u-i*a*u)+t[11]*(+e*_*c-e*o*l-i*s*c+n*s*l+i*o*u-n*_*u)+t[15]*(-r*o*u-e*a*c+e*o*h+r*s*c-n*s*h+n*a*u)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,n){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var n=this.elements,r=t.elements,i=r[0],s=r[1],o=r[2],a=r[3],_=r[4],u=r[5],c=r[6],h=r[7],l=r[8],d=r[9],p=r[10],f=r[11],m=r[12],v=r[13],g=r[14],y=r[15],x=d*g*h-v*p*h+v*c*f-u*g*f-d*c*y+u*p*y,b=m*p*h-l*g*h-m*c*f+_*g*f+l*c*y-_*p*y,w=l*v*h-m*d*h+m*u*f-_*v*f-l*u*y+_*d*y,k=m*d*c-l*v*c-m*u*p+_*v*p+l*u*g-_*d*g,E=i*x+s*b+o*w+a*k;if(0===E)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var M=1/E;return n[0]=x*M,n[1]=(v*p*a-d*g*a-v*o*f+s*g*f+d*o*y-s*p*y)*M,n[2]=(u*g*a-v*c*a+v*o*h-s*g*h-u*o*y+s*c*y)*M,n[3]=(d*c*a-u*p*a-d*o*h+s*p*h+u*o*f-s*c*f)*M,n[4]=b*M,n[5]=(l*g*a-m*p*a+m*o*f-i*g*f-l*o*y+i*p*y)*M,n[6]=(m*c*a-_*g*a-m*o*h+i*g*h+_*o*y-i*c*y)*M,n[7]=(_*p*a-l*c*a+l*o*h-i*p*h-_*o*f+i*c*f)*M,n[8]=w*M,n[9]=(m*d*a-l*v*a-m*s*f+i*v*f+l*s*y-i*d*y)*M,n[10]=(_*v*a-m*u*a+m*s*h-i*v*h-_*s*y+i*u*y)*M,n[11]=(l*u*a-_*d*a-l*s*h+i*d*h+_*s*f-i*u*f)*M,n[12]=k*M,n[13]=(l*v*o-m*d*o+m*s*p-i*v*p-l*s*g+i*d*g)*M,n[14]=(m*u*o-_*v*o-m*s*c+i*v*c+_*s*g-i*u*g)*M,n[15]=(_*d*o-l*u*o+l*s*c-i*d*c-_*s*p+i*u*p)*M,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,s=t.x,o=t.y,a=t.z,_=i*s,u=i*o;return this.set(_*s+n,_*o-r*a,_*a+r*o,0,_*o+r*a,u*o+n,u*a-r*s,0,_*a-r*o,u*a+r*s,i*a*a+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var r=this.elements,i=e._x,s=e._y,o=e._z,a=e._w,_=i+i,u=s+s,c=o+o,h=i*_,l=i*u,d=i*c,p=s*u,f=s*c,m=o*c,v=a*_,g=a*u,y=a*c,x=n.x,b=n.y,w=n.z;return r[0]=(1-(p+m))*x,r[1]=(l+y)*x,r[2]=(d-g)*x,r[3]=0,r[4]=(l-y)*b,r[5]=(1-(h+m))*b,r[6]=(f+v)*b,r[7]=0,r[8]=(d+g)*w,r[9]=(f-v)*w,r[10]=(1-(h+p))*w,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},decompose:function(t,e,n){var r=this.elements,o=i.set(r[0],r[1],r[2]).length(),a=i.set(r[4],r[5],r[6]).length(),_=i.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),t.x=r[12],t.y=r[13],t.z=r[14],s.copy(this);var u=1/o,c=1/a,h=1/_;return s.elements[0]*=u,s.elements[1]*=u,s.elements[2]*=u,s.elements[4]*=c,s.elements[5]*=c,s.elements[6]*=c,s.elements[8]*=h,s.elements[9]*=h,s.elements[10]*=h,e.setFromRotationMatrix(s),n.x=o,n.y=a,n.z=_,this},makePerspective:function(t,e,n,r,i,s){void 0===s&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,a=2*i/(e-t),_=2*i/(n-r),u=(e+t)/(e-t),c=(n+r)/(n-r),h=-(s+i)/(s-i),l=-2*s*i/(s-i);return o[0]=a,o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=_,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=l,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(t,e,n,r,i,s){var o=this.elements,a=1/(e-t),_=1/(n-r),u=1/(s-i),c=(e+t)*a,h=(n+r)*_,l=(s+i)*u;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*_,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-l,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}})},function(t,e,n){var r=n(171);t.exports=function(t){return t&&t.length?r(t):[]}},function(t,e,n){var r=n(53),i=n(319),s=n(84),o=n(128),a=s((function(t,e){if(null==t)return[];var n=e.length;return n>1&&o(t,e[0],e[1])?e=[]:n>2&&o(e[0],e[1],e[2])&&(e=[e[0]]),i(t,r(e,1),[])}));t.exports=a},function(t,e,n){var r=n(204),i=n(209);t.exports=function(t,e){var n=i(t,e);return r(n)?n:void 0}},function(t,e,n){var r=n(106);t.exports=function(t){return null==t?"":r(t)}},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.ALWAYS="always",t.NEVER="never",t.FROM_NODE="from_node"}(r||(r={}))},function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.COP="cop",t.EVENT="event",t.GL="gl",t.JS="js",t.MANAGER="managers",t.MAT="mat",t.OBJ="objects",t.SOP="sop",t.POST="post"}(r||(r={}))},function(t,e,n){"use strict";function r(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}n.d(e,"a",(function(){return r})),Object.defineProperties(r.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(r.prototype,{isVector4:!0,set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=this.w,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*r+s[12]*i,this.y=s[1]*e+s[5]*n+s[9]*r+s[13]*i,this.z=s[2]*e+s[6]*n+s[10]*r+s[14]*i,this.w=s[3]*e+s[7]*n+s[11]*r+s[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,r,i,s=t.elements,o=s[0],a=s[4],_=s[8],u=s[1],c=s[5],h=s[9],l=s[2],d=s[6],p=s[10];if(Math.abs(a-u)<.01&&Math.abs(_-l)<.01&&Math.abs(h-d)<.01){if(Math.abs(a+u)<.1&&Math.abs(_+l)<.1&&Math.abs(h+d)<.1&&Math.abs(o+c+p-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var f=(o+1)/2,m=(c+1)/2,v=(p+1)/2,g=(a+u)/4,y=(_+l)/4,x=(h+d)/4;return f>m&&f>v?f<.01?(n=0,r=.707106781,i=.707106781):(r=g/(n=Math.sqrt(f)),i=y/n):m>v?m<.01?(n=.707106781,r=0,i=.707106781):(n=g/(r=Math.sqrt(m)),i=x/r):v<.01?(n=.707106781,r=.707106781,i=0):(n=y/(i=Math.sqrt(v)),r=x/i),this.set(n,r,i,e),this}var b=Math.sqrt((d-h)*(d-h)+(_-l)*(_-l)+(u-a)*(u-a));return Math.abs(b)<.001&&(b=1),this.x=(d-h)/b,this.y=(_-l)/b,this.z=(u-a)/b,this.w=Math.acos((o+c+p-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1);class i{constructor(t,e){this.node=t,this._callbacks=[],this._container=new e(this.node)}get container(){return this._container}request_container(){return new Promise((t,e)=>{this._callbacks.push(t),this.node.scene.cook_controller.add_node(this.node),setTimeout(this.process_container_request.bind(this),0)})}process_container_request(){var t,e;if(null===(e=null===(t=this.node.flags)||void 0===t?void 0:t.bypass)||void 0===e?void 0:e.active){const t=0;this.request_input_container(t).then(t=>{this.node.remove_dirty_state(),t?this.notify_requesters(t):this.node.states.error.set("input invalid")})}else this.node.is_dirty?(this.node.container_controller.container.reset_caches(),this.node.cook_controller.cook_main()):this.notify_requesters()}request_input_container(t){return Object(r.a)(this,void 0,void 0,(function*(){const e=this.node.io.inputs.input(t);if(e){return e.processing_context.copy(this.node.processing_context),yield e.container_controller.request_container()}return this.node.states.error.set(`input ${t} required`),this.notify_requesters(),null}))}notify_requesters(t){let e;const n=[];for(;e=this._callbacks.pop();)n.push(e);for(t||(t=this.node.container_controller.container.clone());e=n.pop();)e(t);this.node.scene.cook_controller.remove_node(this.node)}}},function(t,e,n){"use strict";function r(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}n.d(e,"a",(function(){return r})),Object.assign(r.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,s,o,a,_){var u=this.elements;return u[0]=t,u[1]=r,u[2]=o,u[3]=e,u[4]=i,u[5]=a,u[6]=n,u[7]=s,u[8]=_,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},extractBasis:function(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,s=n[0],o=n[3],a=n[6],_=n[1],u=n[4],c=n[7],h=n[2],l=n[5],d=n[8],p=r[0],f=r[3],m=r[6],v=r[1],g=r[4],y=r[7],x=r[2],b=r[5],w=r[8];return i[0]=s*p+o*v+a*x,i[3]=s*f+o*g+a*b,i[6]=s*m+o*y+a*w,i[1]=_*p+u*v+c*x,i[4]=_*f+u*g+c*b,i[7]=_*m+u*y+c*w,i[2]=h*p+l*v+d*x,i[5]=h*f+l*g+d*b,i[8]=h*m+l*y+d*w,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],_=t[7],u=t[8];return e*s*u-e*o*_-n*i*u+n*o*a+r*i*_-r*s*a},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var n=t.elements,r=this.elements,i=n[0],s=n[1],o=n[2],a=n[3],_=n[4],u=n[5],c=n[6],h=n[7],l=n[8],d=l*_-u*h,p=u*c-l*a,f=h*a-_*c,m=i*d+s*p+o*f;if(0===m)return this.set(0,0,0,0,0,0,0,0,0);var v=1/m;return r[0]=d*v,r[1]=(o*h-l*s)*v,r[2]=(u*s-o*_)*v,r[3]=p*v,r[4]=(l*i-o*c)*v,r[5]=(o*a-u*i)*v,r[6]=f*v,r[7]=(s*c-h*i)*v,r[8]=(_*i-s*a)*v,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,s,o){var a=Math.cos(i),_=Math.sin(i);this.set(n*a,n*_,-n*(a*s+_*o)+s+t,-r*_,r*a,-r*(-_*s+a*o)+o+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],s=r[3],o=r[6],a=r[1],_=r[4],u=r[7];return r[0]=e*i+n*a,r[3]=e*s+n*_,r[6]=e*o+n*u,r[1]=-n*i+e*a,r[4]=-n*s+e*_,r[7]=-n*o+e*u,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}})},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}));class r{constructor(t){this._node=t}set_node(t){this._node=t}node(){return this._node}clone(){let t;const e=new this.constructor;return e.set_node(this.node()),null!=(t=this.content())&&e.set_content(t),e}reset_caches(){}set_content(t){this.reset_caches(),this._content=t,this._post_set_content()}has_content(){return null!=this._content}content(){return this._content}_post_set_content(){}core_content(){return this._content}core_content_cloned(){return this._content}infos(){return[]}}class i extends r{}},function(t,e,n){var r=n(19).Symbol;t.exports=r},function(t,e,n){var r=n(233),i=n(93),s=n(234),o=n(157),a=n(235),_=n(26),u=n(147),c=u(r),h=u(i),l=u(s),d=u(o),p=u(a),f=_;(r&&"[object DataView]"!=f(new r(new ArrayBuffer(1)))||i&&"[object Map]"!=f(new i)||s&&"[object Promise]"!=f(s.resolve())||o&&"[object Set]"!=f(new o)||a&&"[object WeakMap]"!=f(new a))&&(f=function(t){var e=_(t),n="[object Object]"==e?t.constructor:void 0,r=n?u(n):"";if(r)switch(r){case c:return"[object DataView]";case h:return"[object Map]";case l:return"[object Promise]";case d:return"[object Set]";case p:return"[object WeakMap]"}return e}),t.exports=f},function(t,e,n){var r=n(250),i=n(260),s=n(50),o=n(3),a=n(267);t.exports=function(t){return"function"==typeof t?t:null==t?s:"object"==typeof t?o(t)?i(t[0],t[1]):r(t):a(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(1),i=n(5),s=n.n(i),o=n(3),a=n.n(o),_=n(14),u=n(81),c=n(8);class h extends _.b{get is_numeric(){return!0}get is_default(){return this._raw_input==this.default_value}_prefilter_invalid_raw_input(t){return a()(t)?t[0]:t}process_raw_input(){this.states.error.clear();const t=this.convert(this._raw_input);null!=t?(this._expression_controller&&(this._expression_controller.set_expression(void 0,!1),this.emit_controller.emit(c.a.EXPRESSION_UPDATED)),t!=this._value&&(this._update_value(t),this.set_successors_dirty(this))):s()(this._raw_input)?(this._expression_controller=this._expression_controller||new u.a(this),this._raw_input!=this._expression_controller.expression&&(this._expression_controller.set_expression(this._raw_input),this.emit_controller.emit(c.a.EXPRESSION_UPDATED))):this.states.error.set(`param input is invalid (${this.full_path()})`)}process_computation(){var t;return Object(r.a)(this,void 0,void 0,(function*(){if((null===(t=this.expression_controller)||void 0===t?void 0:t.active)&&!this.expression_controller.requires_entities){const t=yield this.expression_controller.compute_expression();if(this.expression_controller.is_errored)this.states.error.set(`expression error: "${this.expression_controller.expression}" (${this.expression_controller.error_message})`);else{const e=this.convert(t);null!=e?(this.states.error.active&&this.states.error.clear(),this._update_value(e)):this.states.error.set(`expression returns an invalid type (${t}) (${this.expression_controller.expression})`)}}}))}_update_value(t){this._value=t,this.parent_param&&this.parent_param.set_value_from_components(),this.options.execute_callback(),this.emit_controller.emit(c.a.VALUE_UPDATED),this.remove_dirty_state()}}},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return a}));var r=n(0),i=n(28);class s{constructor(t,e,n){this.type=t,this.init_value=e,this.options=n}}class o{static BUTTON(t,e){return new s(r.a.BUTTON,t,e)}static BOOLEAN(t,e){return new s(r.a.BOOLEAN,t,e)}static COLOR(t,e){return new s(r.a.COLOR,t,e)}static FLOAT(t,e){return new s(r.a.FLOAT,t,e)}static FOLDER(t=null,e){return new s(r.a.FOLDER,t,e)}static INTEGER(t,e){return new s(r.a.INTEGER,t,e)}static OPERATOR_PATH(t,e){return new s(r.a.OPERATOR_PATH,t,e)}static RAMP(t=i.a.DEFAULT_VALUE,e){return new s(r.a.RAMP,t,e)}static SEPARATOR(t=null,e){return new s(r.a.SEPARATOR,t,e)}static STRING(t="",e){return new s(r.a.STRING,t,e)}static VECTOR2(t,e){return new s(r.a.VECTOR2,t,e)}static VECTOR3(t,e){return new s(r.a.VECTOR3,t,e)}static VECTOR4(t,e){return new s(r.a.VECTOR4,t,e)}}class a{}},function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"e",(function(){return o})),n.d(e,"d",(function(){return a})),n.d(e,"f",(function(){return _})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return c}));var r,i=n(0),s=n(28);!function(t){t.BOOL="bool",t.INT="int",t.FLOAT="float",t.VEC2="vec2",t.VEC3="vec3",t.VEC4="vec4",t.SAMPLER_2D="sampler2D"}(r||(r={}));const o=[r.BOOL,r.INT,r.FLOAT,r.VEC2,r.VEC3,r.VEC4],a={[r.BOOL]:i.a.BOOLEAN,[r.INT]:i.a.INTEGER,[r.FLOAT]:i.a.FLOAT,[r.VEC2]:i.a.VECTOR2,[r.VEC3]:i.a.VECTOR3,[r.VEC4]:i.a.VECTOR4,[r.SAMPLER_2D]:i.a.RAMP},_={[i.a.BOOLEAN]:r.BOOL,[i.a.COLOR]:r.VEC3,[i.a.INTEGER]:r.INT,[i.a.FLOAT]:r.FLOAT,[i.a.FOLDER]:void 0,[i.a.VECTOR2]:r.VEC2,[i.a.VECTOR3]:r.VEC3,[i.a.VECTOR4]:r.VEC4,[i.a.BUTTON]:void 0,[i.a.OPERATOR_PATH]:void 0,[i.a.RAMP]:void 0,[i.a.SEPARATOR]:void 0,[i.a.STRING]:void 0},u={[r.BOOL]:!1,[r.INT]:0,[r.FLOAT]:0,[r.VEC2]:[0,0],[r.VEC3]:[0,0,0],[r.VEC4]:[0,0,0,0],[r.SAMPLER_2D]:s.a.DEFAULT_VALUE_JSON},c={[r.BOOL]:1,[r.INT]:1,[r.FLOAT]:1,[r.VEC2]:2,[r.VEC3]:3,[r.VEC4]:4,[r.SAMPLER_2D]:1}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}},function(t,e,n){var r=n(53);t.exports=function(t){return(null==t?0:t.length)?r(t,1):[]}},function(t,e,n){(function(t){var r=n(19),i=n(224),s=e&&!e.nodeType&&e,o=s&&"object"==typeof t&&t&&!t.nodeType&&t,a=o&&o.exports===s?r.Buffer:void 0,_=(a?a.isBuffer:void 0)||i;t.exports=_}).call(this,n(96)(t))},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e){t.exports=function(t){return t}},function(t,e,n){var r=n(26),i=n(18);t.exports=function(t){return"symbol"==typeof t||i(t)&&"[object Symbol]"==r(t)}},function(t,e,n){var r=n(161),i=n(247)(r);t.exports=i},function(t,e,n){var r=n(73),i=n(279);t.exports=function t(e,n,s,o,a){var _=-1,u=e.length;for(s||(s=i),a||(a=[]);++_<u;){var c=e[_];n>0&&s(c)?n>1?t(c,n-1,s,o,a):r(a,c):o||(a[a.length]=c)}return a}},function(t,e,n){var r=n(145);t.exports=function(t){return r(t,5)}},function(t,e,n){var r=n(103);t.exports=function(t,e){return r(t,e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(5),i=n.n(r),s=n(57),o=n.n(s);o.a.addUnaryOp("@");o.a.addBinaryOp("**",10);class a{constructor(){}parse_expression(t){try{this.reset(),this.node=o()(t)}catch(e){const n=`could not parse the expression '${t}' (error: ${e})`;this.error_message=n}}parse_expression_for_string_param(t){try{this.reset();const e=a.string_value_elements(t),n=[];for(let t=0;t<e.length;t++){const r=e[t];let i;i=t%2==1?o()(r):{type:"Literal",value:`'${r}'`,raw:`'${r}'`},n.push(i)}this.node={type:"CallExpression",arguments:n,callee:{type:"Identifier",name:"str_concat"}}}catch(e){const n=`could not parse the expression '${t}' (error: ${e})`;this.error_message=n}}static string_value_elements(t){return null!=t&&i()(t)?t.split("`"):[]}reset(){this.node=void 0,this.error_message=void 0}}},function(t,e,n){!function(n){"use strict";var r=function(t,e){var n=new Error(t+" at character "+e);throw n.index=e,n.description=t,n},i={"-":!0,"!":!0,"~":!0,"+":!0},s={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},o=function(t){var e,n=0;for(var r in t)(e=r.length)>n&&t.hasOwnProperty(r)&&(n=e);return n},a=o(i),_=o(s),u={true:!0,false:!1,null:null},c=function(t){return s[t]||0},h=function(t,e,n){return{type:"||"===t||"&&"===t?"LogicalExpression":"BinaryExpression",operator:t,left:e,right:n}},l=function(t){return t>=48&&t<=57},d=function(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=128&&!s[String.fromCharCode(t)]},p=function(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||t>=128&&!s[String.fromCharCode(t)]},f=function(t){for(var e,n,o=0,f=t.charAt,m=t.charCodeAt,v=function(e){return f.call(t,e)},g=function(e){return m.call(t,e)},y=t.length,x=function(){for(var t=g(o);32===t||9===t||10===t||13===t;)t=g(++o)},b=function(){var t,e,n=k();return x(),63!==g(o)?n:(o++,(t=b())||r("Expected expression",o),x(),58===g(o)?(o++,(e=b())||r("Expected expression",o),{type:"ConditionalExpression",test:n,consequent:t,alternate:e}):void r("Expected :",o))},w=function(){x();for(var e=t.substr(o,_),n=e.length;n>0;){if(s.hasOwnProperty(e)&&(!d(g(o))||o+e.length<t.length&&!p(g(o+e.length))))return o+=n,e;e=e.substr(0,--n)}return!1},k=function(){var t,e,n,i,s,a,_,u;if(a=E(),!(e=w()))return a;for(s={value:e,prec:c(e)},(_=E())||r("Expected expression after "+e,o),i=[a,s,_];(e=w())&&0!==(n=c(e));){for(s={value:e,prec:n};i.length>2&&n<=i[i.length-2].prec;)_=i.pop(),e=i.pop().value,a=i.pop(),t=h(e,a,_),i.push(t);(t=E())||r("Expected expression after "+e,o),i.push(s,t)}for(t=i[u=i.length-1];u>1;)t=h(i[u-1].value,i[u-2],t),u-=2;return t},E=function(){var e,n,r;if(x(),e=g(o),l(e)||46===e)return M();if(39===e||34===e)return O();if(91===e)return S();for(r=(n=t.substr(o,a)).length;r>0;){if(i.hasOwnProperty(n)&&(!d(g(o))||o+n.length<t.length&&!p(g(o+n.length))))return o+=r,{type:"UnaryExpression",operator:n,argument:E(),prefix:!0};n=n.substr(0,--r)}return!(!d(e)&&40!==e)&&z()},M=function(){for(var t,e,n="";l(g(o));)n+=v(o++);if(46===g(o))for(n+=v(o++);l(g(o));)n+=v(o++);if("e"===(t=v(o))||"E"===t){for(n+=v(o++),"+"!==(t=v(o))&&"-"!==t||(n+=v(o++));l(g(o));)n+=v(o++);l(g(o-1))||r("Expected exponent ("+n+v(o)+")",o)}return e=g(o),d(e)?r("Variable names cannot start with a number ("+n+v(o)+")",o):46===e&&r("Unexpected period",o),{type:"Literal",value:parseFloat(n),raw:n}},O=function(){for(var t,e="",n=v(o++),i=!1;o<y;){if((t=v(o++))===n){i=!0;break}if("\\"===t)switch(t=v(o++)){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+=t}else e+=t}return i||r('Unclosed quote after "'+e+'"',o),{type:"Literal",value:e,raw:n+e+n}},j=function(){var e,n=g(o),i=o;for(d(n)?o++:r("Unexpected "+v(o),o);o<y&&(n=g(o),p(n));)o++;return e=t.slice(i,o),u.hasOwnProperty(e)?{type:"Literal",value:u[e],raw:e}:"this"===e?{type:"ThisExpression"}:{type:"Identifier",name:e}},A=function(t){for(var e,n,i=[],s=!1;o<y;){if(x(),(e=g(o))===t){s=!0,o++;break}44===e?o++:((n=b())&&"Compound"!==n.type||r("Expected comma",o),i.push(n))}return s||r("Expected "+String.fromCharCode(t),o),i},z=function(){var t,e;for(e=40===(t=g(o))?T():j(),x(),t=g(o);46===t||91===t||40===t;)o++,46===t?(x(),e={type:"MemberExpression",computed:!1,object:e,property:j()}):91===t?(e={type:"MemberExpression",computed:!0,object:e,property:b()},x(),93!==(t=g(o))&&r("Unclosed [",o),o++):40===t&&(e={type:"CallExpression",arguments:A(41),callee:e}),x(),t=g(o);return e},T=function(){o++;var t=b();if(x(),41===g(o))return o++,t;r("Unclosed (",o)},S=function(){return o++,{type:"ArrayExpression",elements:A(93)}},P=[];o<y;)59===(e=g(o))||44===e?o++:(n=b())?P.push(n):o<y&&r('Unexpected "'+v(o)+'"',o);return 1===P.length?P[0]:{type:"Compound",body:P}};f.version="0.3.4",f.toString=function(){return"JavaScript Expression Parser (JSEP) v"+f.version},f.addUnaryOp=function(t){return a=Math.max(t.length,a),i[t]=!0,this},f.addBinaryOp=function(t,e){return _=Math.max(t.length,_),s[t]=e,this},f.addLiteral=function(t,e){return u[t]=e,this},f.removeUnaryOp=function(t){return delete i[t],t.length===a&&(a=o(i)),this},f.removeAllUnaryOps=function(){return i={},a=0,this},f.removeBinaryOp=function(t){return delete s[t],t.length===_&&(_=o(s)),this},f.removeAllBinaryOps=function(){return s={},_=0,this},f.removeLiteral=function(t){return delete u[t],this},f.removeAllLiterals=function(){return u={},this},t.exports?e=t.exports=f:e.parse=f}()},function(t,e,n){"use strict";n.d(e,"b",(function(){return ft})),n.d(e,"a",(function(){return mt}));var r=n(1),i=n(13),s=n(12),o=n(24),a=n(7);class _{constructor(t,e=0,n=0){this.node=t,this._position=new s.a,this._width=50,this._border_radius=3,this._color=new o.a(.75,.75,.75),this._layout_vertical=!0,this._json={x:0,y:0},this._position.x=e,this._position.y=n}set_border_radius(t){this._border_radius=t}border_radius(){return this._border_radius}set_width(t){this._width=t}width(){return this._width}set_comment(t){this._comment=t,this.node.emit(a.a.UI_DATA_COMMENT_UPDATED)}get comment(){return this._comment}set_color(t){this._color=t}color(){return this._color}set_layout_horizontal(){this._layout_vertical=!1}is_layout_vertical(){return this._layout_vertical}copy(t){this._position.copy(t.position),this._color.copy(t.color())}get position(){return this._position}set_position(t,e=0){if(t instanceof s.a)this._position.copy(t);else{const n=t;this._position.set(n,e)}this.node.emit(a.a.UI_DATA_POSITION_UPDATED)}translate(t,e=!1){this._position.add(t),e&&(this._position.x=Math.round(this._position.x),this._position.y=Math.round(this._position.y)),this.node.emit(a.a.UI_DATA_POSITION_UPDATED)}to_json(){return this._json.x=this._position.x,this._json.y=this._position.y,this._json.comment=this._comment,this._json}}class u{constructor(t){this.node=t}}class c extends u{get active(){return this.are_params_time_dependent()||this.are_inputs_time_dependent()}are_params_time_dependent(){const t=this.node.params.names;for(let e of t){const t=this.node.params.get(e);if(t&&t.states.time_dependent.active)return!0}return!1}are_inputs_time_dependent(){const t=this.node.io.inputs.inputs();for(let e of t)if(e&&e.states.time_dependent.active)return!0;return!1}force_time_dependent(){const t=this.node.graph_predecessors().map(t=>t.graph_node_id),e=this.node.scene.time_controller.graph_node;t.includes(e.graph_node_id)||this.node.add_graph_input(e)}unforce_time_dependent(){const t=this.node.scene.time_controller.graph_node;this.node.remove_graph_input(t)}}class h extends u{set(t){this._message!=t&&(console.warn("error",t,this.node.full_path()),this._message=t,this.on_update())}get message(){return this._message}clear(){this.set(void 0)}get active(){return null!=this._message}on_update(){null!=this._message&&this.node.set_container(null,`from error '${this._message}'`),this.node.emit(a.a.ERROR_UPDATED)}}class l{constructor(t){this.node=t,this.time_dependent=new c(this.node),this.error=new h(this.node)}}var d=n(134),p=n.n(d);class f{constructor(t){this.node=t,this._graph_node=new i.a(t.scene,"node_name_controller")}get graph_node(){return this._graph_node}static base_name(t){let e=t.type;const n=e[e.length-1];return p()(parseInt(n))||(e+="_"),`${e}1`}request_name_to_parent(t){const e=this.node.parent;e&&e.children_allowed()&&e.children_controller?e.children_controller.set_child_name(this.node,t):console.warn("request_name_to_parent failed, no parent found")}set_name(t){t!=this.node.name&&this.request_name_to_parent(t)}update_name_from_parent(t){var e;this.node._set_core_name(t),this.post_set_name(),this.post_set_full_path(),this.node.children_allowed()&&(null===(e=this.node.children_controller)||void 0===e||e.children().forEach(t=>{t.name_controller.post_set_full_path()})),this.node.lifecycle.creation_completed&&(this.node.scene.missing_expression_references_controller.check_for_missing_references(this.node),this.node.scene.expressions_controller.regenerate_referring_expressions(this.node)),this.node.emit(a.a.NAME_UPDATED)}add_post_set_name_hook(t){this._on_set_name_hooks=this._on_set_name_hooks||[],this._on_set_name_hooks.push(t)}add_post_set_full_path_hook(t){this._on_set_full_path_hooks=this._on_set_full_path_hooks||[],this._on_set_full_path_hooks.push(t)}post_set_name(){if(this._on_set_name_hooks)for(let t of this._on_set_name_hooks)t()}post_set_full_path(){if(this._on_set_full_path_hooks)for(let t of this._on_set_full_path_hooks)t()}}var m=n(6);class v{constructor(t){this.node=t,this._parent=null}get parent(){return this._parent}set_parent(t){t!=this.node.parent_controller.parent&&(this._parent=t,this._parent&&this.node.name_controller.request_name_to_parent(f.base_name(this.node)))}is_selected(){var t,e,n;return(null===(n=null===(e=null===(t=this.parent)||void 0===t?void 0:t.children_controller)||void 0===e?void 0:e.selection)||void 0===n?void 0:n.contains(this.node))||!1}full_path(){const t=m.a.SEPARATOR;if(null!=this._parent){const e=this._parent.full_path();return e===t?e+this.node.name:e+t+this.node.name}return t}on_set_parent(){if(this._on_set_parent_hooks)for(let t of this._on_set_parent_hooks)t()}find_node(t){if(null==t)return null;if(t===m.a.CURRENT||t===m.a.CURRENT_WITH_SLASH)return this.node;if(t===m.a.PARENT||t===m.a.PARENT_WITH_SLASH)return this.node.parent;const e=m.a.SEPARATOR;t[0]===e&&(t=t.substring(1,t.length));const n=t.split(e);if(1===n.length){const t=n[0];return this.node.children_controller?this.node.children_controller.child_by_name(t):null}return m.a.find_node(this.node,t)}}var g=n(15),y=n(114),x=n.n(y),b=n(23),w=n.n(b),k=n(31),E=n.n(k),M=n(77),O=n.n(M),j=n(137),A=n.n(j),z=n(111),T=n.n(z),S=n(55),P=n.n(S);class R{constructor(t){this._node=t,this._node_ids=[],this._json=[]}node(){return this._node}nodes(){return this._node.scene.graph.nodes_from_ids(this._node_ids)}contains(t){return this._node_ids.includes(t.graph_node_id)}equals(t){const e=t.map(t=>t.graph_node_id).sort();return P()(e,this._node_ids)}clear(){this._node_ids=[],this.send_update_event()}set(t){this._node_ids=[],this.add(t)}add(t){const e=t.map(t=>t.graph_node_id);this._node_ids=T()(this._node_ids,e),this.send_update_event()}remove(t){const e=t.map(t=>t.graph_node_id);this._node_ids=A()(this._node_ids,e),this.send_update_event()}send_update_event(){this._node.emit(a.a.SELECTION_UPDATED)}to_json(){return this._json=this._json||[],this._json=this._node_ids.map(t=>t),this._json}}var C=n(11);class q{constructor(t,e){this.node=t,this._context=e,this._children={},this._children_by_type={},this._children_and_grandchildren_by_context={},this._is_dependent_on_children=!1}get selection(){return this._selection=this._selection||new R(this.node)}get context(){return this._context}init(t=!1){this._children={},t&&(this._is_dependent_on_children=t,this._is_dependent_on_children&&(this._children_node=new i.a(this.node.scene,"children"),this.node.add_graph_input(this._children_node)))}set_child_name(t,e){let n;if(e=(e=e.replace(/[^A-Za-z0-9]/g,"_")).replace(/^[0-9]/,"_"),null!=(n=this._children[e])){if(t.name===e&&n.graph_node_id===t.graph_node_id)return;return e=g.a.increment(e),this.set_child_name(t,e)}{const n=t.name;this._children[n]&&delete this._children[n],this._children[e]=t,t.name_controller.update_name_from_parent(e),this._add_to_nodes_by_type(t),this.node.scene.nodes_controller.add_to_instanciated_node(t)}}node_context_signature(){return`${this.node.node_context()}/${this.node.type}`}available_children_classes(){return C.a.instance().registered_nodes(this._context,this.node.type)}is_valid_child_type(t){return null!=this.available_children_classes()[t]}create_node(t){const e=this.available_children_classes()[t];if(null==e){const e=`child node type '${t}' not found for node '${this.node.full_path()}'. Available types are: ${Object.keys(this.available_children_classes()).join(", ")}, ${this._context}, ${this.node.type}`;throw console.error(e),e}{const n=new e(this.node.scene,`child_node_${t}`);return n.initialize_base_and_node(),this.add_node(n),n.lifecycle.set_creation_completed(),n}}add_node(t){if(t.set_parent(this.node),t.params.init(),t.parent_controller.on_set_parent(),t.name_controller.post_set_full_path(),t.children_allowed()&&t.children_controller)for(let e of t.children_controller.children())e.name_controller.post_set_full_path();return this.node.emit(a.a.CREATED,{child_node_json:t.to_json()}),this.node.scene.lifecycle_controller.on_create_hook_allowed()&&t.lifecycle.run_on_create_hooks(),t.lifecycle.run_on_add_hooks(),this.set_child_name(t,f.base_name(t)),this.node.lifecycle.run_on_child_add_hooks(t),this._is_dependent_on_children&&this._children_node&&this._children_node.add_graph_input(t),t.require_webgl2()&&this.node.scene.webgl_controller.set_require_webgl2(),this.node.scene.missing_expression_references_controller.check_for_missing_references(t),t}remove_node(t){var e,n;if(t.parent!=this.node)return console.warn(`node ${t.name} not under parent ${this.node.full_path()}`);{t.set_successors_dirty(this.node),this._is_dependent_on_children&&this._children_node&&this._children_node.remove_graph_input(t),this.selection.contains(t)&&this.selection.remove([t]);const r=t.io.connections.first_input_connection();null===(e=t.io.connections.input_connections())||void 0===e||e.forEach(t=>{t&&t.disconnect({set_input:!0})}),null===(n=t.io.connections.output_connections())||void 0===n||n.forEach(t=>{if(t&&(t.disconnect({set_input:!0}),r)){const e=r.node_src,n=t.output_index,i=t.node_dest,s=t.input_index;i.io.inputs.set_input(s,e,n)}}),t.graph_disconnect_successors(),t.set_parent(null),delete this._children[t.name],this._remove_from_nodes_by_type(t),this.node.scene.nodes_controller.remove_from_instanciated_node(t),this.node.lifecycle.run_on_child_remove_hooks(t),t.lifecycle.run_on_delete_hooks(),t.emit(a.a.DELETED,{parent_id:this.node.graph_node_id})}}_add_to_nodes_by_type(t){const e=t.graph_node_id,n=t.type;this._children_by_type[n]=this._children_by_type[n]||[],x()(this._children_by_type[n],e)||this._children_by_type[n].push(e),this.add_to_children_and_grandchildren_by_context(t)}_remove_from_nodes_by_type(t){const e=t.graph_node_id,n=t.type;if(this._children_by_type[n]){const t=this._children_by_type[n].indexOf(e);t>=0&&(this._children_by_type[n].splice(t,1),0==this._children_by_type[n].length&&delete this._children_by_type[n])}this.remove_from_children_and_grandchildren_by_context(t)}add_to_children_and_grandchildren_by_context(t){var e;const n=t.graph_node_id,r=t.node_context();this._children_and_grandchildren_by_context[r]=this._children_and_grandchildren_by_context[r]||[],x()(this._children_and_grandchildren_by_context[r],n)||this._children_and_grandchildren_by_context[r].push(n),this.node.parent&&this.node.parent.children_allowed()&&(null===(e=this.node.parent.children_controller)||void 0===e||e.add_to_children_and_grandchildren_by_context(t))}remove_from_children_and_grandchildren_by_context(t){var e;const n=t.graph_node_id,r=t.node_context();if(this._children_and_grandchildren_by_context[r]){const t=this._children_and_grandchildren_by_context[r].indexOf(n);t>=0&&(this._children_and_grandchildren_by_context[r].splice(t,1),0==this._children_and_grandchildren_by_context[r].length&&delete this._children_and_grandchildren_by_context[r])}this.node.parent&&this.node.parent.children_allowed()&&(null===(e=this.node.parent.children_controller)||void 0===e||e.remove_from_children_and_grandchildren_by_context(t))}nodes_by_type(t){const e=this._children_by_type[t]||[],n=this.node.scene.graph,r=[];return e.forEach(t=>{const e=n.node_from_id(t);e&&r.push(e)}),r}child_by_name(t){return this._children[t]}has_children_and_grandchildren_with_context(t){return null!=this._children_and_grandchildren_by_context[t]}children(){return O()(this._children)}children_names(){return E()(w()(this._children))}traverse_children(t){var e;for(let n of this.children())t(n),null===(e=n.children_controller)||void 0===e||e.traverse_children(t)}}class D{constructor(t){this.node=t,this._creation_completed=!1}set_creation_completed(){this._creation_completed=!0}get creation_completed(){return this.node.scene.loading_controller.loaded&&this._creation_completed}add_on_child_add_hook(t){this._on_child_add_hooks=this._on_child_add_hooks||[],this._on_child_add_hooks.push(t)}run_on_child_add_hooks(t){this.execute_hooks_with_child_node(this._on_child_add_hooks,t)}add_on_child_remove_hook(t){this._on_child_remove_hooks=this._on_child_remove_hooks||[],this._on_child_remove_hooks.push(t)}run_on_child_remove_hooks(t){this.execute_hooks_with_child_node(this._on_child_remove_hooks,t)}add_on_create_hook(t){this._on_create_hooks=this._on_create_hooks||[],this._on_create_hooks.push(t)}run_on_create_hooks(){this.execute_hooks(this._on_create_hooks)}add_on_add_hook(t){this._on_add_hooks=this._on_add_hooks||[],this._on_add_hooks.push(t)}run_on_add_hooks(){this.execute_hooks(this._on_add_hooks)}add_delete_hook(t){this._on_delete_hooks=this._on_delete_hooks||[],this._on_delete_hooks.push(t)}run_on_delete_hooks(){this.execute_hooks(this._on_delete_hooks)}execute_hooks(t){if(t)for(let e of t)e()}execute_hooks_with_child_node(t,e){if(t)for(let n of t)n(e)}}var L=n(37);class N{constructor(t){this.node=t,this._cooking=!1,this._cooks_count=0,this._max_cook_time=-1,this._cook_time_with_inputs=0,this._cook_time=0,this._cook_time_params=0,this._inputs_evaluation_required=!0}disallow_inputs_evaluation(){this._inputs_evaluation_required=!1}get is_cooking(){return!0===this._cooking}get cooks_count(){return this._cooks_count}get cook_time(){return this._cook_time}_init_cooking_state(){this._cooking=!0,this._cooking_dirty_timestamp=this.node.dirty_controller.dirty_timestamp}_init_cooking_start_time(t){null==t&&(t=this.node.scene.performance.started),t&&(this._cook_time_start=performance.now())}_start_cook_if_no_errors(t){return Object(r.a)(this,void 0,void 0,(function*(){if(this.node.states.error.active)this.end_cook();else try{yield this.node.cook(t)}catch(t){this.node.states.error.set(`node internal error: '${t}'.`),console.error(this.node.full_path(),t),this.end_cook()}}))}cook_main(){return Object(r.a)(this,void 0,void 0,(function*(){if(this.is_cooking)return;this._init_cooking_state();const t=this.node.scene.performance.started;t&&(this._cook_time_with_inputs_start=performance.now()),this.node.states.error.clear();const e=yield this.evaluate_inputs_and_params();this._init_cooking_start_time(t);const n=[];if(e){let t;for(let r=0;r<e.length;r++)t=e[r],t&&(this.node.io.inputs.input_clonable_state_with_override(r)?n.push(t.core_content_cloned()):n.push(t.core_content()))}yield this._start_cook_if_no_errors(n)}))}cook_main_without_inputs(){return Object(r.a)(this,void 0,void 0,(function*(){this.node.scene.cook_controller.add_node(this.node),this.is_cooking?console.warn("cook_main_without_inputs already cooking",this.node.full_path()):(this._init_cooking_state(),this._init_cooking_start_time(),this.node.states.error.clear(),yield this.node.params.eval_all(),yield this._start_cook_if_no_errors([]))}))}end_cook(t){this._increment_cooks_count();const e=this.node.dirty_controller.dirty_timestamp;null==e||e===this._cooking_dirty_timestamp?(this.node.remove_dirty_state(),this._terminate_cook_process()):(C.a.instance().log("COOK AGAIN",e,this._cooking_dirty_timestamp,this.node.full_path()),this._cooking=!1,this.cook_main())}_terminate_cook_process(){this.is_cooking&&(this._cooking=!1,this._record_cook_time(),setTimeout(this.node.container_controller.notify_requesters.bind(this.node.container_controller),0))}_increment_cooks_count(){this.is_cooking&&null!=this._cook_time_start&&(this._cooks_count+=1)}_record_cook_time(){if(this.node.scene.performance.started){const t=performance.now();null!=this._cook_time_with_inputs_start&&(this._cook_time_with_inputs=t-this._cook_time_with_inputs_start,this._cook_time_with_inputs_start=void 0),null!=this._cook_time_params_start&&null!=this._cook_time_start&&(this._cook_time_params=this._cook_time_start-this._cook_time_params_start),null!=this._cook_time_start&&(this._cook_time=t-this._cook_time_start,this._cook_time_start=void 0),this._max_cook_time=Math.max(this._max_cook_time,this._cook_time)}this.node.scene.performance.started&&this.node.scene.performance.record_node_cook_data(this.node)}evaluate_inputs_and_params(){return Object(r.a)(this,void 0,void 0,(function*(){let t=[];return this._inputs_evaluation_required&&(t=yield this.node.io.inputs.eval_required_inputs_p()),this.node.scene.performance.started&&(this._cook_time_params_start=performance.now()),yield this.node.params.eval_all(),t}))}get cook_time_with_inputs(){return this._cook_time_with_inputs}get cook_time_params(){return this._cook_time_params}_time_with_precision(t){return Math.round(1e3*t)/1e3}}var U,$=n(183),I=n.n($),V=n(14);!function(t){t.SUCCESSORS="graph_successors",t.PREDECESSORS="graph_predecessors"}(U||(U={}));class F{constructor(t){this.node=t}scene_successors(){return this._find_scene_node_scene_nodes(U.SUCCESSORS)}scene_predecessors(){return this._find_scene_node_scene_nodes(U.PREDECESSORS)}_find_scene_node_scene_nodes(t){const e=this.node.params.all,n=[];for(let t of e)n.push(t);n.push(this.node);const r=n;let i=[];for(let e of r)this._find_base_nodes_from_node(e,t,i);if(t==U.SUCCESSORS)for(let t of this.param_nodes_referree())i.push(t);i=i.filter(t=>t.graph_node_id!=this.node.graph_node_id);const s=I()(i,t=>t.graph_node_id),o=[];return Object.keys(s).forEach(t=>{o.push(s[t][0])}),o}_find_base_nodes_from_node(t,e,n){const r=t[e]();for(let t of r)t instanceof V.a?n.push(t.node):(i=t,("string"==typeof(s=mt)?typeof i===s:i instanceof s)?n.push(t):this._find_base_nodes_from_node(t,e,n));var i,s;return n}add_param_referree(t){this._params_referrees_by_graph_node_id=this._params_referrees_by_graph_node_id||{},this._params_referrees_by_graph_node_id[t.graph_node_id]=t}remove_param_referree(t){this._params_referrees_by_graph_node_id&&delete this._params_referrees_by_graph_node_id[t.graph_node_id]}params_referree(){const t=[];if(this._params_referrees_by_graph_node_id)for(let e of Object.keys(this._params_referrees_by_graph_node_id))t.push(this._params_referrees_by_graph_node_id[e]);return t}param_nodes_referree(){const t={};let e;for(let n of this.params_referree())e=n.node,t[e.graph_node_id]=e;const n=[];for(let e of Object.keys(t))n.push(t[e]);return n}}var B=n(78),H=n(0),G=n(141);class W{constructor(t){this.node=t,this._param_create_mode=!1,this._params_by_name={},this._params_list=[],this._param_names=[],this._non_spare_params=[],this._spare_params=[],this._non_spare_param_names=[],this._spare_param_names=[],this._params_added_since_last_params_eval=!1}init_dependency_node(){this._params_node||(this._params_node=new i.a(this.node.scene,"params"),this.node.add_graph_input(this._params_node))}init(){this.init_dependency_node(),this._param_create_mode=!0,this.init_from_params_config(),this.node.create_params(),this._post_create_params()}_post_create_params(){this._update_caches(),this.init_param_accessors(),this._param_create_mode=!1,this.run_post_create_params_hook()}update_params(t){let e=!1,n=!1;if(t.names_to_delete)for(let e of t.names_to_delete)this.has(e)&&(this.delete_param(e),n=!0);if(t.to_add)for(let n of t.to_add){this.add_param(n.type,n.name,n.init_value,n.options)&&(e=!0)}(n||e)&&(this._update_caches(),this.init_param_accessors(),this.node.emit(a.a.PARAMS_UPDATED))}post_create_spare_params(){this._update_caches(),this.init_param_accessors()}init_from_params_config(){const t=this.node.params_config;if(t)for(let e of Object.keys(t)){const n=t[e];this.add_param(n.type,e,n.init_value,n.options)}}init_param_accessors(){let t=Object.getOwnPropertyNames(this.node.pv);this._remove_unneeded_accessors(t),t=Object.getOwnPropertyNames(this.node.pv);for(let e of this.all){const n=e.options.is_spare;(!t.includes(e.name)||n)&&(Object.defineProperty(this.node.pv,e.name,{get:()=>e.value,configurable:n}),Object.defineProperty(this.node.p,e.name,{get:()=>e,configurable:n}))}}_remove_unneeded_accessors(t){const e=this._param_names,n=[];for(let r of t)e.includes(r)||n.push(r);for(let t of n)Object.defineProperty(this.node.pv,t,{get:()=>{},configurable:!0}),Object.defineProperty(this.node.p,t,{get:()=>{},configurable:!0})}get params_node(){return this._params_node}get all(){return this._params_list}get non_spare(){return this._non_spare_params}get spare(){return this._spare_params}get names(){return this._param_names}get non_spare_names(){return this._non_spare_param_names}get spare_names(){return this._spare_param_names}set_with_type(t,e,n){const r=this.param_with_type(t,n);r?r.set(e):console.warn(`param ${t} not found with type ${n}`)}set_float(t,e){this.set_with_type(t,e,H.a.FLOAT)}set_vector3(t,e){this.set_with_type(t,e,H.a.VECTOR3)}has_param(t){return null!=this._params_by_name[t]}has(t){return this.has_param(t)}get(t){return this.param(t)}param_with_type(t,e){const n=this.param(t);if(n&&n.type==e)return n}get_float(t){return this.param_with_type(t,H.a.FLOAT)}get_operator_path(t){return this.param_with_type(t,H.a.OPERATOR_PATH)}value(t){var e;return null===(e=this.param(t))||void 0===e?void 0:e.value}value_with_type(t,e){var n;return null===(n=this.param_with_type(t,e))||void 0===n?void 0:n.value}boolean(t){return this.value_with_type(t,H.a.BOOLEAN)}float(t){return this.value_with_type(t,H.a.FLOAT)}integer(t){return this.value_with_type(t,H.a.INTEGER)}string(t){return this.value_with_type(t,H.a.STRING)}vector2(t){return this.value_with_type(t,H.a.VECTOR2)}vector3(t){return this.value_with_type(t,H.a.VECTOR3)}color(t){return this.value_with_type(t,H.a.COLOR)}param(t){const e=this._params_by_name[t];return null!=e?e:(console.warn(`tried to access param '${t}' in node ${this.node.full_path()}, but existing params are: ${this.names} on node ${this.node.full_path()}`),null)}delete_param(t){const e=this._params_by_name[t];if(!e)throw new Error(`param '${t}' does not exist on node ${this.node.full_path()}`);if(this._params_node&&this._params_node.remove_graph_input(this._params_by_name[t]),e.set_node(null),delete this._params_by_name[t],e.is_multiple&&e.components)for(let t of e.components){const e=t.name;delete this._params_by_name[e]}}add_param(t,e,n,r={}){const i=r.spare||!1;!1!==this._param_create_mode||i||console.warn(`node ${this.node.full_path()} (${this.node.type}) param '${e}' cannot be created outside of create_params`),null==this.node.scene&&console.warn(`node ${this.node.full_path()} (${this.node.type}) has no scene assigned`);const s=G.a[t];if(null!=s){const o=this._params_by_name[e];o&&(i?o.type!=t&&this.delete_param(o.name):console.warn(`a param named ${e} already exists`,this.node));const a=new s(this.node.scene);if(a.options.set(r),a.set_name(e),a.set_init_value(n),a.init_components(),a.set(n),a.set_node(this.node),this._params_by_name[a.name]=a,a.is_multiple&&a.components)for(let t of a.components)this._params_by_name[t.name]=t;return this._params_added_since_last_params_eval=!0,a}}_update_caches(){this._params_list=Object.values(this._params_by_name),this._param_names=Object.keys(this._params_by_name),this._non_spare_params=Object.values(this._params_by_name).filter(t=>!t.options.is_spare),this._spare_params=Object.values(this._params_by_name).filter(t=>t.options.is_spare),this._non_spare_param_names=Object.values(this._params_by_name).filter(t=>!t.options.is_spare).map(t=>t.name),this._spare_param_names=Object.values(this._params_by_name).filter(t=>t.options.is_spare).map(t=>t.name)}_eval_param(t){return Object(r.a)(this,void 0,void 0,(function*(){t.is_dirty&&(yield t.compute(),t.states.error.active&&this.node.states.error.set(`param '${t.name}' error: ${t.states.error.message}`))}))}eval_params(t){return Object(r.a)(this,void 0,void 0,(function*(){const e=[];for(let n=0;n<t.length;n++)t[n].is_dirty&&e.push(this._eval_param(t[n]));yield Promise.all(e),this.node.states.error.active&&this.node.set_container(null)}))}eval_all(){return Object(r.a)(this,void 0,void 0,(function*(){this._params_node&&(this._params_node.is_dirty||this._params_added_since_last_params_eval)&&(yield this.eval_params(this._params_list),this._params_node.remove_dirty_state(),this._params_added_since_last_params_eval=!1)}))}set_post_create_params_hook(t){this._post_create_params_hook=t}add_on_scene_load_hook(t,e){this._on_scene_load_hook_names=this._on_scene_load_hook_names||[],this._on_scene_load_hooks=this._on_scene_load_hooks||[],this._on_scene_load_hook_names.includes(t)?console.warn(`hook with name ${t} already exists`,this.node):(this._on_scene_load_hook_names.push(t),this._on_scene_load_hooks.push(e))}run_post_create_params_hook(){this._post_create_params_hook&&this._post_create_params_hook()}run_on_scene_load_hooks(){if(this._on_scene_load_hooks)for(let t of this._on_scene_load_hooks)t()}}class Y{constructor(){}}class Z{constructor(t){this._frame=0}copy(t){this._frame=t.frame}get frame(){return this._frame}}var X=n(27),J=n.n(X);class Q{constructor(t){this._node=t,this._output_connections=new Map}init_inputs(){const t=this._node.io.inputs.max_inputs_count;this._input_connections=new Array(t)}add_input_connection(t){this._input_connections?this._input_connections[t.input_index]=t:console.warn("input connections array not initialized")}remove_input_connection(t){if(this._input_connections)if(t.input_index<this._input_connections.length){this._input_connections[t.input_index]=void 0;let e=!0;for(let n=t.input_index;n<this._input_connections.length;n++)this._input_connections[n]&&(e=!1);e&&(this._input_connections=this._input_connections.slice(0,t.input_index))}else console.warn(`attempt to remove an input connection at index ${t.input_index}`);else console.warn("input connections array not initialized")}input_connection(t){if(this._input_connections)return this._input_connections[t]}first_input_connection(){return J()(this._input_connections)[0]}input_connections(){return this._input_connections}add_output_connection(t){const e=t.output_index,n=t.id;let r=this._output_connections.get(e);r||(r=new Map,this._output_connections.set(e,r)),r.set(n,t)}remove_output_connection(t){const e=t.output_index,n=t.id;let r=this._output_connections.get(e);r&&r.delete(n)}output_connections(){let t=[];return this._output_connections.forEach((e,n)=>{e.forEach((e,n)=>{e&&t.push(e)})}),t}}var K=n(91),tt=n.n(K),et=n(5),nt=n.n(et);class rt{constructor(t,e,n=0,r=0){this._node_src=t,this._node_dest=e,this._output_index=n,this._input_index=r,this._id=rt._next_id++,this._node_src.io.connections&&this._node_dest.io.connections&&(this._node_src.io.connections.add_output_connection(this),this._node_dest.io.connections.add_input_connection(this))}get id(){return this._id}get node_src(){return this._node_src}get node_dest(){return this._node_dest}get output_index(){return this._output_index}get input_index(){return this._input_index}disconnect(t={}){this._node_src.io.connections&&this._node_dest.io.connections&&(this._node_src.io.connections.remove_output_connection(this),this._node_dest.io.connections.remove_input_connection(this)),!0===t.set_input&&this._node_dest.io.inputs.set_input(this._input_index,null)}}rt._next_id=0;var it=n(34),st=n(130);class ot{constructor(t){this.node=t,this._graph_node_inputs=[],this._inputs=[],this._has_named_inputs=!1,this._min_inputs_count=0,this._max_inputs_count=0,this._depends_on_inputs=!0,this._override_clonable_state=!1}set_depends_on_inputs(t){this._depends_on_inputs=t}set_min_inputs_count(t){this._min_inputs_count=t}set_max_inputs_count(t){this._max_inputs_count=t,this.init_graph_node_inputs()}named_input_connection_points_by_name(t){if(this._named_input_connection_points)for(let e of this._named_input_connection_points)if(e.name==t)return e}set_named_input_connection_points(t){this._has_named_inputs=!0,this._named_input_connection_points=t,this.set_min_inputs_count(0),this.set_max_inputs_count(t.length),this.init_graph_node_inputs(),this.node.emit(a.a.NAMED_INPUTS_UPDATED)}get has_named_inputs(){return this._has_named_inputs}get named_input_connection_points(){return this._named_input_connection_points||[]}init_graph_node_inputs(){for(let t=0;t<this._max_inputs_count;t++)this._graph_node_inputs[t]=this._graph_node_inputs[t]||this._create_graph_node_input(t)}_create_graph_node_input(t){const e=new i.a(this.node.scene,`input_${t}`);return this.node.add_graph_input(e),e}get max_inputs_count(){return this._max_inputs_count||0}input_graph_node(t){return this._graph_node_inputs[t]}set_count(t,e){null==e&&(e=t),this.set_min_inputs_count(t),this.set_max_inputs_count(e),this.init_inputs_clonable_state(),this.init_connections_controller_inputs()}init_connections_controller_inputs(){this.node.io.connections.init_inputs()}eval_required_inputs_p(){return Object(r.a)(this,void 0,void 0,(function*(){let t=[];if(this._max_inputs_count>0){const e=[];if(this.inputs().forEach((t,n)=>{t&&e.push(n)}),e.length<this._min_inputs_count)this.node.states.error.set("inputs are missing");else if(e.length>0){const n=e.map(t=>this.node.io.inputs.eval_required_input(t));t=yield Promise.all(n)}}return t}))}eval_required_input(t){return Object(r.a)(this,void 0,void 0,(function*(){const e=yield this.node.container_controller.request_input_container(t);if(e&&e.core_content());else{const e=this.input(t);if(e){const n=e.states.error.message;n&&this.node.states.error.set(`input ${t} is invalid (error: ${n})`)}}return e}))}get_named_input_index(t){if(this._named_input_connection_points)for(let e=0;e<this._named_input_connection_points.length;e++)if(this._named_input_connection_points[e].name==t)return e;return-1}get_input_index(t){if(nt()(t)){if(this.has_named_inputs)return this.get_named_input_index(t);throw new Error(`node ${this.node.full_path()} has no named inputs`)}return t}set_input(t,e,n=0){const r=this.get_input_index(t)||0;if(r<0){const e=`invalid input (${t}) for node ${this.node.full_path()}`;throw console.warn(e),new Error(e)}let i=0;if(e&&e.io.outputs.has_named_outputs&&(i=e.io.outputs.get_output_index(n),null==i||i<0))return void console.warn(`node ${e.full_path()} does not have an output named ${n}`);const s=this._graph_node_inputs[r];if(null==s){const t=`graph_input_node not found at index ${r}`;throw console.warn(t),new Error(t)}if(e&&this.node.parent!=e.parent)return;const o=this._inputs[r];let _=null,u=void 0;this.node.io.connections&&(u=this.node.io.connections.input_connection(r)),u&&(_=u.output_index),e===o&&i==_||(null!=o&&this._depends_on_inputs&&s.remove_graph_input(o),null!=e?s.add_graph_input(e)?(this._depends_on_inputs||s.remove_graph_input(e),u&&u.disconnect({set_input:!1}),this._inputs[r]=e,new rt(e,this.node,i,r)):console.warn(`cannot connect ${e.full_path()} to ${this.node.full_path()}`):(this._inputs[r]=null,u&&u.disconnect({set_input:!1})),this._run_on_set_input_hooks(),s.set_successors_dirty(),this.node.emit(a.a.INPUTS_UPDATED))}remove_input(t){tt()(this.inputs(),(e,n)=>{null!=e&&null!=t&&e.graph_node_id===t.graph_node_id&&this.set_input(n,null)})}input(t){return this._inputs[t]}named_input(t){if(this.has_named_inputs){const e=this.get_input_index(t);return this._inputs[e]}return null}named_input_connection_point(t){if(this.has_named_inputs&&this._named_input_connection_points){const e=this.get_input_index(t);return this._named_input_connection_points[e]}}has_named_input(t){return this.get_named_input_index(t)>=0}has_input(t){return null!=this._inputs[t]}inputs(){return this._inputs}override_clonable_state_allowed(){let t=!1;for(let e of this.inputs_clonable_state())e==it.a.FROM_NODE&&(t=!0);return t}inputs_clonable_state(){return this._inputs_clonable_states=this._inputs_clonable_states||this.init_inputs_clonable_state()}input_cloned(t){return this.input_clonable_state_with_override(t)}inputs_clonable_state_with_override(){const t=[],e=this.inputs_clonable_state();for(let n=0;n<e.length;n++)t.push(this.input_clonable_state_with_override(n));return t}input_clonable_state_with_override(t){const e=this.inputs_clonable_state()[t];switch(e){case it.a.ALWAYS:return!0;case it.a.NEVER:return!1;case it.a.FROM_NODE:return!this._override_clonable_state}return st.a.unreachable(e)}init_inputs_clonable_state(t=null){return t&&(this._user_inputs_clonable_states=t),this._inputs_clonable_states=this._user_inputs_clonable_states||this._default_inputs_clonale_state_values(),this._inputs_clonable_states}_default_inputs_clonale_state_values(){const t=[];for(let e=0;e<this._max_inputs_count;e++)t.push(it.a.ALWAYS);return t}set_override_clonable_state(t){this._override_clonable_state=t,this.node.emit(a.a.OVERRIDE_CLONABLE_STATE_UPDATE)}override_clonable_state(){return this._override_clonable_state}add_on_set_input_hook(t,e){this._on_update_hooks=this._on_update_hooks||[],this._on_update_hook_names=this._on_update_hook_names||[],this._on_update_hook_names.includes(t)?console.warn(`hook with name ${t} already exists`,this.node):(this._on_update_hooks.push(e),this._on_update_hook_names.push(t))}_run_on_set_input_hooks(){if(this._on_update_hooks)for(let t of this._on_update_hooks)t()}}var at=n(9),_t=n.n(at),ut=n(30),ct=n.n(ut);class ht{constructor(t){this.node=t,this._has_outputs=!1,this._has_named_outputs=!1}set_has_one_output(){this._has_outputs=!0}set_has_no_output(){this._has_outputs=!1}get has_outputs(){return this._has_outputs}get has_named_outputs(){return this._has_named_outputs}has_named_output(t){return this.get_named_output_index(t)>=0}get named_output_connection_points(){return this._named_output_connection_points||[]}named_output_connection(t){if(this._named_output_connection_points)return this._named_output_connection_points[t]}get_named_output_index(t){if(this._named_output_connection_points)for(let e=0;e<this._named_output_connection_points.length;e++)if(this._named_output_connection_points[e].name==t)return e;return-1}get_output_index(t){return null!=t?nt()(t)?this.has_named_outputs?this.get_named_output_index(t):(console.warn(`node ${this.node.full_path()} has no named outputs`),-1):t:-1}named_output_connection_points_by_name(t){if(this._named_output_connection_points)for(let e of this._named_output_connection_points)if(e.name==t)return e}set_named_output_connection_points(t,e=!0){this._has_named_outputs=!0,this._named_output_connection_points=t,e&&this.node.scene&&this.node.set_dirty(this.node),this.node.emit(a.a.NAMED_OUTPUTS_UPDATED)}used_output_names(){if(this.node.io.connections){const t=ct()(this.node.io.connections.output_connections().map(t=>t?t.output_index:null)),e=[];return t.forEach(t=>{_t()(t)&&e.push(t)}),e.map(t=>this.named_output_connection_points[t].name)}return[]}}class lt{constructor(t){this.node=t,this._connections=new Q(this.node)}get connections(){return this._connections}get inputs(){return this._inputs=this._inputs||new ot(this.node)}has_inputs(){return null!=this._inputs}get outputs(){return this._outputs=this._outputs||new ht(this.node)}has_outputs(){return null!=this._outputs}}class dt{constructor(){}}var pt=n(39);class ft extends i.a{constructor(t,e="BaseNode"){super(t,e),this.container_controller=new L.a(this,pt.a),this.pv=new Y,this.p=new dt,this._initialized=!1}get display_node_controller(){return this._display_node_controller}get parent_controller(){return this._parent_controller=this._parent_controller||new v(this)}static displayed_input_names(){return[]}get children_controller_context(){return this._children_controller_context}_create_children_controller(){if(this._children_controller_context)return new q(this,this._children_controller_context)}get children_controller(){return this._children_controller=this._children_controller||this._create_children_controller()}children_allowed(){return null!=this._children_controller_context}get ui_data(){return this._ui_data=this._ui_data||new _(this)}get dependencies_controller(){return this._dependencies_controller=this._dependencies_controller||new F(this)}get states(){return this._states=this._states||new l(this)}get lifecycle(){return this._lifecycle=this._lifecycle||new D(this)}get serializer(){return this._serializer=this._serializer||new B.a(this)}get cook_controller(){return this._cook_controller=this._cook_controller||new N(this)}get io(){return this._io=this._io||new lt(this)}get name_controller(){return this._name_controller=this._name_controller||new f(this)}set_name(t){this.name_controller.set_name(t)}_set_core_name(t){this._name=t}get params(){return this._params_controller=this._params_controller||new W(this)}get processing_context(){return this._processing_context=this._processing_context||new Z(this)}initialize_base_and_node(){this._initialized?console.warn("node already initialized"):(this.initialize_base_node(),this.initialize_node(),this._initialized=!0)}initialize_base_node(){}initialize_node(){}static type(){throw"type to be overriden"}get type(){return this.constructor.type()}static node_context(){throw"requires override"}node_context(){return this.constructor.node_context()}static required_three_imports(){return[]}static required_imports(){let t=this.required_three_imports();return t?t.map(t=>`three/examples/jsm/${t}`):[]}required_imports(){return this.constructor.required_imports()}static require_webgl2(){return!1}require_webgl2(){return this.constructor.require_webgl2()}set_parent(t){this.parent_controller.set_parent(t)}get parent(){return this.parent_controller.parent}get root(){return this._scene.root}full_path(){return this.parent_controller.full_path()}create_params(){}add_param(t,e,n,r){var i;return null===(i=this._params_controller)||void 0===i?void 0:i.add_param(t,e,n,r)}cook(t){return null}request_container(){return Object(r.a)(this,void 0,void 0,(function*(){return yield this.container_controller.request_container()}))}set_container(t,e=null){this.container_controller.container.set_content(t),null!=t&&(t.name||(t.name=this.full_path()),t.node||(t.node=this)),this.cook_controller.end_cook(e)}create_node(t){var e;return null===(e=this.children_controller)||void 0===e?void 0:e.create_node(t)}remove_node(t){var e;null===(e=this.children_controller)||void 0===e||e.remove_node(t)}children(){var t;return(null===(t=this.children_controller)||void 0===t?void 0:t.children())||[]}node(t){var e;return(null===(e=this.parent_controller)||void 0===e?void 0:e.find_node(t))||null}node_sibbling(t){var e;if(this.parent){const n=null===(e=this.parent.children_controller)||void 0===e?void 0:e.child_by_name(t);if(n)return n}return null}nodes_by_type(t){var e;return(null===(e=this.children_controller)||void 0===e?void 0:e.nodes_by_type(t))||[]}set_input(t,e,n=0){this.io.inputs.set_input(t,e,n)}emit(t,e=null){this.scene.dispatch_controller.dispatch(this,t,e)}to_json(t=!1){return this.serializer.to_json(t)}}class mt extends ft{}},function(t,e,n){"use strict";function r(){}n.d(e,"a",(function(){return r})),Object.assign(r.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}}}})},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){var r=n(26),i=n(17);t.exports=function(t){if(!i(t))return!1;var e=r(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(t,e,n){var r=n(148),i=n(86);t.exports=function(t,e,n,s){var o=!n;n||(n={});for(var a=-1,_=e.length;++a<_;){var u=e[a],c=s?s(n[u],t[u],u,n,t):void 0;void 0===c&&(c=t[u]),o?i(n,u,c):r(n,u,c)}return n}},function(t,e,n){var r=n(223),i=n(18),s=Object.prototype,o=s.hasOwnProperty,a=s.propertyIsEnumerable,_=r(function(){return arguments}())?r:function(t){return i(t)&&o.call(t,"callee")&&!a.call(t,"callee")};t.exports=_},function(t,e,n){var r=n(225),i=n(49),s=n(99),o=s&&s.isTypedArray,a=o?i(o):r;t.exports=a},function(t,e,n){var r=n(145);t.exports=function(t){return r(t,4)}},function(t,e,n){var r=n(26),i=n(18);t.exports=function(t){return!0===t||!1===t||i(t)&&"[object Boolean]"==r(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(1),i=n(5),s=n.n(i),o=n(14),a=n(56),_=n(0),u=n(81),c=n(8);class h extends o.b{static type(){return _.a.STRING}get default_value_serialized(){return this.default_value}_clone_raw_input(t){return`${t}`}get raw_input_serialized(){return`${this._raw_input}`}get value_serialized(){return`${this.value}`}static are_raw_input_equal(t,e){return t==e}static are_values_equal(t,e){return t==e}get is_default(){return this._raw_input==this.default_value}convert(t){return s()(t)?t:`${t}`}get raw_input(){return this._raw_input}process_raw_input(){this.states.error.clear(),this._value_elements(this._raw_input).length>=3?(this._expression_controller=this._expression_controller||new u.a(this),this._raw_input!=this._expression_controller.expression&&(this._expression_controller.set_expression(this._raw_input),this.set_dirty(),this.emit_controller.emit(c.a.EXPRESSION_UPDATED))):this._raw_input!=this._value&&(this._value=this._raw_input,this.remove_dirty_state(),this.set_successors_dirty(this),this.emit_controller.emit(c.a.VALUE_UPDATED),this._expression_controller&&(this._expression_controller.set_expression(void 0,!1),this.emit_controller.emit(c.a.EXPRESSION_UPDATED)))}process_computation(){var t;return Object(r.a)(this,void 0,void 0,(function*(){if((null===(t=this.expression_controller)||void 0===t?void 0:t.active)&&!this.expression_controller.requires_entities){const t=yield this.expression_controller.compute_expression();if(this.expression_controller.is_errored)this.states.error.set(`expression error: ${this.expression_controller.error_message}`);else{const e=this.convert(t);null!=e?(this._value=e,this.emit_controller.emit(c.a.VALUE_UPDATED)):this.states.error.set(`expression returns an invalid type (${t})`),this.remove_dirty_state()}}}))}_value_elements(t){return a.a.string_value_elements(t)}}},function(t,e,n){var r=n(194),i=n(195),s=n(196),o=n(197),a=n(198);function _(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}_.prototype.clear=r,_.prototype.delete=i,_.prototype.get=s,_.prototype.has=o,_.prototype.set=a,t.exports=_},function(t,e,n){var r=n(60);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},function(t,e,n){var r=n(32)(Object,"create");t.exports=r},function(t,e,n){var r=n(218);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},function(t,e){t.exports=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}},function(t,e,n){var r=n(51);t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},function(t,e){var n=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");t.exports=function(t){return n.test(t)}},function(t,e,n){var r=n(285),i=n(286),s=n(287);t.exports=function(t,e,n){return e==e?s(t,e,n):r(t,i,n)}},function(t,e,n){var r=n(290),i=n(23);t.exports=function(t){return null==t?[]:r(t,i(t))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));class r{constructor(t){this.node=t}to_json(t=!1){var e,n,r,i;const s={name:this.node.name,type:this.node.type,graph_node_id:this.node.graph_node_id,is_dirty:this.node.is_dirty,ui_data_json:this.node.ui_data.to_json(),error_message:this.node.states.error.message,children:this.children_ids(),inputs:this.input_ids(),input_connection_output_indices:this.connection_input_indices(),named_input_connections:this.named_input_connections(),named_output_connections:this.named_output_connections(),param_ids:this.to_json_params(t),override_clonable_state:this.node.io.inputs.override_clonable_state(),inputs_clonable_state_with_override:this.node.io.inputs.inputs_clonable_state_with_override(),flags:{display:null===(n=null===(e=this.node.flags)||void 0===e?void 0:e.display)||void 0===n?void 0:n.active,bypass:null===(i=null===(r=this.node.flags)||void 0===r?void 0:r.bypass)||void 0===i?void 0:i.active},selection:void 0};return this.node.children_allowed()&&this.node.children_controller&&(s.selection=this.node.children_controller.selection.to_json()),s}children_ids(){return this.node.children().map(t=>t.graph_node_id)}input_ids(){return this.node.io.inputs.inputs().map(t=>null!=t?t.graph_node_id:void 0)}connection_input_indices(){var t;return null===(t=this.node.io.connections.input_connections())||void 0===t?void 0:t.map(t=>null!=t?t.output_index:void 0)}named_input_connections(){return this.node.io.inputs.named_input_connection_points.map(t=>t.to_json())}named_output_connections(){return this.node.io.outputs.named_output_connection_points.map(t=>t.to_json())}to_json_params_from_names(t,e=!1){return t.map(t=>this.node.params.get(t).graph_node_id)}to_json_params(t=!1){return this.to_json_params_from_names(this.node.params.names,t)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));const r=function(t){return function(e){return Math.pow(e,t)}},i=function(t){return function(e){return 1-Math.abs(Math.pow(e-1,t))}},s=function(t){return function(e){return e<.5?r(t)(2*e)/2:i(t)(2*e-1)/2+.5}},o={linear:s(1),ease_i:function(t,e){return r(e)(t)},ease_o:function(t,e){return i(e)(t)},ease_io:function(t,e){return s(e)(t)},ease_i2:r(2),ease_o2:i(2),ease_io2:s(2),ease_i3:s(3),ease_o3:s(3),ease_io3:s(3),ease_i4:s(4),ease_o4:s(4),ease_io4:s(4),ease_i_sin:function(t){return 1+Math.sin(Math.PI/2*t-Math.PI/2)},ease_o_sin:function(t){return Math.sin(Math.PI/2*t)},ease_io_sin:function(t){return(1+Math.sin(Math.PI*t-Math.PI/2))/2},ease_i_elastic:function(t){return(.04-.04/t)*Math.sin(25*t)+1},ease_o_elastic:function(t){return.04*t/--t*Math.sin(25*t)},ease_io_elastic:function(t){return(t-=.5)<0?(.02+.01/t)*Math.sin(50*t):(.02-.01/t)*Math.sin(50*t)+1}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));var r=n(9),i=n.n(r),s=n(43),o=n(0),a=n(15);class _ extends s.a{static type(){return o.a.FLOAT}get default_value_serialized(){return this.default_value}get raw_input_serialized(){return this._raw_input}get value_serialized(){return this.value}static are_raw_input_equal(t,e){return t==e}static are_values_equal(t,e){return t==e}static convert(t){if(i()(t))return t;if(a.a.is_number(t)){const e=parseFloat(t);if(i()(e))return e}return null}convert(t){const e=_.convert(t);return e?this.options.ensure_in_range(e):e}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return N}));var r=n(1),i=n(56);var s=n(6);class o{constructor(){this.index=-1,this.path_elements=[],this._named_nodes=[],this.graph_node_ids=[],this.node_element_by_graph_node_id={}}add_node(t,e){this.index+=1,t==e.name&&(this.named_nodes[this.index]=e),this.graph_node_ids[this.index]=e.graph_node_id,this.node_element_by_graph_node_id[e.graph_node_id]=t}add_path_element(t){this.index+=1,this.path_elements[this.index]=t}get named_nodes(){return this._named_nodes}update_from_name_change(t){this.named_nodes.map(t=>null==t?void 0:t.graph_node_id).includes(t.graph_node_id)&&(this.node_element_by_graph_node_id[t.graph_node_id]=t.name)}to_path(){const t=new Array(this.index);for(let e=0;e<=this.index;e++){const n=this.named_nodes[e];if(n)t[e]=this.node_element_by_graph_node_id[n.graph_node_id];else{const n=this.path_elements[e];n&&(t[e]=n)}}let e=t.join(s.a.SEPARATOR);const n=e[0];return n&&(s.a.NON_LETTER_PREFIXES.includes(n)||(e=`${s.a.SEPARATOR}${e}`)),e}}var a=n(9),_=n.n(a),u=n(13);class c extends u.a{constructor(t,e,n){super(t.scene,"MethodDependency"),this.param=t,this.path_argument=e,this.decomposed_path=n,this._update_from_name_change_bound=this._update_from_name_change.bind(this),this.add_post_dirty_hook("_update_from_name_change",this._update_from_name_change_bound)}_update_from_name_change(t){if(t&&this.decomposed_path){const e=t;this.decomposed_path.update_from_name_change(e);const n=this.decomposed_path.to_path(),r=this.jsep_node;r&&(r.value=`${r.value}`.replace(`${this.path_argument}`,n),r.raw=r.raw.replace(`${this.path_argument}`,n)),this.param.expression_controller&&this.param.expression_controller.update_from_method_dependency_name_change()}}reset(){this.graph_disconnect_predecessors()}listen_for_name_changes(){this.jsep_node&&this.decomposed_path&&this.decomposed_path.named_nodes.forEach(t=>{if(t){const e=t;e.name_controller&&this.add_graph_input(e.name_controller.graph_node)}})}set_jsep_node(t){this.jsep_node=t}set_resolved_graph_node(t){this.resolved_graph_node=t}set_unresolved_path(t){this.unresolved_path=t}static create(t,e,n,r){const i=_()(e),s=new c(t,e,r);if(n)s.set_resolved_graph_node(n);else if(!i){const t=e;s.set_unresolved_path(t)}return s}}var h=n(5),l=n.n(h);class d{constructor(t){this.param=t,this.node=this.param.node}static required_arguments(){return console.warn("Expression.Method._Base.required_arguments virtual method call. Please override"),[]}static optional_arguments(){return[]}static min_allowed_arguments_count(){return this.required_arguments().length}static max_allowed_arguments_count(){return this.min_allowed_arguments_count()+this.optional_arguments().length}static allowed_arguments_count(t){return t>=this.min_allowed_arguments_count()&&t<=this.max_allowed_arguments_count()}process_arguments(t){throw"Expression.Method._Base.process_arguments virtual method call. Please override"}get_referenced_node_container(t){return Object(r.a)(this,void 0,void 0,(function*(){const e=this.get_referenced_node(t);if(e){const t=yield e.request_container();if(t){if(t.core_content())return t}throw`referenced node invalid: ${e.full_path()}`}throw`invalid input (${t})`}))}get_referenced_param(t,e){return s.a.find_param(this.node,t,e)||null}find_referenced_graph_node(t,e){if(_()(t)){const e=t;return this.node.io.inputs.input_graph_node(e)}{const n=t;return this.get_referenced_node(n,e)}}get_referenced_node(t,e){if(l()(t)){const n=t;return s.a.find_node(this.node,n,e)}{const e=t;return this.node.io.inputs.input(e),this.node.io.inputs.input(e)}}find_dependency(t){return null}create_dependency_from_index_or_path(t){const e=new o,n=this.find_referenced_graph_node(t,e);return n?this.create_dependency(n,t,e):(console.warn("node not found for path",t),null)}create_dependency(t,e,n){return c.create(this.param,e,t,n)}}var p=n(2);const f=["min","max","size","center"],m=["x","y","z"];var v=n(11);var g=n(15);const y={bbox:class extends d{static required_arguments(){return[["string","path to node"],["string","vector name, min, max, size or center"],["string","component_name, x,y or z"]]}find_dependency(t){return this.create_dependency_from_index_or_path(t)}process_arguments(t){let e=0;return new Promise((n,i)=>Object(r.a)(this,void 0,void 0,(function*(){if(3==t.length){const r=t[0],s=t[1],o=t[2];let a=null;try{a=yield this.get_referenced_node_container(r)}catch(t){i(t)}a&&(e=this._get_value_from_container(a,s,o),n(e))}else n(0)})))}_get_value_from_container(t,e,n){if(f.indexOf(e)>=0){const r=t.bounding_box();let i=new p.a;switch(e){case"size":r.getSize(i);break;case"center":r.getCenter(i);break;default:i=r[e]}return m.indexOf(n)>=0?i[n]:-1}return-1}},ch:class extends d{static required_arguments(){return[["string","path to param"]]}find_dependency(t){const e=new o,n=this.get_referenced_param(t,e);return n?this.create_dependency(n,t,e):(console.warn("could not find param"),null)}process_arguments(t){return Object(r.a)(this,void 0,void 0,(function*(){let e=0;if(1==t.length){const n=t[0],r=this.get_referenced_param(n);if(r){yield r.compute();const t=r.value;null!=t&&(e=t)}}return e}))}},centroid:class extends d{static required_arguments(){return[["string","path to node"],["string","component_name, x,y or z"]]}find_dependency(t){return this.create_dependency_from_index_or_path(t)}process_arguments(t){return new Promise((e,n)=>Object(r.a)(this,void 0,void 0,(function*(){if(2==t.length){const r=t[0],i=t[1];let s=null;try{s=yield this.get_referenced_node_container(r)}catch(t){n(t)}if(s){const t=s.bounding_box(),n=t.min.clone().add(t.max).multiplyScalar(.5)[i];e(null!=n?n:0)}}else e(0)})))}},cop_res:class extends d{static required_arguments(){return[["string","path to node"],["string","component_name: x or y"]]}find_dependency(t){return this.create_dependency_from_index_or_path(t)}process_arguments(t){return Object(r.a)(this,void 0,void 0,(function*(){let e=0;if(2==t.length){const n=t[0],r=t[1],i=yield this.get_referenced_node_container(n);if(i){const t=i.resolution();[0,"0","x"].includes(r)?e=t[0]:[1,"1","y"].includes(r)&&(e=t[1])}}return e}))}},local:class extends d{static required_arguments(){return[["string","path"]]}process_arguments(t){return new Promise((e,n)=>{this.request_asset_url(t[0]).then(t=>{e(t)})})}request_asset_url(t){return new Promise((e,n)=>{let r;const i=v.a.instance().desktop_controller();if(!i.active())return e("");i.add_local_path(t,this.param),r=i.local_path_server_url(t),e(r)})}},opdigits:class extends d{static required_arguments(){return[["string","path to node"]]}find_dependency(t){const e=this.find_referenced_graph_node(t);if(e){const n=e;if(n.name_controller){const e=n.name_controller.graph_node;return this.create_dependency(e,t)}}return null}process_arguments(t){return new Promise((e,n)=>{if(1==t.length){const n=t[0],r=this.get_referenced_node(n);if(r){const t=r.name;e(g.a.tail_digits(t))}else e(0)}else e(0)})}},point:class extends d{static required_arguments(){return[["string","path to node"],["index","point index"],["string","attribute name"]]}find_dependency(t){return this.create_dependency_from_index_or_path(t)}process_arguments(t){return new Promise((e,n)=>Object(r.a)(this,void 0,void 0,(function*(){if(3==t.length){const r=t[0],i=t[1],s=t[2];let o=null;try{o=yield this.get_referenced_node_container(r)}catch(t){n(t)}if(o){const t=this._get_value_from_container(o,i,s);e(t)}}else e(0)})))}_get_value_from_container(t,e,n){const r=t.core_content();if(r){const t=r.points()[n];return t?t.attrib_value(e):0}return null}},points_count:class extends d{static required_arguments(){return[["string","path to node"]]}find_dependency(t){return this.create_dependency_from_index_or_path(t)}process_arguments(t){return new Promise((e,n)=>Object(r.a)(this,void 0,void 0,(function*(){if(1==t.length){const r=t[0];let i;try{i=yield this.get_referenced_node_container(r)}catch(t){return void n(t)}if(i){const t=i.points_count();e(t)}}else e(0)})))}},copy:class extends d{static required_arguments(){return[["string","path to copy"],["integer","default value"]]}static optional_arguments(){return[["string","attribute name (optional)"]]}find_dependency(t){const e=this.find_referenced_graph_node(t);if(e&&"copy"==e.type){const n=e.stamp_node;return this.create_dependency(n,t)}return null}process_arguments(t){return new Promise((e,n)=>{if(2==t.length||3==t.length){const n=t[0],r=t[1],i=t[2],o=s.a.find_node(this.node,n);let a;o&&"copy"==o.type&&(a=o.stamp_value(i)),null==a&&(a=r),e(a)}else e(0)})}},str_chars_count:class extends d{static required_arguments(){return[["string","string to count characters of"]]}process_arguments(t){return Object(r.a)(this,void 0,void 0,(function*(){let e=0;if(1==t.length){e=t[0].length}return e}))}},str_concat:class extends d{static required_arguments(){return[]}process_arguments(t){return Object(r.a)(this,void 0,void 0,(function*(){let e="";for(let n of t)null==n&&(n=""),e+=`${n}`;return e}))}},str_index:class extends d{static required_arguments(){return[["string","string to get index from"],["string","char to find index of"]]}process_arguments(t){return Object(r.a)(this,void 0,void 0,(function*(){let e=-1;if(2==t.length){const n=t[0],r=t[1];e=n.indexOf(r)}return e}))}},str_sub:class extends d{static required_arguments(){return[["string","string to get range from"],["integer","range start"],["integer","range size"]]}process_arguments(t){return Object(r.a)(this,void 0,void 0,(function*(){let e="";const n=t[0],r=t[1]||0;let i=t[2]||1;return n&&(e=n.substr(r,i)),e}))}}};var x=n(127),b=n(79);class w{constructor(t){this.param=t,this._set_error_from_error_bound=this._set_error_from_error.bind(this)}clear_error(){this._error_message=void 0}set_error(t){this._error_message=this._error_message||t}_set_error_from_error(t){l()(t)?this._error_message=t:this._error_message=t.message}get is_errored(){return null!=this._error_message}get error_message(){return this._error_message}reset(){this._error_message=void 0}traverse_node(t){const e=`traverse_${t.type}`;if(this[e])return this[e](t);this.set_error(`expression unknown node type: ${t.type}`)}traverse_BinaryExpression(t){return`${this.traverse_node(t.left)} ${t.operator} ${this.traverse_node(t.right)}`}traverse_LogicalExpression(t){return`${this.traverse_node(t.left)} ${t.operator} ${this.traverse_node(t.right)}`}traverse_MemberExpression(t){return`${this.traverse_node(t.object)}.${this.traverse_node(t.property)}`}traverse_ConditionalExpression(t){return`(${this.traverse_node(t.test)}) ? (${this.traverse_node(t.consequent)}) : (${this.traverse_node(t.alternate)})`}traverse_Compound(t){const e=t.body;let n=[];for(let t=0;t<e.length;t++){const r=e[t];"Identifier"==r.type?"$"==r.name[0]?n.push("`${"+this.traverse_node(r)+"}`"):n.push(`'${r.name}'`):n.push("`${"+this.traverse_node(r)+"}`")}return n.join(" + ")}traverse_Literal(t){return`${t.raw}`}}class k{constructor(){}reset(){this._attribute_names&&this._attribute_names.clear()}assign_attributes_lines(){var t;if(this._attribute_names){const e=[];return null===(t=this._attribute_names)||void 0===t||t.forEach(t=>{e.push(k.assign_attribute_line(t))}),e.join(";\n")}return""}assign_arrays_lines(){var t;if(this._attribute_names){const e=[];return null===(t=this._attribute_names)||void 0===t||t.forEach(t=>{e.push(k.assign_item_size_line(t)),e.push(k.assign_array_line(t))}),e.join(";\n")}return""}attribute_presence_check_line(){var t;if(this._attribute_names){const e=[];return null===(t=this._attribute_names)||void 0===t||t.forEach(t=>{const n=k.var_attribute(t);e.push(n)}),e.join(" && ")}return"true"}add(t){this._attribute_names=this._attribute_names||new Set,this._attribute_names.add(t)}static assign_attribute_line(t){return`const ${this.var_attribute(t)} = entities[0].geometry().attributes['${t}']`}static assign_item_size_line(t){const e=this.var_attribute(t);return`const ${this.var_attribute_size(t)} = ${e}.itemSize`}static assign_array_line(t){const e=this.var_attribute(t);return`const ${this.var_array(t)} = ${e}.array`}static var_attribute(t){return`attrib_${t}`}static var_attribute_size(t){return`attrib_size_${t}`}static var_array(t){return`array_${t}`}var_attribute_size(t){return k.var_attribute_size(t)}var_array(t){return k.var_array(t)}}var E=n(125),M=n(143);const O={math_random:"random"},j=Object.keys(b.a),A={};["abs","acos","acosh","asin","asinh","atan","atan2","atanh","ceil","cos","cosh","exp","expm1","floor","log","log1p","log2","log10","max","min","pow","round","sign","sin","sinh","sqrt","tan","tanh"].forEach(t=>{A[t]=`Math.${t}`}),["cbrt","hypot","log10","trunc"].forEach(t=>{A[t]=`Math.${t}`}),Object.keys(O).forEach(t=>{const e=O[t];A[t]=`Math.${e}`}),["fit","fit01","fract","deg2rad","rad2deg","rand","clamp"].forEach(t=>{A[t]=`Core.Math.${t}`}),j.forEach(t=>{A[t]=`Core.Math.Easing.${t}`}),["precision"].forEach(t=>{A[t]=`Core.String.${t}`});const z={if:class{static if(t){return`(${t[0]}) ? (${t[1]}) : (${t[2]})`}}.if},T={};["E","LN2","LN10","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"].forEach(t=>{T[t]=`Math.${t}`});const S=y,P={x:0,y:1,z:2,w:3,r:0,g:1,b:2};class R extends w{constructor(t){super(t),this.param=t,this._attribute_requirements_controller=new k,this.methods=[],this.method_index=-1,this.method_dependencies=[],this.immutable_dependencies=[]}parse_tree(t){if(this.reset(),null==t.error_message){try{if(this._attribute_requirements_controller.reset(),t.node){const e=this.traverse_node(t.node);e&&!this.is_errored&&(this.function_main_string=e)}else console.warn("no parsed_tree.node")}catch(t){console.warn(`error in expression for param ${this.param.full_path()}`),console.warn(t)}if(this.function_main_string)try{this.function=new M.a("Core","param","methods","_set_error_from_error",`\n\t\t\t\t\ttry {\n\t\t\t\t\t\t${this.function_body()}\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t_set_error_from_error(e)\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}`)}catch(t){console.warn(t),this.set_error("cannot generate function")}else this.set_error("cannot generate function body")}else this.set_error("cannot parse expression")}reset(){super.reset(),this.function_main_string=void 0,this.methods=[],this.method_index=-1,this.function=void 0,this.method_dependencies=[],this.immutable_dependencies=[]}function_body(){return this.param.options.is_expression_for_entities?`\n\t\t\tconst entities = param.expression_controller.entities;\n\t\t\tif(entities){\n\t\t\t\treturn new Promise( async (resolve, reject)=>{\n\t\t\t\t\tlet entity;\n\t\t\t\t\tconst entity_callback = param.expression_controller.entity_callback;\n\t\t\t\t\t${this._attribute_requirements_controller.assign_attributes_lines()}\n\t\t\t\t\tif( ${this._attribute_requirements_controller.attribute_presence_check_line()} ){\n\t\t\t\t\t\t${this._attribute_requirements_controller.assign_arrays_lines()}\n\t\t\t\t\t\tfor(let index=0; index < entities.length; index++){\n\t\t\t\t\t\t\tentity = entities[index];\n\t\t\t\t\t\t\tresult = ${this.function_main_string};\n\t\t\t\t\t\t\tentity_callback(entity, result);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresolve()\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst error = new Error('attribute not found')\n\t\t\t\t\t\t_set_error_from_error(error)\n\t\t\t\t\t\treject(error)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\treturn []`:`\n\t\t\treturn new Promise( async (resolve, reject)=>{\n\t\t\t\ttry {\n\t\t\t\t\tconst value = ${this.function_main_string}\n\t\t\t\t\tresolve(value)\n\t\t\t\t} catch(e) {\n\t\t\t\t\t_set_error_from_error(e)\n\t\t\t\t\treject()\n\t\t\t\t}\n\t\t\t})\n\t\t\t`}eval_allowed(){return null!=this.function}eval_function(){if(this.function){this.clear_error();const t={Math:E.a,String:g.a};return this.function(t,this.param,this.methods,this._set_error_from_error_bound)}}traverse_CallExpression(t){const e=t.arguments.map(t=>this.traverse_node(t)),n=t.callee.name;if(n){const r=z[n];if(r)return r(e);const i=`${e.join(", ")}`,s=A[n];if(s)return`${s}(${i})`;if(S[n]){const r=t.arguments[0],s=`return ${e[0]}`;let o,a=[];try{o=new Function(s),a=o()}catch(t){}return this._create_method_and_dependencies(n,a,r),`(await methods[${this.method_index}].process_arguments([${i}]))`}}this.set_error(`unknown method: ${n}`)}traverse_BinaryExpression(t){return`(${this.traverse_node(t.left)} ${t.operator} ${this.traverse_node(t.right)})`}traverse_LogicalExpression(t){return`(${this.traverse_node(t.left)} ${t.operator} ${this.traverse_node(t.right)})`}traverse_MemberExpression(t){return`${this.traverse_node(t.object)}.${this.traverse_node(t.property)}`}traverse_UnaryExpression(t){if("@"===t.operator){let e,n,r=t.argument;switch(r.type){case"Identifier":e=r.name;break;case"MemberExpression":{const t=r,i=t.object,s=t.property;e=i.name,n=s.name;break}}if(e){if(e=x.a.remap_name(e),"ptnum"==e)return"((entity != null) ? entity.index : 0)";{const t=this._attribute_requirements_controller.var_attribute_size(e),r=this._attribute_requirements_controller.var_array(e);if(this._attribute_requirements_controller.add(e),n){return`${r}[entity.index*${t}+${P[n]}]`}return`${r}[entity.index*${t}]`}}return console.warn("attribute not found"),""}return`${t.operator}${this.traverse_node(t.argument)}`}traverse_Literal(t){return`${t.raw}`}traverse_Identifier(t){if("$"!=t.name[0])return t.name;{const e=t.name.substr(1),n=T[e];if(n)return n;const r=`traverse_Identifier_${e}`;if(this[r])return this[r]();this.set_error(`identifier unknown: ${t.name}`)}}traverse_Identifier_F(){return this.immutable_dependencies.push(this.param.scene.time_controller.graph_node),"param.scene.time_controller.frame"}traverse_Identifier_FPS(){return this.immutable_dependencies.push(this.param.scene.time_controller.graph_node),"param.scene.time_controller.fps"}traverse_Identifier_T(){return this.immutable_dependencies.push(this.param.scene.time_controller.graph_node),"param.scene.time_controller.time"}traverse_Identifier_CH(){return`'${this.param.name}'`}traverse_Identifier_CEX(){return this._method_centroid("x")}traverse_Identifier_CEY(){return this._method_centroid("y")}traverse_Identifier_CEZ(){return this._method_centroid("z")}_method_centroid(t){const e=[0,`'${t}'`].join(", ");return this._create_method_and_dependencies("centroid",0),`(await methods[${this.method_index}].process_arguments([${e}]))`}_create_method_and_dependencies(t,e,n){const r=new(0,S[t])(this.param);this.method_index+=1,this.methods[this.method_index]=r;const i=r.find_dependency(e);i?(n&&i.set_jsep_node(n),this.method_dependencies.push(i)):n&&l()(e)&&this.param.scene.missing_expression_references_controller.register(this.param,n,e)}}class C extends w{constructor(t){super(t),this.param=t}parse_tree(t){if(null==t.error_message&&t.node)try{return this.traverse_node(t.node)}catch(t){this.set_error("could not traverse tree")}else this.set_error("cannot parse tree")}traverse_CallExpression(t){const e=`${t.arguments.map(t=>this.traverse_node(t)).join(", ")}`;return`${t.callee.name}(${e})`}traverse_UnaryExpression(t){return`${t.operator}${this.traverse_node(t.argument)}`}traverse_Identifier(t){return`${t.name}`}}class q{constructor(t){this.param=t,this.cyclic_graph_detected=!1,this.method_dependencies=[]}set_error(t){this.error_message=this.error_message||t}reset(){this.param.graph_disconnect_predecessors(),this.method_dependencies.forEach(t=>{t.reset()}),this.method_dependencies=[]}update(t){this.cyclic_graph_detected=!1,this.connect_immutable_dependencies(t),this.method_dependencies=t.method_dependencies,this.handle_method_dependencies(),this.listen_for_name_changes()}connect_immutable_dependencies(t){t.immutable_dependencies.forEach(t=>{if(0==this.cyclic_graph_detected&&0==this.param.add_graph_input(t))return this.cyclic_graph_detected=!0,this.set_error("cannot create expression, infinite graph detected"),void this.reset()})}handle_method_dependencies(){this.method_dependencies.forEach(t=>{0==this.cyclic_graph_detected&&this.handle_method_dependency(t)})}handle_method_dependency(t){const e=t.resolved_graph_node;if(e&&!this.param.add_graph_input(e))return this.cyclic_graph_detected=!0,this.set_error("cannot create expression, infinite graph detected"),void this.reset()}listen_for_name_changes(){this.method_dependencies.forEach(t=>{t.listen_for_name_changes()})}}var D=n(0);class L{constructor(t){this.param=t,this.parse_completed=!1,this.parse_started=!1,this.parsed_tree=new i.a,this.function_generator=new R(this.param),this.dependencies_controller=new q(this.param)}parse_expression(t){if(this.parse_started)throw new Error(`parse in progress for param ${this.param.full_path()}`);this.parse_started=!0,this.parse_completed=!1,this.parsed_tree=this.parsed_tree||new i.a,this.reset(),this.param.type==D.a.STRING?this.parsed_tree.parse_expression_for_string_param(t):this.parsed_tree.parse_expression(t),this.function_generator.parse_tree(this.parsed_tree),null==this.function_generator.error_message&&(this.dependencies_controller.update(this.function_generator),this.dependencies_controller.error_message?this.param.states.error.set(this.dependencies_controller.error_message):(this.parse_completed=!0,this.parse_started=!1))}compute_function(){return Object(r.a)(this,void 0,void 0,(function*(){if(!this.compute_allowed())return new Promise((t,e)=>{t(null)});try{return yield this.function_generator.eval_function()}catch(t){return new Promise((t,e)=>t())}}))}reset(){this.parse_completed=!1,this.parse_started=!1,this.dependencies_controller.reset(),this.function_generator.reset()}get is_errored(){return this.function_generator.is_errored}get error_message(){return this.function_generator.error_message}compute_allowed(){return this.function_generator.eval_allowed()}update_from_method_dependency_name_change(){this.expression_string_generator=this.expression_string_generator||new C(this.param);const t=this.expression_string_generator.parse_tree(this.parsed_tree);t?this.param.set(t):console.warn("failed to regenerate expression")}}class N{constructor(t){this.param=t}get active(){return null!=this._expression}get expression(){return this._expression}get is_errored(){return!!this._manager&&this._manager.is_errored}get error_message(){return this._manager?this._manager.error_message:null}get requires_entities(){return this.param.options.is_expression_for_entities}set_expression(t,e=!0){var n;this.param.scene.missing_expression_references_controller.deregister_param(this.param),this.param.scene.expressions_controller.deregister_param(this.param),this._expression!=t&&(this._expression=t,this._expression?(this._manager=this._manager||new L(this.param),this._manager.parse_expression(this._expression)):null===(n=this._manager)||void 0===n||n.reset(),e&&this.param.set_dirty())}update_from_method_dependency_name_change(){this._manager&&this.active&&this._manager.update_from_method_dependency_name_change()}compute_expression(){return Object(r.a)(this,void 0,void 0,(function*(){if(this._manager&&this.active){return yield this._manager.compute_function()}}))}compute_expression_for_entities(t,e){var n,i;return Object(r.a)(this,void 0,void 0,(function*(){this.set_entities(t,e),yield this.compute_expression(),(null===(n=this._manager)||void 0===n?void 0:n.error_message)&&this.param.node.states.error.set(`expression evalution error: ${null===(i=this._manager)||void 0===i?void 0:i.error_message}`),this.reset_entities()}))}compute_expression_for_points(t,e){return this.compute_expression_for_entities(t,e)}compute_expression_for_objects(t,e){return this.compute_expression_for_entities(t,e)}get entities(){return this._entities}get entity_callback(){return this._entity_callback}set_entities(t,e){this._entities=t,this._entity_callback=e}reset_entities(){this._entities=void 0,this._entity_callback=void 0}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var r;!function(t){t.auxclick="auxclick",t.click="click",t.contextmenu="contextmenu",t.dblclick="dblclick",t.mousedown="mousedown",t.mouseenter="mouseenter",t.mouseleave="mouseleave",t.mousemove="mousemove",t.mouseover="mouseover",t.mouseout="mouseout",t.mouseup="mouseup",t.pointerlockchange="pointerlockchange",t.pointerlockerror="pointerlockerror",t.select="select",t.wheel="wheel"}(r||(r={}));const i=[r.auxclick,r.click,r.contextmenu,r.dblclick,r.mousedown,r.mouseenter,r.mouseleave,r.mousemove,r.mouseover,r.mouseout,r.mouseup,r.pointerlockchange,r.pointerlockerror,r.select,r.wheel];class s extends class{constructor(){this._nodes_by_graph_node_id=new Map}register_node(t){this._nodes_by_graph_node_id.set(t.graph_node_id,t)}unregister_node(t){this._nodes_by_graph_node_id.delete(t.graph_node_id)}process(t,e,n){this._nodes_by_graph_node_id.forEach(r=>r.process_event(t,e,n))}}{accepts_event(t){return i.includes(t.type)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r,i=n(59),s=n(4),o=n(10),a=n(12),_=n(38),u=function(t){var e;if("undefined"==typeof HTMLCanvasElement)return t.src;if(t instanceof HTMLCanvasElement)e=t;else{void 0===r&&(r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),r.width=t.width,r.height=t.height;var n=r.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=r}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")},c=0;function h(t,e,n,r,i,u,l,d,p,f){Object.defineProperty(this,"id",{value:c++}),this.uuid=o.a.generateUUID(),this.name="",this.image=void 0!==t?t:h.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:h.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:s.l,this.wrapT=void 0!==r?r:s.l,this.magFilter=void 0!==i?i:s.R,this.minFilter=void 0!==u?u:s.U,this.anisotropy=void 0!==p?p:1,this.format=void 0!==l?l:s.Db,this.internalFormat=null,this.type=void 0!==d?d:s.Wc,this.offset=new a.a(0,0),this.repeat=new a.a(1,1),this.center=new a.a(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new _.a,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==f?f:s.Q,this.version=0,this.onUpdate=null}h.DEFAULT_IMAGE=void 0,h.DEFAULT_MAPPING=s.Uc,h.prototype=Object.assign(Object.create(i.a.prototype),{constructor:h,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=o.a.generateUUID()),!e&&void 0===t.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var s=0,a=r.length;s<a;s++)i.push(u(r[s]))}else i=u(r);t.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==s.Uc)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case s.rc:t.x=t.x-Math.floor(t.x);break;case s.l:t.x=t.x<0?0:1;break;case s.gb:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case s.rc:t.y=t.y-Math.floor(t.y);break;case s.l:t.y=t.y<0?0:1;break;case s.gb:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(h.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}})},function(t,e,n){var r=n(50),i=n(280),s=n(282);t.exports=function(t,e){return s(i(t,e,r),t+"")}},function(t,e,n){var r=n(68),i=n(199),s=n(200),o=n(201),a=n(202),_=n(203);function u(t){var e=this.__data__=new r(t);this.size=e.size}u.prototype.clear=i,u.prototype.delete=s,u.prototype.get=o,u.prototype.has=a,u.prototype.set=_,t.exports=u},function(t,e,n){var r=n(149);t.exports=function(t,e,n){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},function(t,e,n){var r=n(151)(Object.getPrototypeOf,Object);t.exports=r},function(t,e,n){var r=n(94),i=n(253),s=n(254);function o(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new r;++e<n;)this.add(t[e])}o.prototype.add=o.prototype.push=i,o.prototype.has=s,t.exports=o},function(t,e){t.exports=function(t,e){return t.has(e)}},function(t,e,n){"use strict";function r(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}n.d(e,"a",(function(){return r})),Object.assign(r.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var s;n:{r:if(!(t<r)){for(var o=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===o)break;if(i=r,t<(r=e[++n]))break e}s=e.length;break n}if(t>=i)break t;var a=e[1];t<a&&(n=2,i=a);for(o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===o)break;if(r=i,t>=(i=e[--n-1]))break e}s=n,n=0}for(;n<s;){var _=n+s>>>1;t<e[_]?s=_:n=_+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,s=0;s!==r;++s)e[s]=n[i+s];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(r.prototype,{beforeStart_:r.prototype.copySampleValue_,afterEnd_:r.prototype.copySampleValue_})},function(t,e,n){t.exports=n(245)},function(t,e,n){"use strict";var r=n(16);t.exports=i;function i(t){this._isDirected=!r.has(t,"directed")||t.directed,this._isMultigraph=!!r.has(t,"multigraph")&&t.multigraph,this._isCompound=!!r.has(t,"compound")&&t.compound,this._label=void 0,this._defaultNodeLabelFn=r.constant(void 0),this._defaultEdgeLabelFn=r.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function s(t,e){t[e]?t[e]++:t[e]=1}function o(t,e){--t[e]||delete t[e]}function a(t,e,n,i){var s=""+e,o=""+n;if(!t&&s>o){var a=s;s=o,o=a}return s+""+o+""+(r.isUndefined(i)?"\0":i)}function _(t,e,n,r){var i=""+e,s=""+n;if(!t&&i>s){var o=i;i=s,s=o}var a={v:i,w:s};return r&&(a.name=r),a}function u(t,e){return a(t,e.v,e.w,e.name)}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(t){return this._label=t,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(t){return r.isFunction(t)||(t=r.constant(t)),this._defaultNodeLabelFn=t,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return r.keys(this._nodes)},i.prototype.sources=function(){var t=this;return r.filter(this.nodes(),(function(e){return r.isEmpty(t._in[e])}))},i.prototype.sinks=function(){var t=this;return r.filter(this.nodes(),(function(e){return r.isEmpty(t._out[e])}))},i.prototype.setNodes=function(t,e){var n=arguments,i=this;return r.each(t,(function(t){n.length>1?i.setNode(t,e):i.setNode(t)})),this},i.prototype.setNode=function(t,e){return r.has(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=e),this):(this._nodes[t]=arguments.length>1?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]="\0",this._children[t]={},this._children["\0"][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)},i.prototype.node=function(t){return this._nodes[t]},i.prototype.hasNode=function(t){return r.has(this._nodes,t)},i.prototype.removeNode=function(t){var e=this;if(r.has(this._nodes,t)){var n=function(t){e.removeEdge(e._edgeObjs[t])};delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],r.each(this.children(t),(function(t){e.setParent(t)})),delete this._children[t]),r.each(r.keys(this._in[t]),n),delete this._in[t],delete this._preds[t],r.each(r.keys(this._out[t]),n),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this},i.prototype.setParent=function(t,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(r.isUndefined(e))e="\0";else{for(var n=e+="";!r.isUndefined(n);n=this.parent(n))if(n===t)throw new Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this},i.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},i.prototype.parent=function(t){if(this._isCompound){var e=this._parent[t];if("\0"!==e)return e}},i.prototype.children=function(t){if(r.isUndefined(t)&&(t="\0"),this._isCompound){var e=this._children[t];if(e)return r.keys(e)}else{if("\0"===t)return this.nodes();if(this.hasNode(t))return[]}},i.prototype.predecessors=function(t){var e=this._preds[t];if(e)return r.keys(e)},i.prototype.successors=function(t){var e=this._sucs[t];if(e)return r.keys(e)},i.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return r.union(e,this.successors(t))},i.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},i.prototype.filterNodes=function(t){var e=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});e.setGraph(this.graph());var n=this;r.each(this._nodes,(function(n,r){t(r)&&e.setNode(r,n)})),r.each(this._edgeObjs,(function(t){e.hasNode(t.v)&&e.hasNode(t.w)&&e.setEdge(t,n.edge(t))}));var i={};return this._isCompound&&r.each(e.nodes(),(function(t){e.setParent(t,function t(r){var s=n.parent(r);return void 0===s||e.hasNode(s)?(i[r]=s,s):s in i?i[s]:t(s)}(t))})),e},i.prototype.setDefaultEdgeLabel=function(t){return r.isFunction(t)||(t=r.constant(t)),this._defaultEdgeLabelFn=t,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return r.values(this._edgeObjs)},i.prototype.setPath=function(t,e){var n=this,i=arguments;return r.reduce(t,(function(t,r){return i.length>1?n.setEdge(t,r,e):n.setEdge(t,r),r})),this},i.prototype.setEdge=function(){var t,e,n,i,o=!1,u=arguments[0];"object"==typeof u&&null!==u&&"v"in u?(t=u.v,e=u.w,n=u.name,2===arguments.length&&(i=arguments[1],o=!0)):(t=u,e=arguments[1],n=arguments[3],arguments.length>2&&(i=arguments[2],o=!0)),t=""+t,e=""+e,r.isUndefined(n)||(n=""+n);var c=a(this._isDirected,t,e,n);if(r.has(this._edgeLabels,c))return o&&(this._edgeLabels[c]=i),this;if(!r.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(e),this._edgeLabels[c]=o?i:this._defaultEdgeLabelFn(t,e,n);var h=_(this._isDirected,t,e,n);return t=h.v,e=h.w,Object.freeze(h),this._edgeObjs[c]=h,s(this._preds[e],t),s(this._sucs[t],e),this._in[e][c]=h,this._out[t][c]=h,this._edgeCount++,this},i.prototype.edge=function(t,e,n){var r=1===arguments.length?u(this._isDirected,arguments[0]):a(this._isDirected,t,e,n);return this._edgeLabels[r]},i.prototype.hasEdge=function(t,e,n){var i=1===arguments.length?u(this._isDirected,arguments[0]):a(this._isDirected,t,e,n);return r.has(this._edgeLabels,i)},i.prototype.removeEdge=function(t,e,n){var r=1===arguments.length?u(this._isDirected,arguments[0]):a(this._isDirected,t,e,n),i=this._edgeObjs[r];return i&&(t=i.v,e=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],o(this._preds[e],t),o(this._sucs[t],e),delete this._in[e][r],delete this._out[t][r],this._edgeCount--),this},i.prototype.inEdges=function(t,e){var n=this._in[t];if(n){var i=r.values(n);return e?r.filter(i,(function(t){return t.v===e})):i}},i.prototype.outEdges=function(t,e){var n=this._out[t];if(n){var i=r.values(n);return e?r.filter(i,(function(t){return t.w===e})):i}},i.prototype.nodeEdges=function(t,e){var n=this.inEdges(t,e);if(n)return n.concat(this.outEdges(t,e))}},function(t,e,n){var r=n(32)(n(19),"Map");t.exports=r},function(t,e,n){var r=n(210),i=n(217),s=n(219),o=n(220),a=n(221);function _(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}_.prototype.clear=r,_.prototype.delete=i,_.prototype.get=s,_.prototype.has=o,_.prototype.set=a,t.exports=_},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){var n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&n.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e){t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},function(t,e,n){(function(t){var r=n(146),i=e&&!e.nodeType&&e,s=i&&"object"==typeof t&&t&&!t.nodeType&&t,o=s&&s.exports===i&&r.process,a=function(){try{var t=s&&s.require&&s.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=a}).call(this,n(96)(t))},function(t,e,n){var r=n(72),i=n(226),s=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return i(t);var e=[];for(var n in Object(t))s.call(t,n)&&"constructor"!=n&&e.push(n);return e}},function(t,e,n){var r=n(152),i=n(153),s=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,a=o?function(t){return null==t?[]:(t=Object(t),r(o(t),(function(e){return s.call(t,e)})))}:i;t.exports=a},function(t,e,n){var r=n(158);t.exports=function(t){var e=new t.constructor(t.byteLength);return new r(e).set(new r(t)),e}},function(t,e,n){var r=n(252),i=n(18);t.exports=function t(e,n,s,o,a){return e===n||(null==e||null==n||!i(e)&&!i(n)?e!=e&&n!=n:r(e,n,s,o,t,a))}},function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}},function(t,e,n){var r=n(3),i=n(51),s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!i(t))||(o.test(t)||!s.test(t)||null!=e&&t in Object(e))}},function(t,e,n){var r=n(40),i=n(46),s=n(3),o=n(51),a=r?r.prototype:void 0,_=a?a.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(s(e))return i(e,t)+"";if(o(e))return _?_.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}},function(t,e,n){var r=n(276),i=n(75),s=n(277);t.exports=function(t){return i(t)?s(t):r(t)}},function(t,e,n){var r=n(192);t.exports=function(t,e,n){var i=t.length;return n=void 0===n?i:n,!e&&n>=i?t:r(t,e,n)}},function(t,e,n){var r=n(307),i=n(75),s=n(308);t.exports=function(t){return i(t)?s(t):r(t)}},function(t,e,n){"use strict";n.d(e,"b",(function(){return d})),n.d(e,"a",(function(){return p}));var r=n(1),i=n(27),s=n.n(i),o=n(54),a=n.n(o),_=n(55),u=n.n(_),c=n(0),h=n(8),l=n(13);var d;!function(t){t.TYPESCRIPT="typescript"}(d||(d={}));class p{constructor(t){this._param=t,this._programatic_visible_state=!0,this._update_visibility_and_remove_dirty_bound=this.update_visibility_and_remove_dirty.bind(this),this._ui_data_dependency_set=!1}set(t){this._default_options=t,this._options=a()(this._default_options)}copy(t){this._default_options=a()(t.default),this._options=a()(t.current)}set_option(t,e){return Object.assign(this._options,t,e)}get param(){return this._param}get node(){return this._param.node}get default(){return this._default_options}get current(){return this._options}get has_options_overridden(){return!u()(this._options,this._default_options)}get overridden_options(){const t={},e=Object.keys(this._options);for(let n of e)u()(this._options[n],this._default_options[n])||Object.assign(t,n,a()(this._options[n]));return t}get overridden_option_names(){return Object.keys(this.overridden_options)}get always_reference_asset(){return this._options.always_reference_asset||!1}has_callback(){return null!=this._options.callback||null!=this._options.callback_string}execute_callback(){if(!this.node||!this.node.scene.loading_controller.loaded)return;const t=this.get_callback();null!=t&&this.node&&!this.node.cook_controller.is_cooking&&t(this.node,this.param)}get_callback(){if(this.has_callback())return this._options.callback=this._options.callback||this.create_callback_from_string()}create_callback_from_string(){const t=this._options.callback_string;if(t){const e=new Function("node","scene","window","location",t);return()=>{e(this.node,this.node.scene,null,null)}}}makes_node_dirty_when_dirty(){let t;if(null!=this.param.parent_param)return!1;let e=!0;return null!=(t=this._options.cook)&&(e=t),e}get desktop_browse_option(){return this._options.desktop_browse}get desktop_browse_allowed(){return null!=this.desktop_browse_option}desktop_browse_file_type(){return this.desktop_browse_option?this.desktop_browse_option.file_type:null}get is_expression_for_entities(){const t=this._options.expression;return t&&t.for_entities||!1}get level(){return this._options.level||0}get has_menu(){return null!=this.menu_options}get menu_options(){return this._options.menu}get menu_entries(){return this.menu_options?this.menu_options.entries:[]}get has_menu_radio(){return this.has_menu}get is_multiline(){return!0===this._options.multiline}get language(){return this._options.language}get is_code(){return null!=this.language}get node_selection_options(){return this._options.node_selection}get node_selection_context(){if(this.node_selection_options)return this.node_selection_options.context}dependent_on_found_node(){return!("dependent_on_found_node"in this._options)||this._options.dependent_on_found_node}get range(){return this._options.range||[0,1]}get step(){return this._options.step||.01}range_locked(){return this._options.range_locked||[!1,!1]}ensure_in_range(t){const e=this.range;return t>=e[0]&&t<=e[1]?t:t<e[0]?!0===this.range_locked()[0]?e[0]:t:!0===this.range_locked()[1]?e[1]:t}get is_spare(){return this._options.spare||!1}get texture_options(){return this._options.texture}texture_as_env(){const t=this.texture_options;return null!=t&&!0===t.env}get is_hidden(){return!0===this._options.hidden||!1===this._programatic_visible_state}get is_visible(){return!this.is_hidden}set_visible_state(t){this._options.hidden=!t,this.param.emit(h.a.VISIBLE_UPDATED)}get is_label_hidden(){const t=this.param.type;return!1===this._options.label||t===c.a.BUTTON||t===c.a.SEPARATOR||t===c.a.BOOLEAN&&this.is_field_hidden()}is_field_hidden(){return!1===this._options.field}ui_data_depends_on_other_params(){return"visible_if"in this._options}visibility_predecessors(){const t=Object.keys(this._options.visible_if||{}),e=this.param.node;return s()(t.map(t=>{const n=e.params.get(t);if(n)return n;console.error(`param ${t} not found as visibility condition for ${this.param.name} in node ${this.param.node.type}`)}))}set_ui_data_dependency(){if(this._ui_data_dependency_set)return;this._ui_data_dependency_set=!0;const t=this.visibility_predecessors();if(t.length>0){this._visibility_graph_node=new l.a(this.param.scene,"param_visibility");for(let e of t)this._visibility_graph_node.add_graph_input(e);this._visibility_graph_node.add_post_dirty_hook("_update_visibility_and_remove_dirty",this._update_visibility_and_remove_dirty_bound)}}update_visibility_and_remove_dirty(){this.update_visibility(),this.param.remove_dirty_state()}update_visibility(){return Object(r.a)(this,void 0,void 0,(function*(){const t=this._options.visible_if;if(t){const e=this.visibility_predecessors(),n=e.map(t=>t.compute());this._programatic_visible_state=!0,yield Promise.all(n);for(let n of e){t[n.name]!=n.value&&(this._programatic_visible_state=!1)}this.param.emit(h.a.VISIBLE_UPDATED)}}))}}},function(t,e,n){var r=n(53),i=n(84),s=n(171),o=n(124),a=i((function(t){return s(r(t,1,o,!0))}));t.exports=a},function(t,e,n){var r=n(33),i=n(113);t.exports=function(t){return i(r(t).toLowerCase())}},function(t,e,n){var r=n(311)("toUpperCase");t.exports=r},function(t,e,n){var r=n(76),i=n(22),s=n(5),o=n(136),a=n(77),_=Math.max;t.exports=function(t,e,n,u){t=i(t)?t:a(t),n=n&&!u?o(n):0;var c=t.length;return n<0&&(n=_(c+n,0)),s(t)?n<=c&&t.indexOf(e,n)>-1:!!c&&r(t,e,n)>-1}},function(t,e,n){var r=n(193);t.exports={Graph:r.Graph,json:n(292),alg:n(293),version:r.version}},function(t,e,n){var r=n(309),i=n(107),s=n(136),o=n(33);t.exports=function(t,e,n){t=o(t);var a=(e=s(e))?i(t):0;return e&&a<e?t+r(e-a,n):t}},function(t,e,n){var r=n(112),i=n(179)((function(t,e,n){return e=e.toLowerCase(),t+(n?r(e):e)}));t.exports=i},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(45);class i{constructor(t,e,n){this._name=t,this._type=e,this._init_value=n,void 0===this._init_value&&(this._init_value=r.b[this._type])}get name(){return this._name}get type(){return this._type}get param_type(){return r.d[this._type]}get init_value(){return this._init_value}to_json(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));class r{static push_on_array_at_entry(t,e,n){t.has(e)?t.get(e).push(n):t.set(e,[n])}static unshift_on_array_at_entry(t,e,n){t.has(e)?t.get(e).unshift(n):t.set(e,[n])}static concat_on_array_at_entry(t,e,n){if(t.has(e)){let r=t.get(e);for(let t of n)r.push(t)}else t.set(e,n)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(25);function i(){r.a.call(this),this.type="Group"}i.prototype=Object.assign(Object.create(r.a.prototype),{constructor:i,isGroup:!0})},function(t,e,n){var r=n(302)();t.exports=r},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(83),i=n(4);function s(t,e,n,s,o,a,_,u,c,h,l,d){r.a.call(this,null,a,_,u,c,h,s,o,l,d),this.image={data:t||null,width:e||1,height:n||1},this.magFilter=void 0!==c?c:i.kb,this.minFilter=void 0!==h?h:i.kb,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}s.prototype=Object.create(r.a.prototype),s.prototype.constructor=s,s.prototype.isDataTexture=!0},function(t,e,n){var r=n(150),i=n(228),s=n(22);t.exports=function(t){return s(t)?r(t,!0):i(t)}},function(t,e,n){var r=n(22),i=n(18);t.exports=function(t){return i(t)&&r(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(2),i=n(138),s=n(9),o=n.n(s),a=n(79);const _={Triangle:i.a,Vector3:r.a},u=Math.PI/180;class c{static clamp(t,e,n){return t<e?e:t>n?n:t}static fit01(t,e,n){return this.fit(t,0,1,e,n)}static fit(t,e,n,r,i){return(t-e)/(n-e)*(i-r)+r}static degrees_to_radians(t){return t*u}static radians_to_degrees(t){return t/u}static deg2rad(t){return this.degrees_to_radians(t)}static rad2deg(t){return this.radians_to_degrees(t)}static rand(t){return o()(t)?this.rand_float(t):this.rand_vec2(t)}static round(t,e){const n=t/e,r=t<0?Math.ceil(n):Math.floor(n);return console.log("round",e,t,n,r,r*e),r*e}static highest_even(t){return 2*Math.ceil(.5*t)}static rand_float(t){const e={x:t,y:136574};return this.rand_vec2(e)}static rand_vec2(t){const e=(12.9898*t.x+78.233*t.y)%Math.PI;return this.fract(43758.5453*Math.sin(e))}static geodesic_distance(t,e){var n=this.deg2rad(t.lat),r=this.deg2rad(e.lat),i=this.deg2rad(e.lat-t.lat),s=this.deg2rad(e.lng-t.lng),o=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n)*Math.cos(r)*Math.sin(s/2)*Math.sin(s/2);return 6371e3*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}static expand_triangle(t,e){const n=new _.Vector3;let r;t.getMidpoint(n),function(t){t.a="a",t.b="b",t.c="c"}(r||(r={}));for(let r of["a","b","c"]){const i=t[r].clone().sub(n),s=i.clone().normalize(),o=i.length()+e;t[r]=n.clone().add(s.multiplyScalar(o))}return t}static nearestPower2(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.log(2)))}}c.Easing=a.a,c.fract=t=>t-Math.floor(t)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(25);function i(){r.a.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}i.prototype=Object.assign(Object.create(r.a.prototype),{constructor:i,isScene:!0,copy:function(t,e){return r.a.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=r.a.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},dispose:function(){this.dispatchEvent({type:"dispose"})}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2);const i={Vector2:n(12).a,Vector3:r.a},s={P:"position",N:"normal",Cd:"color"};class o{static remap_name(t){return s[t]||t}static array_to_indexed_arrays(t){const e={};let n=0;const r=[],i=[];let s=0;for(;s<t.length;){const o=t[s],a=e[o];null!=a?r.push(a):(i.push(o),r.push(n),e[o]=n,n+=1),s++}return{indices:r,values:i}}static default_value(t){switch(t){case 1:return 0;case 2:return new i.Vector2(0,0);case 3:return new i.Vector3(0,0,0);default:throw`size ${t} not yet implemented`}}}},function(t,e,n){var r=n(60),i=n(22),s=n(97),o=n(17);t.exports=function(t,e,n){if(!o(n))return!1;var a=typeof e;return!!("number"==a?i(n)&&s(e,n.length):"string"==a&&e in n)&&r(n[e],t)}},function(t,e,n){var r=n(106),i=n(108),s=n(305),o=n(306),a=n(109),_=n(33),u=/^\s+|\s+$/g;t.exports=function(t,e,n){if((t=_(t))&&(n||void 0===e))return t.replace(u,"");if(!t||!(e=r(e)))return t;var c=a(t),h=a(e),l=o(c,h),d=s(c,h)+1;return i(c,l,d).join("")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));class r{static unreachable(t){throw new Error("Didn't expect to get here")}}},function(t,e){t.exports=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}},function(t,e,n){var r=n(76);t.exports=function(t,e){return!!(null==t?0:t.length)&&r(t,e,0)>-1}},function(t,e){t.exports=function(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}},function(t,e,n){var r=n(9);t.exports=function(t){return r(t)&&t!=+t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));var r=n(58),i=n(39);class s extends i.b{set_content(t){super.set_content(t)}}var o=n(35),a=n(37);class _ extends r.b{constructor(){super(...arguments),this.container_controller=new a.a(this,s),this._eval_all_params_on_dirty_bound=this._eval_all_params_on_dirty.bind(this)}static node_context(){return o.a.EVENT}initialize_base_node(){this.io.connections.init_inputs(),this.ui_data.set_layout_horizontal(),this.add_post_dirty_hook("_eval_all_params_on_dirty",this._eval_all_params_on_dirty_bound)}node_sibbling(t){return super.node_sibbling(t)}_eval_all_params_on_dirty(){this.params.eval_all()}process_event(t,e,n){}}},function(t,e,n){var r=n(178);t.exports=function(t){var e=r(t),n=e%1;return e==e?n?e-n:e:0}},function(t,e,n){var r=n(323),i=n(53),s=n(84),o=n(124),a=s((function(t,e){return o(t)?r(t,i(e,1,o,!0)):[]}));t.exports=a},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(2),i=n(142),s=new r.a,o=new r.a,a=new r.a,_=new r.a,u=new r.a,c=new r.a,h=new r.a,l=new r.a,d=new r.a,p=new r.a;function f(t,e,n){this.a=void 0!==t?t:new r.a,this.b=void 0!==e?e:new r.a,this.c=void 0!==n?n:new r.a}Object.assign(f,{getNormal:function(t,e,n,i){void 0===i&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new r.a),i.subVectors(n,e),s.subVectors(t,e),i.cross(s);var o=i.lengthSq();return o>0?i.multiplyScalar(1/Math.sqrt(o)):i.set(0,0,0)},getBarycoord:function(t,e,n,i,_){s.subVectors(i,e),o.subVectors(n,e),a.subVectors(t,e);var u=s.dot(s),c=s.dot(o),h=s.dot(a),l=o.dot(o),d=o.dot(a),p=u*l-c*c;if(void 0===_&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),_=new r.a),0===p)return _.set(-2,-1,-1);var f=1/p,m=(l*h-c*d)*f,v=(u*d-c*h)*f;return _.set(1-m-v,v,m)},containsPoint:function(t,e,n,r){return f.getBarycoord(t,e,n,r,_),_.x>=0&&_.y>=0&&_.x+_.y<=1},getUV:function(t,e,n,r,i,s,o,a){return this.getBarycoord(t,e,n,r,_),a.set(0,0),a.addScaledVector(i,_.x),a.addScaledVector(s,_.y),a.addScaledVector(o,_.z),a},isFrontFacing:function(t,e,n,r){return s.subVectors(n,e),o.subVectors(t,e),s.cross(o).dot(r)<0}}),Object.assign(f.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return s.subVectors(this.c,this.b),o.subVectors(this.a,this.b),.5*s.cross(o).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new r.a),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return f.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new i.a),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return f.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,n,r,i){return f.getUV(t,this.a,this.b,this.c,e,n,r,i)},containsPoint:function(t){return f.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return f.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new r.a);var n,i,s=this.a,o=this.b,a=this.c;u.subVectors(o,s),c.subVectors(a,s),l.subVectors(t,s);var _=u.dot(l),f=c.dot(l);if(_<=0&&f<=0)return e.copy(s);d.subVectors(t,o);var m=u.dot(d),v=c.dot(d);if(m>=0&&v<=m)return e.copy(o);var g=_*v-m*f;if(g<=0&&_>=0&&m<=0)return n=_/(_-m),e.copy(s).addScaledVector(u,n);p.subVectors(t,a);var y=u.dot(p),x=c.dot(p);if(x>=0&&y<=x)return e.copy(a);var b=y*f-_*x;if(b<=0&&f>=0&&x<=0)return i=f/(f-x),e.copy(s).addScaledVector(c,i);var w=m*x-y*v;if(w<=0&&v-m>=0&&y-x>=0)return h.subVectors(a,o),i=(v-m)/(v-m+(y-x)),e.copy(o).addScaledVector(h,i);var k=1/(w+b+g);return n=b*k,i=g*k,e.copy(s).addScaledVector(u,n).addScaledVector(c,i)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));var r=n(1),i=n(14),s=n(6),o=n(0),a=n(8);class _ extends i.b{constructor(){super(...arguments),this._found_node=null}static type(){return o.a.OPERATOR_PATH}get default_value_serialized(){return this.default_value}get raw_input_serialized(){return`${this._raw_input}`}get value_serialized(){return`${this.value}`}static are_raw_input_equal(t,e){return t==e}static are_values_equal(t,e){return t==e}get is_default(){return this._value==this.default_value}process_raw_input(){this._value=this._raw_input,this.set_dirty(),this.emit_controller.emit(a.a.VALUE_UPDATED)}process_computation(){var t,e;return Object(r.a)(this,void 0,void 0,(function*(){const n=this._value;let r=null;if(null!=n&&""!==n&&(r=s.a.find_node(this.node,n)),this._found_node!==r){const n=this.options.dependent_on_found_node();if(this._found_node&&n&&this.remove_graph_input(this._found_node),this._found_node=r,r){const i=this.options.node_selection_context,s=null===(e=null===(t=r.parent)||void 0===t?void 0:t.children_controller)||void 0===e?void 0:e.context;i==s||null==i?n&&this.add_graph_input(r):this.states.error.set(`node context is ${i} but the params expects a ${s}`)}this.options.execute_callback()}this.remove_dirty_state()}))}found_node(){return this._found_node}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(21),i=n(2),s=n(29),o=n(10),a=new s.a,_=new r.a;function u(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||u.DefaultOrder}u.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],u.DefaultOrder="XYZ",Object.defineProperties(u.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(u.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=o.a.clamp,i=t.elements,s=i[0],a=i[4],_=i[8],u=i[1],c=i[5],h=i[9],l=i[2],d=i[6],p=i[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(_,-1,1)),Math.abs(_)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(d,c),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(_,p),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-l,s),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-l,p),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(u,s))):"ZYX"===e?(this._y=Math.asin(-r(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(u,s)):(this._x=0,this._z=Math.atan2(-a,c))):"YZX"===e?(this._z=Math.asin(r(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-l,s)):(this._x=0,this._y=Math.atan2(_,p))):"XZY"===e?(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(_,s)):(this._x=Math.atan2(-h,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,n){return a.makeRotationFromQuaternion(t),this.setFromRotationMatrix(a,e,n)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return _.setFromEuler(this),this.setFromQuaternion(_,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new i.a(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return L}));var r=n(9),i=n.n(r),s=n(66),o=n.n(s),a=n(5),_=n.n(a),u=n(43),c=n(0),h=n(15);class l extends u.a{static type(){return c.a.BOOLEAN}get default_value_serialized(){return _()(this.default_value)?this.default_value:this.convert(this.default_value)||!1}get raw_input_serialized(){return this._raw_input}get value_serialized(){return this.value}static are_raw_input_equal(t,e){return t==e}static are_values_equal(t,e){return t==e}convert(t){if(o()(t))return t;if(i()(t))return t>=1;if(_()(t)){if(h.a.is_boolean(t))return h.a.to_boolean(t);if(h.a.is_number(t)){return parseFloat(t)>=1}}return null}}var d=n(14);class p extends d.b{static type(){return c.a.BUTTON}get default_value_serialized(){return this.default_value}get raw_input_serialized(){return this._raw_input}get value_serialized(){return this.value}static are_raw_input_equal(t,e){return!0}static are_values_equal(t,e){return!0}press_button(){this.options.execute_callback()}}var f=n(20),m=n(3),v=n.n(m),g=n(24);const y=["r","g","b"];class x extends f.a{constructor(){super(...arguments),this._value=new g.a}static type(){return c.a.COLOR}static get component_names(){return y}get default_value_serialized(){return v()(this.default_value)?this.default_value:this.default_value.toArray()}get value_serialized(){return this.value.toArray()}_clone_raw_input(t){if(t instanceof g.a)return t.clone();return[t[0],t[1],t[2]]}static are_raw_input_equal(t,e){return t instanceof g.a?e instanceof g.a?t.equals(e):t.r==e[0]&&t.g==e[1]&&t.b==e[2]:e instanceof g.a?t[0]==e.r&&t[1]==e.g&&t[2]==e.b:t[0]==e[0]&&t[1]==e[1]&&t[2]==e[2]}static are_values_equal(t,e){return t.equals(e)}init_components(){super.init_components(),this.r=this.components[0],this.g=this.components[1],this.b=this.components[2]}set_value_from_components(){this._value.r=this.r.value,this._value.g=this.g.value,this._value.b=this.b.value}}var b=n(80);class w extends d.b{static type(){return c.a.FOLDER}get default_value_serialized(){return this.default_value}get raw_input_serialized(){return this._raw_input}get value_serialized(){return this.value}static are_raw_input_equal(t,e){return!0}static are_values_equal(t,e){return!0}}class k extends u.a{static type(){return c.a.INTEGER}get default_value_serialized(){return this.default_value}get raw_input_serialized(){return this.raw_input}get value_serialized(){return this.value}static are_raw_input_equal(t,e){return t==e}static are_values_equal(t,e){return t==e}static convert(t){if(i()(t))return Math.round(t);if(h.a.is_number(t)){const e=parseInt(t);if(i()(e))return e}return null}convert(t){const e=k.convert(t);return e?this.options.ensure_in_range(e):e}}var E=n(139),M=n(28);class O extends d.b{static type(){return c.a.SEPARATOR}get default_value_serialized(){return this.default_value}get raw_input_serialized(){return this._raw_input}get value_serialized(){return this.value}static are_raw_input_equal(t,e){return!0}static are_values_equal(t,e){return!0}}var j=n(67),A=n(12);const z=["x","y"];class T extends f.a{constructor(){super(...arguments),this._value=new A.a}static type(){return c.a.VECTOR2}static get component_names(){return z}get default_value_serialized(){return v()(this.default_value)?this.default_value:this.default_value.toArray()}get value_serialized(){return this.value.toArray()}_clone_raw_input(t){if(t instanceof A.a)return t.clone();return[t[0],t[1]]}static are_raw_input_equal(t,e){return t instanceof A.a?e instanceof A.a?t.equals(e):t.x==e[0]&&t.y==e[1]:e instanceof A.a?t[0]==e.x&&t[1]==e.y:t[0]==e[0]&&t[1]==e[1]}static are_values_equal(t,e){return t.equals(e)}init_components(){super.init_components(),this.x=this.components[0],this.y=this.components[1]}set_value_from_components(){this._value.x=this.x.value,this._value.y=this.y.value}}var S=n(2);const P=["x","y","z"];class R extends f.a{constructor(){super(...arguments),this._value=new S.a}static type(){return c.a.VECTOR3}static get component_names(){return P}get default_value_serialized(){return v()(this.default_value)?this.default_value:this.default_value.toArray()}get value_serialized(){return this.value.toArray()}_clone_raw_input(t){if(t instanceof S.a)return t.clone();return[t[0],t[1],t[2]]}static are_raw_input_equal(t,e){return t instanceof S.a?e instanceof S.a?t.equals(e):t.x==e[0]&&t.y==e[1]&&t.z==e[2]:e instanceof S.a?t[0]==e.x&&t[1]==e.y&&t[2]==e.z:t[0]==e[0]&&t[1]==e[1]&&t[2]==e[2]}static are_values_equal(t,e){return t.equals(e)}init_components(){super.init_components(),this.x=this.components[0],this.y=this.components[1],this.z=this.components[2]}set_value_from_components(){this._value.x=this.x.value,this._value.y=this.y.value,this._value.z=this.z.value}}var C=n(36);const q=["x","y","z","w"];class D extends f.a{constructor(){super(...arguments),this._value=new C.a}static type(){return c.a.VECTOR4}static get component_names(){return q}get default_value_serialized(){return v()(this.default_value)?this.default_value:this.default_value.toArray()}get value_serialized(){return this.value.toArray()}_clone_raw_input(t){if(t instanceof C.a)return t.clone();return[t[0],t[1],t[2],t[3]]}static are_raw_input_equal(t,e){return t instanceof C.a?e instanceof C.a?t.equals(e):t.x==e[0]&&t.y==e[1]&&t.z==e[2]&&t.w==e[3]:e instanceof C.a?t[0]==e.x&&t[1]==e.y&&t[2]==e.z&&t[3]==e.w:t[0]==e[0]&&t[1]==e[1]&&t[2]==e[2]&&t[3]==e[3]}static are_values_equal(t,e){return t.equals(e)}init_components(){super.init_components(),this.x=this.components[0],this.y=this.components[1],this.z=this.components[2],this.w=this.components[3]}set_value_from_components(){this._value.x=this.x.value,this._value.y=this.y.value,this._value.z=this.z.value,this._value.w=this.w.value}}const L={[c.a.BOOLEAN]:l,[c.a.BUTTON]:p,[c.a.COLOR]:x,[c.a.FLOAT]:b.a,[c.a.FOLDER]:w,[c.a.INTEGER]:k,[c.a.OPERATOR_PATH]:E.a,[c.a.RAMP]:M.a,[c.a.SEPARATOR]:O,[c.a.STRING]:j.a,[c.a.VECTOR2]:T,[c.a.VECTOR3]:R,[c.a.VECTOR4]:D}},function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));var r=n(38),i=n(2),s=new i.a,o=new i.a,a=new r.a;function _(t,e){this.normal=void 0!==t?t:new i.a(1,0,0),this.constant=void 0!==e?e:0}Object.assign(_.prototype,{isPlane:!0,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(t,e,n){var r=s.subVectors(n,e).cross(o.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new i.a),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new i.a);var n=t.delta(s),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;var o=-(t.start.dot(this.normal)+this.constant)/r;return o<0||o>1?void 0:e.copy(n).multiplyScalar(o).add(t.start)},intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new i.a),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,e){var n=e||a.getNormalMatrix(t),r=this.coplanarPoint(s).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1);const i=Object.getPrototypeOf((function(){return Object(r.a)(this,void 0,void 0,(function*(){}))})).constructor},function(t,e,n){"use strict";function r(){this.mask=1}n.d(e,"a",(function(){return r})),Object.assign(r.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}})},function(t,e,n){var r=n(85),i=n(95),s=n(148),o=n(222),a=n(227),_=n(184),u=n(131),c=n(230),h=n(231),l=n(155),d=n(232),p=n(41),f=n(236),m=n(237),v=n(186),g=n(3),y=n(48),x=n(241),b=n(17),w=n(243),k=n(23),E={};E["[object Arguments]"]=E["[object Array]"]=E["[object ArrayBuffer]"]=E["[object DataView]"]=E["[object Boolean]"]=E["[object Date]"]=E["[object Float32Array]"]=E["[object Float64Array]"]=E["[object Int8Array]"]=E["[object Int16Array]"]=E["[object Int32Array]"]=E["[object Map]"]=E["[object Number]"]=E["[object Object]"]=E["[object RegExp]"]=E["[object Set]"]=E["[object String]"]=E["[object Symbol]"]=E["[object Uint8Array]"]=E["[object Uint8ClampedArray]"]=E["[object Uint16Array]"]=E["[object Uint32Array]"]=!0,E["[object Error]"]=E["[object Function]"]=E["[object WeakMap]"]=!1,t.exports=function t(e,n,M,O,j,A){var z,T=1&n,S=2&n,P=4&n;if(M&&(z=j?M(e,O,j,A):M(e)),void 0!==z)return z;if(!b(e))return e;var R=g(e);if(R){if(z=f(e),!T)return u(e,z)}else{var C=p(e),q="[object Function]"==C||"[object GeneratorFunction]"==C;if(y(e))return _(e,T);if("[object Object]"==C||"[object Arguments]"==C||q&&!j){if(z=S||q?{}:v(e),!T)return S?h(e,a(z,e)):c(e,o(z,e))}else{if(!E[C])return j?e:{};z=m(e,C,T)}}A||(A=new r);var D=A.get(e);if(D)return D;A.set(e,z),w(e)?e.forEach((function(r){z.add(t(r,n,M,r,e,A))})):x(e)&&e.forEach((function(r,i){z.set(i,t(r,n,M,i,e,A))}));var L=P?S?d:l:S?keysIn:k,N=R?void 0:L(e);return i(N||e,(function(r,i){N&&(r=e[i=r]),s(z,i,t(r,n,M,i,e,A))})),z}},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(188))},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e,n){var r=n(86),i=n(60),s=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var o=t[e];s.call(t,e)&&i(o,n)&&(void 0!==n||e in t)||r(t,e,n)}},function(t,e,n){var r=n(32),i=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=i},function(t,e,n){var r=n(189),i=n(63),s=n(3),o=n(48),a=n(97),_=n(64),u=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=s(t),c=!n&&i(t),h=!n&&!c&&o(t),l=!n&&!c&&!h&&_(t),d=n||c||h||l,p=d?r(t.length,String):[],f=p.length;for(var m in t)!e&&!u.call(t,m)||d&&("length"==m||h&&("offset"==m||"parent"==m)||l&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||a(m,f))||p.push(m);return p}},function(t,e){t.exports=function(t,e){return function(n){return t(e(n))}}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,s=[];++n<r;){var o=t[n];e(o,n,t)&&(s[i++]=o)}return s}},function(t,e){t.exports=function(){return[]}},function(t,e,n){var r=n(73),i=n(87),s=n(101),o=n(153),a=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)r(e,s(t)),t=i(t);return e}:o;t.exports=a},function(t,e,n){var r=n(156),i=n(101),s=n(23);t.exports=function(t){return r(t,s,i)}},function(t,e,n){var r=n(73),i=n(3);t.exports=function(t,e,n){var s=e(t);return i(t)?s:r(s,n(t))}},function(t,e,n){var r=n(32)(n(19),"Set");t.exports=r},function(t,e,n){var r=n(19).Uint8Array;t.exports=r},function(t,e,n){var r=n(17),i=Object.create,s=function(){function t(){}return function(e){if(!r(e))return{};if(i)return i(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();t.exports=s},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e,n){var r=n(187),i=n(23);t.exports=function(t,e){return t&&r(t,e,i)}},function(t,e,n){var r=n(88),i=n(255),s=n(89);t.exports=function(t,e,n,o,a,_){var u=1&n,c=t.length,h=e.length;if(c!=h&&!(u&&h>c))return!1;var l=_.get(t);if(l&&_.get(e))return l==e;var d=-1,p=!0,f=2&n?new r:void 0;for(_.set(t,e),_.set(e,t);++d<c;){var m=t[d],v=e[d];if(o)var g=u?o(v,m,d,e,t,_):o(m,v,d,t,e,_);if(void 0!==g){if(g)continue;p=!1;break}if(f){if(!i(e,(function(t,e){if(!s(f,e)&&(m===t||a(m,t,n,o,_)))return f.push(e)}))){p=!1;break}}else if(m!==v&&!a(m,v,n,o,_)){p=!1;break}}return _.delete(t),_.delete(e),p}},function(t,e,n){var r=n(17);t.exports=function(t){return t==t&&!r(t)}},function(t,e){t.exports=function(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}},function(t,e,n){var r=n(166),i=n(74);t.exports=function(t,e){for(var n=0,s=(e=r(e,t)).length;null!=t&&n<s;)t=t[i(e[n++])];return n&&n==s?t:void 0}},function(t,e,n){var r=n(3),i=n(105),s=n(262),o=n(33);t.exports=function(t,e){return r(t)?t:i(t,e)?[t]:s(o(t))}},function(t,e,n){var r=n(166),i=n(63),s=n(3),o=n(97),a=n(98),_=n(74);t.exports=function(t,e,n){for(var u=-1,c=(e=r(e,t)).length,h=!1;++u<c;){var l=_(e[u]);if(!(h=null!=t&&n(t,l)))break;t=t[l]}return h||++u!=c?h:!!(c=null==t?0:t.length)&&a(c)&&o(l,c)&&(s(t)||i(t))}},function(t,e){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},function(t,e,n){var r=n(52),i=n(22);t.exports=function(t,e){var n=-1,s=i(t)?Array(t.length):[];return r(t,(function(t,r,i){s[++n]=e(t,r,i)})),s}},function(t,e){t.exports=function(t,e,n,r){var i=-1,s=null==t?0:t.length;for(r&&s&&(n=t[++i]);++i<s;)n=e(n,t[i],i,t);return n}},function(t,e,n){var r=n(88),i=n(132),s=n(133),o=n(89),a=n(288),_=n(104);t.exports=function(t,e,n){var u=-1,c=i,h=t.length,l=!0,d=[],p=d;if(n)l=!1,c=s;else if(h>=200){var f=e?null:a(t);if(f)return _(f);l=!1,c=o,p=new r}else p=e?[]:d;t:for(;++u<h;){var m=t[u],v=e?e(m):m;if(m=n||0!==m?m:0,l&&v==v){for(var g=p.length;g--;)if(p[g]===v)continue t;e&&p.push(v),d.push(m)}else c(p,v,n)||(p!==d&&p.push(v),d.push(m))}return d}},function(t,e,n){var r=n(16),i=n(173);t.exports=function(t,e,n,r){return function(t,e,n,r){var s,o,a={},_=new i,u=function(t){var e=t.v!==s?t.v:t.w,r=a[e],i=n(t),u=o.distance+i;if(i<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+i);u<r.distance&&(r.distance=u,r.predecessor=s,_.decrease(e,u))};t.nodes().forEach((function(t){var n=t===e?0:Number.POSITIVE_INFINITY;a[t]={distance:n},_.add(t,n)}));for(;_.size()>0&&(s=_.removeMin(),(o=a[s]).distance!==Number.POSITIVE_INFINITY);)r(s).forEach(u);return a}(t,String(e),n||s,r||function(e){return t.outEdges(e)})};var s=r.constant(1)},function(t,e,n){var r=n(16);function i(){this._arr=[],this._keyIndices={}}t.exports=i,i.prototype.size=function(){return this._arr.length},i.prototype.keys=function(){return this._arr.map((function(t){return t.key}))},i.prototype.has=function(t){return r.has(this._keyIndices,t)},i.prototype.priority=function(t){var e=this._keyIndices[t];if(void 0!==e)return this._arr[e].priority},i.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},i.prototype.add=function(t,e){var n=this._keyIndices;if(t=String(t),!r.has(n,t)){var i=this._arr,s=i.length;return n[t]=s,i.push({key:t,priority:e}),this._decrease(s),!0}return!1},i.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},i.prototype.decrease=function(t,e){var n=this._keyIndices[t];if(e>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[n].priority+" New: "+e);this._arr[n].priority=e,this._decrease(n)},i.prototype._heapify=function(t){var e=this._arr,n=2*t,r=n+1,i=t;n<e.length&&(i=e[n].priority<e[i].priority?n:i,r<e.length&&(i=e[r].priority<e[i].priority?r:i),i!==t&&(this._swap(t,i),this._heapify(i)))},i.prototype._decrease=function(t){for(var e,n=this._arr,r=n[t].priority;0!==t&&!(n[e=t>>1].priority<r);)this._swap(t,e),t=e},i.prototype._swap=function(t,e){var n=this._arr,r=this._keyIndices,i=n[t],s=n[e];n[t]=s,n[e]=i,r[s.key]=t,r[i.key]=e}},function(t,e,n){var r=n(16);t.exports=function(t){var e=0,n=[],i={},s=[];return t.nodes().forEach((function(o){r.has(i,o)||function o(a){var _=i[a]={onStack:!0,lowlink:e,index:e++};if(n.push(a),t.successors(a).forEach((function(t){r.has(i,t)?i[t].onStack&&(_.lowlink=Math.min(_.lowlink,i[t].index)):(o(t),_.lowlink=Math.min(_.lowlink,i[t].lowlink))})),_.lowlink===_.index){var u,c=[];do{u=n.pop(),i[u].onStack=!1,c.push(u)}while(a!==u);s.push(c)}}(o)})),s}},function(t,e,n){var r=n(16);function i(t){var e={},n={},i=[];if(r.each(t.sinks(),(function o(a){if(r.has(n,a))throw new s;r.has(e,a)||(n[a]=!0,e[a]=!0,r.each(t.predecessors(a),o),delete n[a],i.push(a))})),r.size(e)!==t.nodeCount())throw new s;return i}function s(){}t.exports=i,i.CycleException=s,s.prototype=new Error},function(t,e,n){var r=n(16);t.exports=function(t,e,n){r.isArray(e)||(e=[e]);var i=(t.isDirected()?t.successors:t.neighbors).bind(t),s=[],o={};return r.each(e,(function(e){if(!t.hasNode(e))throw new Error("Graph does not have node: "+e);!function t(e,n,i,s,o,a){r.has(s,n)||(s[n]=!0,i||a.push(n),r.each(o(n),(function(n){t(e,n,i,s,o,a)})),i&&a.push(n))}(t,e,"post"===n,o,i,s)})),s}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(135),i=n(118),s=n(45),o=n(82),a=n(44);class _ extends a.a{constructor(){super(...arguments),this.active=a.b.BOOLEAN(!0,{callback:(t,e)=>{c.PARAM_CALLBACK_toggle_active(t)}})}}const u=new _;class c extends r.a{constructor(){super(...arguments),this.params_config=u}static type(){return"mouse_event"}initialize_node(){this.io.outputs.set_named_output_connection_points(o.a.map(t=>new i.a(t,s.c.BOOL))),this.lifecycle.add_on_add_hook(()=>{this.scene.events_controller.register_event_node(this)}),this.lifecycle.add_delete_hook(()=>{this.scene.events_controller.unregister_event_node(this)})}process_event(t,e,n){if(!this.pv.active)return;const r=this.io.outputs.get_output_index(t.type);if(r>=0){const i=this.io.connections.output_connections().filter(t=>t.output_index==r).map(t=>t.node_dest);for(let r of i)r.process_event(t,e,n)}}_update_register(){this.pv.active?this.scene.events_controller.register_event_node(this):this.scene.events_controller.unregister_event_node(this)}static PARAM_CALLBACK_toggle_active(t){t._update_register()}}},function(t,e,n){var r=n(304);t.exports=function(t){return t?(t=r(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}},function(t,e,n){var r=n(170),i=n(312),s=n(315),o=RegExp("['’]","g");t.exports=function(t){return function(e){return r(s(i(e).replace(o,"")),t,"")}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(4),i=n(90);function s(t,e,n,r){i.a.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}s.prototype=Object.assign(Object.create(i.a.prototype),{constructor:s,DefaultSettings_:{endingStart:r.fd,endingEnd:r.fd},intervalChanged_:function(t,e,n){var i=this.parameterPositions,s=t-2,o=t+1,a=i[s],_=i[o];if(void 0===a)switch(this.getSettings_().endingStart){case r.hd:s=t,a=2*e-n;break;case r.ed:a=e+i[s=i.length-2]-i[s+1];break;default:s=t,a=n}if(void 0===_)switch(this.getSettings_().endingEnd){case r.hd:o=t,_=2*n-e;break;case r.ed:o=1,_=n+i[1]-i[0];break;default:o=t-1,_=e}var u=.5*(n-e),c=this.valueSize;this._weightPrev=u/(e-a),this._weightNext=u/(_-n),this._offsetPrev=s*c,this._offsetNext=o*c},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,_=a-o,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,l=this._weightNext,d=(n-e)/(r-e),p=d*d,f=p*d,m=-h*f+2*h*p-h*d,v=(1+h)*f+(-1.5-2*h)*p+(-.5+h)*d+1,g=(-1-l)*f+(1.5+l)*p+.5*d,y=l*f-l*p,x=0;x!==o;++x)i[x]=m*s[u+x]+v*s[_+x]+g*s[a+x]+y*s[c+x];return i}})},function(t,e,n){var r=n(73),i=n(53),s=n(131),o=n(3);t.exports=function(){var t=arguments.length;if(!t)return[];for(var e=Array(t-1),n=arguments[0],a=t;a--;)e[a-1]=arguments[a];return r(o(n)?s(n):[n],i(e,1))}},function(t,e,n){var r=n(179)((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}));t.exports=r},function(t,e,n){var r=n(86),i=n(324),s=Object.prototype.hasOwnProperty,o=i((function(t,e,n){s.call(t,n)?t[n].push(e):r(t,n,[e])}));t.exports=o},function(t,e,n){(function(t){var r=n(19),i=e&&!e.nodeType&&e,s=i&&"object"==typeof t&&t&&!t.nodeType&&t,o=s&&s.exports===i?r.Buffer:void 0,a=o?o.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,r=a?a(n):new t.constructor(n);return t.copy(r),r}}).call(this,n(96)(t))},function(t,e,n){var r=n(102);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},function(t,e,n){var r=n(159),i=n(87),s=n(72);t.exports=function(t){return"function"!=typeof t.constructor||s(t)?{}:r(i(t))}},function(t,e,n){var r=n(246)();t.exports=r},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},function(t,e,n){var r=n(50);t.exports=function(t){return"function"==typeof t?t:r}},function(t,e,n){var r=n(46),i=n(42),s=n(169),o=n(3);t.exports=function(t,e){return(o(t)?r:s)(t,i(e,3))}},function(t,e){t.exports=function(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=t[r+e];return s}},function(t,e,n){t.exports={Graph:n(92),version:n(291)}},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var r=n(69),i=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0)&&(n==e.length-1?e.pop():i.call(e,n,1),--this.size,!0)}},function(t,e,n){var r=n(69);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var r=n(69);t.exports=function(t){return r(this.__data__,t)>-1}},function(t,e,n){var r=n(69);t.exports=function(t,e){var n=this.__data__,i=r(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}},function(t,e,n){var r=n(68);t.exports=function(){this.__data__=new r,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){var r=n(68),i=n(93),s=n(94);t.exports=function(t,e){var n=this.__data__;if(n instanceof r){var o=n.__data__;if(!i||o.length<199)return o.push([t,e]),this.size=++n.size,this;n=this.__data__=new s(o)}return n.set(t,e),this.size=n.size,this}},function(t,e,n){var r=n(61),i=n(207),s=n(17),o=n(147),a=/^\[object .+?Constructor\]$/,_=Function.prototype,u=Object.prototype,c=_.toString,h=u.hasOwnProperty,l=RegExp("^"+c.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!s(t)||i(t))&&(r(t)?l:a).test(o(t))}},function(t,e,n){var r=n(40),i=Object.prototype,s=i.hasOwnProperty,o=i.toString,a=r?r.toStringTag:void 0;t.exports=function(t){var e=s.call(t,a),n=t[a];try{t[a]=void 0;var r=!0}catch(t){}var i=o.call(t);return r&&(e?t[a]=n:delete t[a]),i}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e,n){var r,i=n(208),s=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!s&&s in t}},function(t,e,n){var r=n(19)["__core-js_shared__"];t.exports=r},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,n){var r=n(211),i=n(68),s=n(93);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(s||i),string:new r}}},function(t,e,n){var r=n(212),i=n(213),s=n(214),o=n(215),a=n(216);function _(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}_.prototype.clear=r,_.prototype.delete=i,_.prototype.get=s,_.prototype.has=o,_.prototype.set=a,t.exports=_},function(t,e,n){var r=n(70);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,n){var r=n(70),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(e,t)?e[t]:void 0}},function(t,e,n){var r=n(70),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:i.call(e,t)}},function(t,e,n){var r=n(70);t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},function(t,e,n){var r=n(71);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){var r=n(71);t.exports=function(t){return r(this,t).get(t)}},function(t,e,n){var r=n(71);t.exports=function(t){return r(this,t).has(t)}},function(t,e,n){var r=n(71);t.exports=function(t,e){var n=r(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}},function(t,e,n){var r=n(62),i=n(23);t.exports=function(t,e){return t&&r(e,i(e),t)}},function(t,e,n){var r=n(26),i=n(18);t.exports=function(t){return i(t)&&"[object Arguments]"==r(t)}},function(t,e){t.exports=function(){return!1}},function(t,e,n){var r=n(26),i=n(98),s=n(18),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,t.exports=function(t){return s(t)&&i(t.length)&&!!o[r(t)]}},function(t,e,n){var r=n(151)(Object.keys,Object);t.exports=r},function(t,e,n){var r=n(62),i=n(123);t.exports=function(t,e){return t&&r(e,i(e),t)}},function(t,e,n){var r=n(17),i=n(72),s=n(229),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return s(t);var e=i(t),n=[];for(var a in t)("constructor"!=a||!e&&o.call(t,a))&&n.push(a);return n}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},function(t,e,n){var r=n(62),i=n(101);t.exports=function(t,e){return r(t,i(t),e)}},function(t,e,n){var r=n(62),i=n(154);t.exports=function(t,e){return r(t,i(t),e)}},function(t,e,n){var r=n(156),i=n(154),s=n(123);t.exports=function(t){return r(t,s,i)}},function(t,e,n){var r=n(32)(n(19),"DataView");t.exports=r},function(t,e,n){var r=n(32)(n(19),"Promise");t.exports=r},function(t,e,n){var r=n(32)(n(19),"WeakMap");t.exports=r},function(t,e){var n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&n.call(t,"index")&&(r.index=t.index,r.input=t.input),r}},function(t,e,n){var r=n(102),i=n(238),s=n(239),o=n(240),a=n(185);t.exports=function(t,e,n){var _=t.constructor;switch(e){case"[object ArrayBuffer]":return r(t);case"[object Boolean]":case"[object Date]":return new _(+t);case"[object DataView]":return i(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(t,n);case"[object Map]":return new _;case"[object Number]":case"[object String]":return new _(t);case"[object RegExp]":return s(t);case"[object Set]":return new _;case"[object Symbol]":return o(t)}}},function(t,e,n){var r=n(102);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}},function(t,e){var n=/\w*$/;t.exports=function(t){var e=new t.constructor(t.source,n.exec(t));return e.lastIndex=t.lastIndex,e}},function(t,e,n){var r=n(40),i=r?r.prototype:void 0,s=i?i.valueOf:void 0;t.exports=function(t){return s?Object(s.call(t)):{}}},function(t,e,n){var r=n(242),i=n(49),s=n(99),o=s&&s.isMap,a=o?i(o):r;t.exports=a},function(t,e,n){var r=n(41),i=n(18);t.exports=function(t){return i(t)&&"[object Map]"==r(t)}},function(t,e,n){var r=n(244),i=n(49),s=n(99),o=s&&s.isSet,a=o?i(o):r;t.exports=a},function(t,e,n){var r=n(41),i=n(18);t.exports=function(t){return i(t)&&"[object Set]"==r(t)}},function(t,e,n){var r=n(95),i=n(52),s=n(190),o=n(3);t.exports=function(t,e){return(o(t)?r:i)(t,s(e))}},function(t,e){t.exports=function(t){return function(e,n,r){for(var i=-1,s=Object(e),o=r(e),a=o.length;a--;){var _=o[t?a:++i];if(!1===n(s[_],_,s))break}return e}}},function(t,e,n){var r=n(22);t.exports=function(t,e){return function(n,i){if(null==n)return n;if(!r(n))return t(n,i);for(var s=n.length,o=e?s:-1,a=Object(n);(e?o--:++o<s)&&!1!==i(a[o],o,a););return n}}},function(t,e,n){var r=n(152),i=n(249),s=n(42),o=n(3);t.exports=function(t,e){return(o(t)?r:i)(t,s(e,3))}},function(t,e,n){var r=n(52);t.exports=function(t,e){var n=[];return r(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n}},function(t,e,n){var r=n(251),i=n(259),s=n(164);t.exports=function(t){var e=i(t);return 1==e.length&&e[0][2]?s(e[0][0],e[0][1]):function(n){return n===t||r(n,t,e)}}},function(t,e,n){var r=n(85),i=n(103);t.exports=function(t,e,n,s){var o=n.length,a=o,_=!s;if(null==t)return!a;for(t=Object(t);o--;){var u=n[o];if(_&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++o<a;){var c=(u=n[o])[0],h=t[c],l=u[1];if(_&&u[2]){if(void 0===h&&!(c in t))return!1}else{var d=new r;if(s)var p=s(h,l,c,t,e,d);if(!(void 0===p?i(l,h,3,s,d):p))return!1}}return!0}},function(t,e,n){var r=n(85),i=n(162),s=n(256),o=n(258),a=n(41),_=n(3),u=n(48),c=n(64),h="[object Object]",l=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,d,p,f){var m=_(t),v=_(e),g=m?"[object Array]":a(t),y=v?"[object Array]":a(e),x=(g="[object Arguments]"==g?h:g)==h,b=(y="[object Arguments]"==y?h:y)==h,w=g==y;if(w&&u(t)){if(!u(e))return!1;m=!0,x=!1}if(w&&!x)return f||(f=new r),m||c(t)?i(t,e,n,d,p,f):s(t,e,g,n,d,p,f);if(!(1&n)){var k=x&&l.call(t,"__wrapped__"),E=b&&l.call(e,"__wrapped__");if(k||E){var M=k?t.value():t,O=E?e.value():e;return f||(f=new r),p(M,O,n,d,f)}}return!!w&&(f||(f=new r),o(t,e,n,d,p,f))}},function(t,e){t.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},function(t,e,n){var r=n(40),i=n(158),s=n(60),o=n(162),a=n(257),_=n(104),u=r?r.prototype:void 0,c=u?u.valueOf:void 0;t.exports=function(t,e,n,r,u,h,l){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!h(new i(t),new i(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return s(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var d=a;case"[object Set]":var p=1&r;if(d||(d=_),t.size!=e.size&&!p)return!1;var f=l.get(t);if(f)return f==e;r|=2,l.set(t,e);var m=o(d(t),d(e),r,u,h,l);return l.delete(t),m;case"[object Symbol]":if(c)return c.call(t)==c.call(e)}return!1}},function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}},function(t,e,n){var r=n(155),i=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,s,o,a){var _=1&n,u=r(t),c=u.length;if(c!=r(e).length&&!_)return!1;for(var h=c;h--;){var l=u[h];if(!(_?l in e:i.call(e,l)))return!1}var d=a.get(t);if(d&&a.get(e))return d==e;var p=!0;a.set(t,e),a.set(e,t);for(var f=_;++h<c;){var m=t[l=u[h]],v=e[l];if(s)var g=_?s(v,m,l,e,t,a):s(m,v,l,t,e,a);if(!(void 0===g?m===v||o(m,v,n,s,a):g)){p=!1;break}f||(f="constructor"==l)}if(p&&!f){var y=t.constructor,x=e.constructor;y!=x&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof x&&x instanceof x)&&(p=!1)}return a.delete(t),a.delete(e),p}},function(t,e,n){var r=n(163),i=n(23);t.exports=function(t){for(var e=i(t),n=e.length;n--;){var s=e[n],o=t[s];e[n]=[s,o,r(o)]}return e}},function(t,e,n){var r=n(103),i=n(261),s=n(265),o=n(105),a=n(163),_=n(164),u=n(74);t.exports=function(t,e){return o(t)&&a(e)?_(u(t),e):function(n){var o=i(n,t);return void 0===o&&o===e?s(n,t):r(e,o,3)}}},function(t,e,n){var r=n(165);t.exports=function(t,e,n){var i=null==t?void 0:r(t,e);return void 0===i?n:i}},function(t,e,n){var r=n(263),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,o=r((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(i,(function(t,n,r,i){e.push(r?i.replace(s,"$1"):n||t)})),e}));t.exports=o},function(t,e,n){var r=n(264);t.exports=function(t){var e=r(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}},function(t,e,n){var r=n(94);function i(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var o=t.apply(this,r);return n.cache=s.set(i,o)||s,o};return n.cache=new(i.Cache||r),n}i.Cache=r,t.exports=i},function(t,e,n){var r=n(266),i=n(167);t.exports=function(t,e){return null!=t&&i(t,e,r)}},function(t,e){t.exports=function(t,e){return null!=t&&e in Object(t)}},function(t,e,n){var r=n(168),i=n(268),s=n(105),o=n(74);t.exports=function(t){return s(t)?r(o(t)):i(t)}},function(t,e,n){var r=n(165);t.exports=function(t){return function(e){return r(e,t)}}},function(t,e,n){var r=n(270),i=n(167);t.exports=function(t,e){return null!=t&&i(t,e,r)}},function(t,e){var n=Object.prototype.hasOwnProperty;t.exports=function(t,e){return null!=t&&n.call(t,e)}},function(t,e,n){var r=n(100),i=n(41),s=n(63),o=n(3),a=n(22),_=n(48),u=n(72),c=n(64),h=Object.prototype.hasOwnProperty;t.exports=function(t){if(null==t)return!0;if(a(t)&&(o(t)||"string"==typeof t||"function"==typeof t.splice||_(t)||c(t)||s(t)))return!t.length;var e=i(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(u(t))return!r(t).length;for(var n in t)if(h.call(t,n))return!1;return!0}},function(t,e){t.exports=function(t){return void 0===t}},function(t,e,n){var r=n(170),i=n(52),s=n(42),o=n(274),a=n(3);t.exports=function(t,e,n){var _=a(t)?r:o,u=arguments.length<3;return _(t,s(e,4),n,u,i)}},function(t,e){t.exports=function(t,e,n,r,i){return i(t,(function(t,i,s){n=r?(r=!1,t):e(n,t,i,s)})),n}},function(t,e,n){var r=n(100),i=n(41),s=n(22),o=n(5),a=n(107);t.exports=function(t){if(null==t)return 0;if(s(t))return o(t)?a(t):t.length;var e=i(t);return"[object Map]"==e||"[object Set]"==e?t.size:r(t).length}},function(t,e,n){var r=n(168)("length");t.exports=r},function(t,e){var n="[\\ud800-\\udfff]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",s="[^\\ud800-\\udfff]",o="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",_="(?:"+r+"|"+i+")"+"?",u="[\\ufe0e\\ufe0f]?"+_+("(?:\\u200d(?:"+[s,o,a].join("|")+")[\\ufe0e\\ufe0f]?"+_+")*"),c="(?:"+[s+r+"?",r,o,a,n].join("|")+")",h=RegExp(i+"(?="+i+")|"+c+u,"g");t.exports=function(t){for(var e=h.lastIndex=0;h.test(t);)++e;return e}},function(t,e,n){var r=n(95),i=n(159),s=n(161),o=n(42),a=n(87),_=n(3),u=n(48),c=n(61),h=n(17),l=n(64);t.exports=function(t,e,n){var d=_(t),p=d||u(t)||l(t);if(e=o(e,4),null==n){var f=t&&t.constructor;n=p?d?new f:[]:h(t)&&c(f)?i(a(t)):{}}return(p?r:s)(t,(function(t,r,i){return e(n,t,r,i)})),n}},function(t,e,n){var r=n(40),i=n(63),s=n(3),o=r?r.isConcatSpreadable:void 0;t.exports=function(t){return s(t)||i(t)||!!(o&&t&&t[o])}},function(t,e,n){var r=n(281),i=Math.max;t.exports=function(t,e,n){return e=i(void 0===e?t.length-1:e,0),function(){for(var s=arguments,o=-1,a=i(s.length-e,0),_=Array(a);++o<a;)_[o]=s[e+o];o=-1;for(var u=Array(e+1);++o<e;)u[o]=s[o];return u[e]=n(_),r(t,this,u)}}},function(t,e){t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},function(t,e,n){var r=n(283),i=n(284)(r);t.exports=i},function(t,e,n){var r=n(160),i=n(149),s=n(50),o=i?function(t,e){return i(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:s;t.exports=o},function(t,e){var n=Date.now;t.exports=function(t){var e=0,r=0;return function(){var i=n(),s=16-(i-r);if(r=i,s>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e){t.exports=function(t,e,n,r){for(var i=t.length,s=n+(r?1:-1);r?s--:++s<i;)if(e(t[s],s,t))return s;return-1}},function(t,e){t.exports=function(t){return t!=t}},function(t,e){t.exports=function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}},function(t,e,n){var r=n(157),i=n(289),s=n(104),o=r&&1/s(new r([,-0]))[1]==1/0?function(t){return new r(t)}:i;t.exports=o},function(t,e){t.exports=function(){}},function(t,e,n){var r=n(46);t.exports=function(t,e){return r(e,(function(e){return t[e]}))}},function(t,e){t.exports="2.1.9-pre"},function(t,e,n){var r=n(16),i=n(92);function s(t){return r.map(t.nodes(),(function(e){var n=t.node(e),i=t.parent(e),s={v:e};return r.isUndefined(n)||(s.value=n),r.isUndefined(i)||(s.parent=i),s}))}function o(t){return r.map(t.edges(),(function(e){var n=t.edge(e),i={v:e.v,w:e.w};return r.isUndefined(e.name)||(i.name=e.name),r.isUndefined(n)||(i.value=n),i}))}t.exports={write:function(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:s(t),edges:o(t)};r.isUndefined(t.graph())||(e.value=r.clone(t.graph()));return e},read:function(t){var e=new i(t.options).setGraph(t.value);return r.each(t.nodes,(function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)})),r.each(t.edges,(function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)})),e}}},function(t,e,n){t.exports={components:n(294),dijkstra:n(172),dijkstraAll:n(295),findCycles:n(296),floydWarshall:n(297),isAcyclic:n(298),postorder:n(299),preorder:n(300),prim:n(301),tarjan:n(174),topsort:n(175)}},function(t,e,n){var r=n(16);t.exports=function(t){var e,n={},i=[];function s(i){r.has(n,i)||(n[i]=!0,e.push(i),r.each(t.successors(i),s),r.each(t.predecessors(i),s))}return r.each(t.nodes(),(function(t){e=[],s(t),e.length&&i.push(e)})),i}},function(t,e,n){var r=n(172),i=n(16);t.exports=function(t,e,n){return i.transform(t.nodes(),(function(i,s){i[s]=r(t,s,e,n)}),{})}},function(t,e,n){var r=n(16),i=n(174);t.exports=function(t){return r.filter(i(t),(function(e){return e.length>1||1===e.length&&t.hasEdge(e[0],e[0])}))}},function(t,e,n){var r=n(16);t.exports=function(t,e,n){return function(t,e,n){var r={},i=t.nodes();return i.forEach((function(t){r[t]={},r[t][t]={distance:0},i.forEach((function(e){t!==e&&(r[t][e]={distance:Number.POSITIVE_INFINITY})})),n(t).forEach((function(n){var i=n.v===t?n.w:n.v,s=e(n);r[t][i]={distance:s,predecessor:t}}))})),i.forEach((function(t){var e=r[t];i.forEach((function(n){var s=r[n];i.forEach((function(n){var r=s[t],i=e[n],o=s[n],a=r.distance+i.distance;a<o.distance&&(o.distance=a,o.predecessor=i.predecessor)}))}))})),r}(t,e||i,n||function(e){return t.outEdges(e)})};var i=r.constant(1)},function(t,e,n){var r=n(175);t.exports=function(t){try{r(t)}catch(t){if(t instanceof r.CycleException)return!1;throw t}return!0}},function(t,e,n){var r=n(176);t.exports=function(t,e){return r(t,e,"post")}},function(t,e,n){var r=n(176);t.exports=function(t,e){return r(t,e,"pre")}},function(t,e,n){var r=n(16),i=n(92),s=n(173);t.exports=function(t,e){var n,o=new i,a={},_=new s;function u(t){var r=t.v===n?t.w:t.v,i=_.priority(r);if(void 0!==i){var s=e(t);s<i&&(a[r]=n,_.decrease(r,s))}}if(0===t.nodeCount())return o;r.each(t.nodes(),(function(t){_.add(t,Number.POSITIVE_INFINITY),o.setNode(t)})),_.decrease(t.nodes()[0],0);var c=!1;for(;_.size()>0;){if(n=_.removeMin(),r.has(a,n))o.setEdge(n,a[n]);else{if(c)throw new Error("Input graph is not connected: "+t);c=!0}t.nodeEdges(n).forEach(u)}return o}},function(t,e,n){var r=n(303),i=n(128),s=n(178);t.exports=function(t){return function(e,n,o){return o&&"number"!=typeof o&&i(e,n,o)&&(n=o=void 0),e=s(e),void 0===n?(n=e,e=0):n=s(n),o=void 0===o?e<n?1:-1:s(o),r(e,n,o,t)}}},function(t,e){var n=Math.ceil,r=Math.max;t.exports=function(t,e,i,s){for(var o=-1,a=r(n((e-t)/(i||1)),0),_=Array(a);a--;)_[s?a:++o]=t,t+=i;return _}},function(t,e,n){var r=n(17),i=n(51),s=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,_=/^0o[0-7]+$/i,u=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(i(t))return NaN;if(r(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=r(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var n=a.test(t);return n||_.test(t)?u(t.slice(2),n?2:8):o.test(t)?NaN:+t}},function(t,e,n){var r=n(76);t.exports=function(t,e){for(var n=t.length;n--&&r(e,t[n],0)>-1;);return n}},function(t,e,n){var r=n(76);t.exports=function(t,e){for(var n=-1,i=t.length;++n<i&&r(e,t[n],0)>-1;);return n}},function(t,e){t.exports=function(t){return t.split("")}},function(t,e){var n="[\\ud800-\\udfff]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",s="[^\\ud800-\\udfff]",o="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",_="(?:"+r+"|"+i+")"+"?",u="[\\ufe0e\\ufe0f]?"+_+("(?:\\u200d(?:"+[s,o,a].join("|")+")[\\ufe0e\\ufe0f]?"+_+")*"),c="(?:"+[s+r+"?",r,o,a,n].join("|")+")",h=RegExp(i+"(?="+i+")|"+c+u,"g");t.exports=function(t){return t.match(h)||[]}},function(t,e,n){var r=n(310),i=n(106),s=n(108),o=n(75),a=n(107),_=n(109),u=Math.ceil;t.exports=function(t,e){var n=(e=void 0===e?" ":i(e)).length;if(n<2)return n?r(e,t):e;var c=r(e,u(t/a(e)));return o(e)?s(_(c),0,t).join(""):c.slice(0,t)}},function(t,e){var n=Math.floor;t.exports=function(t,e){var r="";if(!t||e<1||e>9007199254740991)return r;do{e%2&&(r+=t),(e=n(e/2))&&(t+=t)}while(e);return r}},function(t,e,n){var r=n(108),i=n(75),s=n(109),o=n(33);t.exports=function(t){return function(e){e=o(e);var n=i(e)?s(e):void 0,a=n?n[0]:e.charAt(0),_=n?r(n,1).join(""):e.slice(1);return a[t]()+_}}},function(t,e,n){var r=n(313),i=n(33),s=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,o=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");t.exports=function(t){return(t=i(t))&&t.replace(s,r).replace(o,"")}},function(t,e,n){var r=n(314)({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"});t.exports=r},function(t,e){t.exports=function(t){return function(e){return null==t?void 0:t[e]}}},function(t,e,n){var r=n(316),i=n(317),s=n(33),o=n(318);t.exports=function(t,e,n){return t=s(t),void 0===(e=n?void 0:e)?i(t)?o(t):r(t):t.match(e)||[]}},function(t,e){var n=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;t.exports=function(t){return t.match(n)||[]}},function(t,e){var n=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;t.exports=function(t){return n.test(t)}},function(t,e){var n="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",r="["+n+"]",i="\\d+",s="[\\u2700-\\u27bf]",o="[a-z\\xdf-\\xf6\\xf8-\\xff]",a="[^\\ud800-\\udfff"+n+i+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",_="(?:\\ud83c[\\udde6-\\uddff]){2}",u="[\\ud800-\\udbff][\\udc00-\\udfff]",c="[A-Z\\xc0-\\xd6\\xd8-\\xde]",h="(?:"+o+"|"+a+")",l="(?:"+c+"|"+a+")",d="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",p="[\\ufe0e\\ufe0f]?"+d+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",_,u].join("|")+")[\\ufe0e\\ufe0f]?"+d+")*"),f="(?:"+[s,_,u].join("|")+")"+p,m=RegExp([c+"?"+o+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[r,c,"$"].join("|")+")",l+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[r,c+h,"$"].join("|")+")",c+"?"+h+"+(?:['’](?:d|ll|m|re|s|t|ve))?",c+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",i,f].join("|"),"g");t.exports=function(t){return t.match(m)||[]}},function(t,e,n){var r=n(46),i=n(42),s=n(169),o=n(320),a=n(49),_=n(321),u=n(50);t.exports=function(t,e,n){var c=-1;e=r(e.length?e:[u],a(i));var h=s(t,(function(t,n,i){return{criteria:r(e,(function(e){return e(t)})),index:++c,value:t}}));return o(h,(function(t,e){return _(t,e,n)}))}},function(t,e){t.exports=function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}},function(t,e,n){var r=n(322);t.exports=function(t,e,n){for(var i=-1,s=t.criteria,o=e.criteria,a=s.length,_=n.length;++i<a;){var u=r(s[i],o[i]);if(u)return i>=_?u:u*("desc"==n[i]?-1:1)}return t.index-e.index}},function(t,e,n){var r=n(51);t.exports=function(t,e){if(t!==e){var n=void 0!==t,i=null===t,s=t==t,o=r(t),a=void 0!==e,_=null===e,u=e==e,c=r(e);if(!_&&!c&&!o&&t>e||o&&a&&u&&!_&&!c||i&&a&&u||!n&&u||!s)return 1;if(!i&&!o&&!c&&t<e||c&&n&&s&&!i&&!o||_&&n&&s||!a&&s||!u)return-1}return 0}},function(t,e,n){var r=n(88),i=n(132),s=n(133),o=n(46),a=n(49),_=n(89);t.exports=function(t,e,n,u){var c=-1,h=i,l=!0,d=t.length,p=[],f=e.length;if(!d)return p;n&&(e=o(e,a(n))),u?(h=s,l=!1):e.length>=200&&(h=_,l=!1,e=new r(e));t:for(;++c<d;){var m=t[c],v=null==n?m:n(m);if(m=u||0!==m?m:0,l&&v==v){for(var g=f;g--;)if(e[g]===v)continue t;p.push(m)}else h(e,v,u)||p.push(m)}return p}},function(t,e,n){var r=n(325),i=n(326),s=n(42),o=n(3);t.exports=function(t,e){return function(n,a){var _=o(n)?r:i,u=e?e():{};return _(n,t,s(a,2),u)}}},function(t,e){t.exports=function(t,e,n,r){for(var i=-1,s=null==t?0:t.length;++i<s;){var o=t[i];e(r,o,n(o),t)}return r}},function(t,e,n){var r=n(52);t.exports=function(t,e,n,i){return r(t,(function(t,r,s){e(i,t,n(t),s)})),i}},function(t,e,n){"use strict";n.r(e),n.d(e,"PolyScene",(function(){return rt})),n.d(e,"SceneJsonImporter",(function(){return Et}));var r=n(1);class i{constructor(t){this.scene=t,this._master_camera_node_path=null}set_master_camera_node_path(t){this._master_camera_node_path=t}get master_camera_node_path(){return this._master_camera_node_path}get master_camera_node(){if(this.master_camera_node_path){return this.scene.node(this.master_camera_node_path)}return console.warn("master camera node not found"),this._find_any_camera()}_find_any_camera(){const t=this.scene.root;return t.nodes_by_type("perspective_camera")[0]||t.nodes_by_type("orthographic_camera")[0]}}class s{constructor(t){this._scene=t,this._queue=new Map,this._block_level=0,this._process_item_bound=this._process_item.bind(this),this._block_level=0}block(){this._block_level+=1}unblock(){this._block_level-=1,this._block_level<0&&(this._block_level=0),this.process_queue()}get blocked(){return this._block_level>0}enqueue(t,e){this._queue.set(t.graph_node_id,e)}process_queue(){this.blocked||this._queue.forEach(this._process_item_bound)}_process_item(t,e){const n=this._scene.graph.node_from_id(e);n&&(this._queue.delete(e),n.dirty_controller.run_post_dirty_hooks(t))}}var o=n(115);class a{constructor(){this._next_id=0,this._graph=new o.Graph({directed:!0,compound:!1,multigraph:!0})}graph(){return this._graph}set_scene(t){this._scene=t}scene(){return this._scene}next_id(){return`${this._next_id+=1}`}setNode(t){this._graph.setNode(t.graph_node_id,t)}removeNode(t){this._graph.removeNode(t.graph_node_id)}nodes_from_ids(t){const e=[];for(let n of t){const t=this.node_from_id(n);t&&e.push(t)}return e}node_from_id(t){return this._graph.node(t)}connect(t,e){const n=t.graph_node_id,r=e.graph_node_id;if(this._graph.hasNode(n)&&this._graph.hasNode(r)){this._graph.setEdge(n,r);let e=!1;return!(!this._scene||this._scene.loading_controller.is_loading)&&(e=!o.alg.isAcyclic(this._graph)),e?(this._graph.removeEdge(n,r),!1):(t.dirty_controller.clear_successors_cache_with_predecessors(),!0)}return console.warn(`attempt to connect non existing node ${n} or ${r}`),!1}disconnect(t,e){if(t&&e){const n=t.graph_node_id,r=e.graph_node_id;this._graph.removeEdge(n,r),t.dirty_controller.clear_successors_cache_with_predecessors()}}disconnect_predecessors(t){const e=this.predecessors(t);for(let n of e)this.disconnect(n,t)}disconnect_successors(t){const e=this.successors(t);for(let n of e)this.disconnect(t,n)}predecessor_ids(t){return this._graph.predecessors(t)||[]}predecessors(t){const e=this.predecessor_ids(t.graph_node_id);return this.nodes_from_ids(e)}successor_ids(t){return this._graph.successors(t)||[]}successors(t){const e=this.successor_ids(t.graph_node_id)||[];return this.nodes_from_ids(e)}all_next_ids(t,e){const n=[];let r=this[e](t.graph_node_id);for(;r.length>0;){const t=[];for(let n of r)for(let r of this[e](n))t.push(r);for(let t of r)n.push(t);for(let e of t)r.push(e);r=t}return n}all_predecessor_ids(t){return this.all_next_ids(t,"predecessor_ids")}all_successor_ids(t){return this.all_next_ids(t,"successor_ids")}all_predecessors(t){const e=this.all_predecessor_ids(t);return this.nodes_from_ids(e)}all_successors(t){const e=this.all_successor_ids(t);return this.nodes_from_ids(e)}}class _{constructor(){this._cooking_nodes_by_id=new Map,this._resolves=[]}add_node(t){this._cooking_nodes_by_id.set(t.graph_node_id,t)}remove_node(t){this._cooking_nodes_by_id.delete(t.graph_node_id),0==this._cooking_nodes_by_id.size&&this.flush()}flush(){let t;for(;t=this._resolves.pop();)t()}wait_for_cooks_completed(){return Object(r.a)(this,void 0,void 0,(function*(){return 0==this._cooking_nodes_by_id.size?void 0:new Promise((t,e)=>{this._resolves.push(t)})}))}}var u=n(11);class c{constructor(t){this.scene=t}set_listener(t){this._events_listener=t}get events_listener(){return this._events_listener}dispatch(t,e,n){var r;null===(r=this._events_listener)||void 0===r||r.process_events(t,e,n)}get emit_allowed(){return this.scene.loading_controller.loaded&&null!=this._events_listener&&this.scene.loading_controller.auto_updating&&!u.a.instance().player_mode()}}var h=n(177),l=n(82);class d{constructor(t){this._mouse_events_controller=new l.b,this._controllers=[this._mouse_events_controller]}register_event_node(t){const e=this._get_controller_for_node(t);e&&e.register_node(t)}unregister_event_node(t){const e=this._get_controller_for_node(t);e&&e.unregister_node(t)}process_event(t,e,n){for(let r of this._controllers)if(r.accepts_event(t))return void r.process(t,e,n)}_get_controller_for_node(t){switch(t.type){case h.a.type():return this._mouse_events_controller}}}class p{constructor(t){this.scene=t,this._lifecycle_on_create_allowed=!0}on_create_hook_allowed(){return this.scene.loading_controller.loaded&&this._lifecycle_on_create_allowed}on_create_prevent(t){this._lifecycle_on_create_allowed=!1,t(),this._lifecycle_on_create_allowed=!0}}class f{constructor(t){this.scene=t,this._loading_state=!0,this._auto_updating=!0,this._first_object_loaded=!1}mark_as_loading(){this._set_loading_state(!0)}mark_as_loaded(){return Object(r.a)(this,void 0,void 0,(function*(){yield this._set_loading_state(!1)}))}_set_loading_state(t){return Object(r.a)(this,void 0,void 0,(function*(){this._loading_state=t,yield this.set_auto_update(!this._loading_state)}))}get is_loading(){return this._loading_state}get loaded(){return!this._loading_state}get auto_updating(){return this._auto_updating}set_auto_update(t){return Object(r.a)(this,void 0,void 0,(function*(){if(this._auto_updating!==t&&(this._auto_updating=t,this._auto_updating)){const t=this.scene.root;t&&(yield t.process_queue())}}))}on_first_object_loaded(){var t;if(!this._first_object_loaded){this._first_object_loaded=!0;const e=document.getElementById("scene_loading_container");e&&(null===(t=e.parentElement)||void 0===t||t.removeChild(e))}}}class m{constructor(){this._params_by_id=new Map}register_param(t){this._params_by_id.set(t.graph_node_id,t)}deregister_param(t){this._params_by_id.delete(t.graph_node_id)}regenerate_referring_expressions(t){t.name_controller.graph_node.set_successors_dirty(t)}}var v=n(6);class g{constructor(t,e){this.param=t,this.path=e}matches_path(t){return v.a.make_absolute_path(this.param.node,this.path)==t}update_from_method_dependency_name_change(){var t;null===(t=this.param.expression_controller)||void 0===t||t.update_from_method_dependency_name_change()}resolve_missing_dependencies(){const t=this.param.raw_input_serialized;this.param.set(this.param.default_value),this.param.set(t)}}var y=n(119);class x{constructor(){this.references=new Map}register(t,e,n){const r=new g(t,n);return y.a.push_on_array_at_entry(this.references,t.graph_node_id,r),r}deregister_param(t){this.references.delete(t.graph_node_id)}check_for_missing_references(t){this._check_for_missing_references_for_node(t);for(let e of t.params.all)this._check_for_missing_references_for_param(e)}_check_for_missing_references_for_node(t){const e=t.graph_node_id;this.references.forEach((n,r)=>{let i=!1;for(let e of n)e.matches_path(t.full_path())&&(i=!0,e.resolve_missing_dependencies());i&&this.references.delete(e)})}_check_for_missing_references_for_param(t){const e=t.graph_node_id;this.references.forEach((n,r)=>{let i=!1;for(let e of n)e.matches_path(t.full_path())&&(i=!0,e.resolve_missing_dependencies());i&&this.references.delete(e)})}}var b=n(181),w=n.n(b),k=n(47),E=n.n(k),M=n(27),O=n.n(M),j=n(120),A=n(58),z=n(35),T=n(37),S=n(39);class P extends S.b{set_content(t){super.set_content(t)}}class R extends A.b{constructor(){super(...arguments),this.container_controller=new T.a(this,P)}static node_context(){return z.a.MANAGER}node_sibbling(t){return super.node_sibbling(t)}}var C=n(44);class q extends C.a{}const D=new q;class L extends R{constructor(){super(...arguments),this.params_config=D,this._object=new j.a,this._queued_nodes_by_id={},this._queued_nodes_by_path={},this._expected_geo_nodes={},this._process_queue_start=-1,this._children_controller_context=z.a.OBJ}static type(){return"obj"}initialize_node(){var t;null===(t=this.children_controller)||void 0===t||t.init(),this.lifecycle.add_on_child_add_hook(this._on_child_add.bind(this)),this.lifecycle.add_on_child_remove_hook(this._on_child_remove.bind(this))}init_default_scene(){this._object.name="_WORLD_",this._scene.default_scene.add(this._object)}object(){return this._object}create_node(t){return super.create_node(t)}children(){return super.children()}nodes_by_type(t){return super.nodes_by_type(t)}multiple_display_flags_allowed(){return!0}add_to_queue(t){const e=t.graph_node_id;if(null==this._queued_nodes_by_id[e])return this._queued_nodes_by_id[e]=t}process_queue(){return Object(r.a)(this,void 0,void 0,(function*(){this._queued_nodes_by_path={};const t=Object.keys(this._queued_nodes_by_id);for(let e of t){const t=this._queued_nodes_by_id[e];delete this._queued_nodes_by_id[e];const n=`_____${t.render_order}__${t.full_path()}`;this._queued_nodes_by_path[n]=t}const e=Object.keys(this._queued_nodes_by_path).sort().map(t=>{const e=this._queued_nodes_by_path[t];return this.update_object(e)});this._expected_geo_nodes=this._expected_geo_nodes||(yield this.expected_loading_geo_nodes_by_id()),this._process_queue_start=performance.now(),Promise.all(e).then(()=>{u.a.instance().log(`SCENE LOADED '${this.scene.name}' in ${performance.now()-this._process_queue_start}`)})}))}update_object(t){this.scene.loading_controller.auto_updating?this.add_to_scene(t):this.add_to_queue(t)}get_parent_for_node(t){if(t.attachable_to_hierarchy){const e=t.io.inputs.input(0);return e?e.children_group:this._object}return null}add_to_scene(t){if(t.attachable_to_hierarchy){const e=this.get_parent_for_node(t);e&&(t.used_in_scene?t.add_object_to_parent(e):t.remove_object_from_parent())}}remove_from_scene(t){t.remove_object_from_parent()}are_children_cooking(){const t=this.children();for(let e of t)if(e.is_display_node_cooking())return!0;return!1}expected_loading_geo_nodes_by_id(){return Object(r.a)(this,void 0,void 0,(function*(){const t=this.nodes_by_type("geo"),e={};for(let n of t){(yield n.is_displayed())&&(e[n.graph_node_id]=n)}return e}))}add_to_parent_transform(t){this.update_object(t)}remove_from_parent_transform(t){this.update_object(t)}_on_child_add(t){t&&this.update_object(t)}_on_child_remove(t){t&&this.remove_from_scene(t)}}var N=n(15);class U{constructor(t){this.scene=t,this._node_context_signatures={},this._instanciated_nodes_by_context_and_type={}}init(){this._root=new L(this.scene),this._root.initialize_base_and_node(),this._root.init_default_scene()}get root(){return this._root}objects_from_mask(t){const e=t.split(" ");let n=this.root.children();n=n.filter(t=>N.a.matches_one_mask(t.name,e));const r=n.map(t=>t.object);return O()(r)}clear(){var t;const e=this.root.children();for(let n of e)null===(t=this.root.children_controller)||void 0===t||t.remove_node(n)}node(t){return"/"===t?this.root:this.root.node(t)}all_nodes(){let t=[this.root],e=[this.root],n=0;for(;e.length>0&&n<10;){const r=E()(e.map(t=>t.children_allowed()?t.children():[]));t=w()(t,r),e=r,n+=1}return E()(t)}reset_node_context_signatures(){this._node_context_signatures={}}register_node_context_signature(t){t.children_allowed()&&t.children_controller&&(this._node_context_signatures[t.children_controller.node_context_signature()]=!0)}node_context_signatures(){return Object.keys(this._node_context_signatures).sort().map(t=>t.toLowerCase())}add_to_instanciated_node(t){const e=t.node_context(),n=t.type;this._instanciated_nodes_by_context_and_type[e]=this._instanciated_nodes_by_context_and_type[e]||{},this._instanciated_nodes_by_context_and_type[e][n]=this._instanciated_nodes_by_context_and_type[e][n]||{},this._instanciated_nodes_by_context_and_type[e][n][t.graph_node_id]=t}remove_from_instanciated_node(t){const e=t.node_context(),n=t.type;delete this._instanciated_nodes_by_context_and_type[e][n][t.graph_node_id]}instanciated_nodes(t,e){const n=[];if(this._instanciated_nodes_by_context_and_type[t]){const r=this._instanciated_nodes_by_context_and_type[t][e];if(r)for(let t of Object.keys(r))n.push(r[t])}return n}}var $=n(30),I=n.n($),V=n(65),F=n.n(V),B=n(31),H=n.n(B);class G{constructor(t){this._node=t,this._cooks_count=0,this._cook_time_total=0,this._cook_time_total_with_inputs=0,this._cook_time_total_params=0}update_cook_data(){this._cooks_count+=1,this._cook_time_total+=this._node.cook_controller.cook_time,this._cook_time_total_with_inputs+=this._node.cook_controller.cook_time_with_inputs,this._cook_time_total_params+=this._node.cook_controller.cook_time_params}get cook_time_total(){return this._cook_time_total}get cook_time_per_iteration(){return this._cooks_count>0?this._cook_time_total/this._cooks_count:0}get cook_time_total_with_inputs(){return this._cook_time_total_with_inputs}get cook_time_total_with_inputs_per_iteration(){return this._cooks_count>0?this._cook_time_total_with_inputs/this._cooks_count:0}get cook_time_total_params(){return this._cook_time_total_params}get cook_time_total_params_per_iteration(){return this._cooks_count>0?this._cook_time_total_params/this._cooks_count:0}get cooks_count(){return this._cooks_count}print_object(){return{full_path:this._node.full_path(),cooks_count:this.cooks_count,cook_time_total:this.cook_time_total,cook_time_per_iteration:this.cook_time_per_iteration,cook_time_total_with_inputs:this.cook_time_total_with_inputs,cook_time_total_with_inputs_per_iteration:this.cook_time_total_with_inputs_per_iteration,cook_time_total_params:this.cook_time_total_params,cook_time_total_params_per_iteration:this.cook_time_total_params_per_iteration}}}class W{constructor(){this._started=!1,this._start_time=0,this._previous_timestamp=0,this._nodes_cook_data={},this._durations_by_name={},this._durations_count_by_name={}}profile(t,e){const n=performance.now();e();const r=performance.now()-n;console.log(`${t}: ${r}`)}start(){this._started||(this.reset(),this._started=!0,this._start_time=performance.now(),this._nodes_cook_data={},this._previous_timestamp=this._start_time)}stop(){this.reset()}reset(){this._started=!1,this._start_time=null,this._durations_by_name={},this._durations_count_by_name={},this._nodes_cook_data={}}get started(){return this._started}record_node_cook_data(t){const e=t.graph_node_id;null==this._nodes_cook_data[e]&&(this._nodes_cook_data[e]=new G(t)),this._nodes_cook_data[e].update_cook_data()}record(t){this.started||this.start();const e=performance.now();return null==this._durations_by_name[t]&&(this._durations_by_name[t]=0),this._durations_by_name[t]+=e-this._previous_timestamp,null==this._durations_count_by_name[t]&&(this._durations_count_by_name[t]=0),this._durations_count_by_name[t]+=1,this._previous_timestamp=e}print(){this.print_node_cook_data(),this.print_recordings()}print_node_cook_data(){let t=Object.values(this._nodes_cook_data);t=H()(t,t=>-t.cook_time_total);const e=t.map(t=>t.print_object());console.log("--------------- NODES COOK TIME -----------");const n=[],r=H()(e,t=>-t.cook_time_total);for(let t of r)n.push(t);return console.table(n),e}print_recordings(){const t=F()(this._durations_by_name),e=F()(this._durations_count_by_name),n=[],r={};for(let e of Object.keys(t)){const i=t[e];n.push(i),null==r[i]&&(r[i]=[]),r[i].push(e)}n.sort((t,e)=>t-e);const i=I()(n);console.log("--------------- PERF RECORDINGS -----------");const s=[];for(let t of i){const n=r[t];for(let r of n){const n=e[r],i={duration:t,name:r,count:n,duration_per_iteration:t/n};s.push(i)}}return console.table(s),s}}var Y,Z=n(13);!function(t){t.FRAME_RANGE_UPDATED="scene_frame_range_updated",t.FRAME_UPDATED="scene_frame_updated",t.PLAY_STATE_UPDATED="scene_play_state_updated"}(Y||(Y={}));class X{constructor(t){this.scene=t,this.self=this,this._frame=1,this._time=0,this._prev_performance_now=0,this._frame_range=[1,600],this._frame_range_locked=[!0,!0],this._playing=!1,this._graph_node=new Z.a(t,"time controller")}get graph_node(){return this._graph_node}get frame(){return this._frame}get time(){return this._time}get frame_range(){return this._frame_range}get frame_range_locked(){return this._frame_range_locked}set_frame_range(t,e){this._frame_range[0]=Math.floor(t),this._frame_range[1]=Math.floor(e),this.scene.dispatch_controller.dispatch(this._graph_node,Y.FRAME_RANGE_UPDATED)}set_frame_range_locked(t,e){this._frame_range_locked[0]=t,this._frame_range_locked[1]=e,this.scene.dispatch_controller.dispatch(this._graph_node,Y.FRAME_RANGE_UPDATED)}set_time(t,e=!0){if(t!=this._time){if(this._time=t,e){const t=Math.floor(60*this._time);this._frame=t}this.scene.dispatch_controller.dispatch(this._graph_node,Y.FRAME_UPDATED),this.scene.uniforms_controller.update_time_dependent_uniform_owners(),this.scene.cooker.block(),this.graph_node.set_successors_dirty(),this.scene.cooker.unblock()}}set_frame(t,e=!0){t!=this._frame&&(t=this._ensure_frame_within_bounds(t))!=this._frame&&(this._frame=t,e&&this.set_time(this._frame/60,!1))}increment_time_if_playing(){this._playing&&(this.scene.root.are_children_cooking()||this.increment_time())}increment_time(){const t=performance.now(),e=(t-this._prev_performance_now)/1e3,n=this._time+e;this._prev_performance_now=t,this.set_time(n)}_ensure_frame_within_bounds(t){return this._frame_range_locked[0]&&t<this._frame_range[0]?this._frame_range[1]:this._frame_range_locked[1]&&t>this._frame_range[1]?this._frame_range[0]:t}get playing(){return!0===this._playing}pause(){1==this._playing&&(this._playing=!1,this.scene.dispatch_controller.dispatch(this._graph_node,Y.PLAY_STATE_UPDATED))}play(){!0!==this._playing&&(this._playing=!0,this._prev_performance_now=performance.now(),this.scene.dispatch_controller.dispatch(this._graph_node,Y.PLAY_STATE_UPDATED))}toggle_play_pause(){this.playing?this.pause():this.play()}}var J=n(78);class Q{constructor(t){this.scene=t}to_json(t=!1){const e={},n={};for(let r of this.scene.nodes_controller.all_nodes()){const i=new J.a(r);e[r.graph_node_id]=i.to_json(t);const s=r.params.all;for(let t of s)n[t.graph_node_id]=t.to_json()}return{nodes_by_graph_node_id:e,params_by_graph_node_id:n}}}var K=n(12);class tt{constructor(t){this.scene=t,this._time_dependent_uniform_owners={},this._time_dependent_uniform_owners_ids=null,this._resolution=new K.a(1,1),this._resolution_dependent_uniform_owners={},this._resolution_dependent_uniform_owners_ids=[]}add_time_dependent_uniform_owner(t,e){this._time_dependent_uniform_owners[t]=e,this._update_time_dependent_uniform_owners_ids()}remove_time_dependent_uniform_owner(t){delete this._time_dependent_uniform_owners[t],this._update_time_dependent_uniform_owners_ids()}_update_time_dependent_uniform_owners_ids(){this._time_dependent_uniform_owners_ids=Object.keys(this._time_dependent_uniform_owners)}update_time_dependent_uniform_owners(){const t=this.scene.time;if(this._time_dependent_uniform_owners_ids)for(let e of this._time_dependent_uniform_owners_ids){this._time_dependent_uniform_owners[e].time.value=t}}add_resolution_dependent_uniform_owner(t,e){this._resolution_dependent_uniform_owners[t]=e,this._update_resolution_dependent_uniform_owners_ids(),this._resolution&&this.update_resolution_dependent_uniforms(e)}remove_resolution_dependent_uniform_owner(t){delete this._resolution_dependent_uniform_owners[t],this._update_resolution_dependent_uniform_owners_ids()}_update_resolution_dependent_uniform_owners_ids(){this._resolution_dependent_uniform_owners_ids=Object.keys(this._resolution_dependent_uniform_owners)}update_resolution_dependent_uniform_owners(t){this._resolution.copy(t);for(let t of this._resolution_dependent_uniform_owners_ids){const e=this._resolution_dependent_uniform_owners[t];this.update_resolution_dependent_uniforms(e)}}update_resolution_dependent_uniforms(t){t.resolution.value.x=this._resolution.x*window.devicePixelRatio,t.resolution.value.y=this._resolution.y*window.devicePixelRatio}}class et{constructor(){this._require_webgl2=!1}require_webgl2(){return this._require_webgl2}set_require_webgl2(){this._require_webgl2||(this._require_webgl2=!0,u.a.instance().renderers_controller.set_require_webgl2())}}var nt=n(126);class rt{constructor(){this._default_scene=new nt.a,this._cameras_controller=new i(this),this._cooker=new s(this),this.cook_controller=new _,this._graph=new a,this._missing_expression_references_controller=new x,this._expressions_controller=new m,this._nodes_controller=new U(this),this._time_controller=new X(this),this._graph.set_scene(this),this.nodes_controller.init()}get default_scene(){return this._default_scene}set_uuid(t){return this._uuid=t}get uuid(){return this._uuid}set_name(t){return this._name=t}get name(){return this._name}get cameras_controller(){return this._cameras_controller}get cooker(){return this._cooker}wait_for_cooks_completed(){return Object(r.a)(this,void 0,void 0,(function*(){return this.cook_controller.wait_for_cooks_completed()}))}get dispatch_controller(){return this._dispatch_controller=this._dispatch_controller||new c(this)}get events_controller(){return this._events_controller=this._events_controller||new d(this)}get graph(){return this._graph}get lifecycle_controller(){return this._lifecycle_controller=this._lifecycle_controller||new p(this)}get loading_controller(){return this._loading_controller=this._loading_controller||new f(this)}get missing_expression_references_controller(){return this._missing_expression_references_controller}get expressions_controller(){return this._expressions_controller}get nodes_controller(){return this._nodes_controller}get performance(){return this._performance=this._performance||new W}get time_controller(){return this._time_controller}set_frame(t){this.time_controller.set_frame(t)}get frame(){return this.time_controller.frame}get time(){return this.time_controller.time}get frame_range(){return this.time_controller.frame_range}play(){this.time_controller.play()}pause(){this.time_controller.pause()}get serializer(){return this._serializer=this._serializer||new Q(this)}to_json(){return this.serializer.to_json()}get uniforms_controller(){return this._uniforms_controller=this._uniforms_controller||new tt(this)}get webgl_controller(){return this._webgl_controller=this._webgl_controller||new et}batch_update(t){this._cooker.block(),t(),this._cooker.unblock()}node(t){return this.nodes_controller.node(t)}get root(){return this.nodes_controller.root}}var it=n(5),st=n.n(it),ot=n(66),at=n.n(ot),_t=n(17),ut=n.n(_t),ct=n(9),ht=n.n(ct),lt=n(3),dt=n.n(lt);class pt{constructor(t){this._node=t}process_data(t){if(this.create_nodes(t.nodes),this.set_selection(t.selection),this._node.io.inputs.override_clonable_state_allowed()){const e=t.override_clonable_state;e&&this._node.io.inputs.set_override_clonable_state(e)}this.set_flags(t),this.set_params(t.params),this.from_data_custom(t),this._node.lifecycle.set_creation_completed()}process_inputs_data(t){this.set_inputs(t.inputs)}process_ui_data(t){if(!t)return;const e=this._node.ui_data,n=t.pos;if(n){const t=(new K.a).fromArray(n);e.set_position(t)}const r=t.comment;r&&e.set_comment(r),this.process_nodes_ui_data(t.nodes)}create_nodes(t){if(!t)return;const e=Object.keys(t),n=[];for(let r of e){const e=t[r].type;if(this._node.children_allowed()&&this._node.children_controller){const t=this._node.create_node(e);t&&(t.set_name(r),n.push(t))}}const r=[];let i=0;for(let e of n){const n=kt.dispatch_node(e);r.push(n),n.process_data(t[e.name]),i++}i=0;for(let e of n){r[i].process_inputs_data(t[e.name]),i++}}set_selection(t){if(this._node.children_allowed()&&this._node.children_controller&&t&&t.length>0){const e=[];t.forEach(t=>{const n=this._node.node(t);n&&e.push(n)}),this._node.children_controller.selection.set(e)}}set_flags(t){var e,n,r,i;const s=t.flags;if(s){const t=s.bypass;null!=t&&(null===(n=null===(e=this._node.flags)||void 0===e?void 0:e.bypass)||void 0===n||n.set(t));const o=s.display;null!=o&&(null===(i=null===(r=this._node.flags)||void 0===r?void 0:r.display)||void 0===i||i.set(o))}}set_inputs(t){t&&t.forEach((t,e)=>{if(t&&this._node.parent)if(st()(t)){const n=t,r=this._node.parent.node(n);this._node.set_input(e,r)}else{const e=this._node.parent.node(t.node),n=t.name;this._node.io.inputs.has_named_input(n)?this._node.set_input(t.name,e,t.output):console.warn(`${this._node.full_path()} has no input named ${n}`)}})}process_nodes_ui_data(t){if(!t)return;Object.keys(t).forEach(e=>{const n=this._node.node(e);if(n){const r=t[e];kt.dispatch_node(n).process_ui_data(r)}})}set_params(t){if(!t)return;const e=Object.keys(t),n={};for(let r of e){const e=t[r],i=e.options,s=e.type;let o,a=!1;this._node.params.has_param(r)&&(o=this._node.params.get(r),(o&&o.type==s||null==s)&&(a=!0)),a?this._is_param_data_complex(e)?this._process_param_data_complex(r,e):this._process_param_data_simple(r,e):(n.names_to_delete=n.names_to_delete||[],n.names_to_delete.push(r),n.to_add=n.to_add||[],n.to_add.push({name:r,type:s,init_value:e.default_value,options:i}))}const r=n.names_to_delete&&n.names_to_delete.length>0,i=n.to_add&&n.to_add.length>0;if(r||i){this._node.params.update_params(n);for(let e of this._node.params.spare){const n=t[e.name];!e.parent_param&&n&&(this._is_param_data_complex(n)?this._process_param_data_complex(e.name,n):this._process_param_data_simple(e.name,n))}}this._node.params.run_on_scene_load_hooks()}_process_param_data_simple(t,e){var n;null===(n=this._node.params.get(t))||void 0===n||n.set(e)}_process_param_data_complex(t,e){const n=this._node.params.get(t);n&&kt.dispatch_param(n).process_data(e)}_is_param_data_complex(t){return!(st()(t)||ht()(t)||dt()(t)||at()(t))&&!(!ut()(t)||!Object.keys(t).includes("type"))}from_data_custom(t){}}class ft{constructor(t){this._param=t}process_data(t){const e=t.raw_input;void 0!==e&&this._param.set(e),this.add_main(t)}add_main(t){}}class mt extends ft{add_main(t){}}const vt=/\\n+/g;class gt extends ft{add_main(t){let e=t.raw_input;void 0!==e&&(e=e.replace(vt,"\n"),this._param.set(e))}}class yt extends ft{add_main(t){const e=t.raw_input;e&&this._param.set(e)}}var xt=n(20),bt=n(67),wt=n(28);class kt{static dispatch_node(t){return new pt(t)}static dispatch_param(t){return t instanceof xt.a?new mt(t):t instanceof bt.a?new gt(t):t instanceof wt.a?new yt(t):new ft(t)}}class Et{constructor(t){this._data=t}static load_data(t){return new Et(t).scene()}scene(){return Object(r.a)(this,void 0,void 0,(function*(){const t=new rt;t.loading_controller.mark_as_loading();const e=this._data.properties;if(e){t.set_frame(e.frame||1);const n=e.frame_range||[];t.time_controller.set_frame_range(n[0]||1,n[1]||100);const r=e.frame_range_locked;r&&t.time_controller.set_frame_range_locked(r[0],r[1]),e.master_camera_node_path&&t.cameras_controller.set_master_camera_node_path(e.master_camera_node_path)}t.cooker.block();const n=kt.dispatch_node(t.root);return this._data.root&&n.process_data(this._data.root),this._data.ui&&n.process_ui_data(this._data.ui),yield t.loading_controller.mark_as_loaded(),t.cooker.unblock(),t}))}}(class{static run(){return Object(r.a)(this,void 0,void 0,(function*(){const{CopRegister:t}=yield Promise.all([n.e("vendors~Cop~Mat~Obj~Sop"),n.e("vendors~Cop~Obj~Sop"),n.e("vendors~Cop~Obj"),n.e("vendors~Cop"),n.e("Cop")]).then(n.bind(null,619));t.run(u.a.instance());const{EventRegister:e}=yield Promise.all([n.e("vendors~Event"),n.e("Event")]).then(n.bind(null,620));e.run(u.a.instance());const{GlRegister:r}=yield Promise.all([n.e("Gl~Mat"),n.e("Gl")]).then(n.bind(null,616));r.run(u.a.instance());const{MatRegister:i}=yield Promise.all([n.e("vendors~Cop~Mat~Obj~Sop"),n.e("Gl~Mat"),n.e("Mat")]).then(n.bind(null,618));i.run(u.a.instance());const{ObjRegister:s}=yield Promise.all([n.e("vendors~Cop~Mat~Obj~Sop"),n.e("vendors~Cop~Obj~Sop"),n.e("vendors~Cop~Obj"),n.e("vendors~Obj~Sop"),n.e("Obj")]).then(n.bind(null,617));s.run(u.a.instance());const{SopRegister:o}=yield Promise.all([n.e("vendors~Cop~Mat~Obj~Sop"),n.e("vendors~Cop~Obj~Sop"),n.e("vendors~Obj~Sop"),n.e("vendors~Sop"),n.e("Sop")]).then(n.bind(null,615));o.run(u.a.instance())}))}}).run()}]);
//# sourceMappingURL=polygonjs-engine.js.map